Ok, allora, a giorno di giorno riprendiamo il discorso relativo alla sicurezza del perimetro aziendale. La settimana scorsa abbiamo introdotto un po' la problematica in generale, cosa significa stabilire un perimetro di sicurezza e cosa significa difenderlo e rispetto a quali tipologie di minacce. Quindi adesso è arrivato il momento di entrare un po' nel dettaglio e vedere come affrontare il tema sotto i due diversi punti di vista. Sì, non so se questo avrà avuto oggi, ma siamo in quella direzione. Stavo dicendo? Quindi vedremo, cominceremo oggi a vedere il punto di vista di chi attacca. Ok, quindi quali sono le fasi, come si definiscono le fasi di un attacco e quali sono i principali vettori di attacco. Poi vedremo il punto di vista invece di chi deve difendere e poi vedremo una serie di esempi applicativi. Ok, quindi. Per un paio di lezioni sicuramente cercheremo di capire come si muove il Red Team. Si è imbarlato? Quindi per un paio di lezioni vedremo come si muove il Red Team, cercando di capire quali sono tutte le operazioni che l'avversario mette in atto, dalle fasi preliminari di individuazione della vittima fino alla realizzazione dell'attacco attraverso lo sfruttamento di vulnerabilità. Tutte le fasi che compongono le operazioni e quindi definiscono l'operatività dell'avversario prendono il nome di Kill Chain. Quindi una catena di eventi che stabiliscono un po' il ciclo di vita di un attacco. Le tre fasi principali che andremo poi a dettagliare sono quelle che vedete qui, ovvero la fase iniziale di ricerca delle vulnerabilità. Individuata la vittima, l'attaccante cerca di capire come attaccare la vittima, se ci sono punti deboli nel perimetro del target. Una volta individuate le possibili vulnerabilità, l'avversario cercherà di sfruttare un exploit se esiste già, o di montare un attacco zero day, quindi completamente nuovo rispetto alla letteratura, per cercare appunto di penetrare attraverso la vulnerabilità di cui il perimetro soffre. E quindi abbiamo la fase di breccia, che va di poi passo poi con una fase di escalation durante la quale l'avversario una volta entrato all'interno del perimetro del sistema, deve trovare il modo di muoversi all'interno del sistema, fino ad arrivare a quello che è il proprio obiettivo di riferimento, sarà un certo asset piuttosto che altro. In ogni caso per farlo tipicamente quello che succede è che l'attaccante dovrà innanzitutto individuare dove si trova l'asset all'interno del perimetro aziendale, dovrà cercare se necessario di elevare i propri privilegi di accesso alle risorse che gli servono, perché non è detto che la vulnerabilità che sfrutta gli consenta fin dall'inizio di avere i diritti di cui necessita, e quindi dovrà trovare un modo per bypassare questo limite e elevare questi livelli, quindi da qui il nome appunto escalation, il cui esito finale sarà il raggiungimento dell'obiettivo e quindi in quel momento l'attacco si attua, si completa, e l'attaccante infliggerà quindi il danno che dipende naturalmente, la tipologia del danno dipende da quello che è l'obiettivo dell'attaccante. Possono essere danni di vario genere, non solamente tangibili ma anche di natura intangibile come vedremo. Ciascuna fase, ciascuna delle tre fasi della kill chain, poi si articola in sottofasi che andremo poi a dettagliare. Quindi iniziamo con la vulnerability search. Cosa significa? Cercare vulnerabilità nel perimetro aziendale che possano permettere all'attaccante appunto di bypassare i meccanismi di sicurezza se ci sono, e penetrare nel sistema. La prima operazione importante della vulnerability search, prende il nome di reconnaissance, riconoscimento, ovvero quella fase in cui stabilito qual è il target, qual è la vittima, riconoscere se ci sono vulnerabilità nel sistema che si vuole colpire. Quindi è una vera e propria fase di ricerca. Naturalmente perché questo abbia successo è necessario che l'attaccante raccolga il maggior numero di informazioni possibili sul sistema target, perché più informazioni ha, più è probabile che queste possano rivelare una qualche vulnerabilità che possa essere sfruttata. La ricerca può essere attiva o passiva, in altri termini esterna o interna. Il riconoscimento esterno o passivo, che dir si voglia, è caratterizzato da tutte quelle attività che consentono all'attaccante di raccogliere informazioni sulla vittima senza interagire direttamente con la vittima. Ok. Chiaramente di tutte le attività che fanno parte della kill chain, forse è quella meno identificabile, proprio in virtù del fatto che l'attaccante non ha necessità di interagire direttamente con la vittima. Ciò nonostante, in ogni caso, anche rispetto a questo tipo di attività, si possono mettere in atto delle azioni di prevenzione. L'altra tipologia di attività di riconoscimento sono quelle interne o attive che vengono svolte invece interagendo direttamente con la vittima. Cosa significa interagire direttamente con la vittima? Significa, ad esempio, interrogare la rete, interrogare i server del sistema target che sono esposti alla rete, magari con l'intento di capire se ci sono delle porte aperte, piuttosto che se ci sono dei servizi attivi o se sono attivi dei filtri basati su meccanismi di firewall o qualcosa di questo genere. Quindi tutte attività che prevedono che ci sia un engagement diretto tra attaccante e vittima. E chiaramente questo tipo di attività sono rilevabili se si mettono in atto strumenti adatti a farlo. Mentre il riconoscimento esterno è condotto per lo più attraverso attività cosiddette di intelligence, a volte con l'ausilio di tool ce ne sono alcuni che aiutano in questo senso a condurre attività di intelligence e vi mostrerò uno ad esempio. Però per lo più si tratta di attività condotte dall'avversario umano che cerca di raccogliere informazioni. Mentre invece le attività di riconoscimento interno per lo più sono condotte in maniera automatica e sistematica utilizzando dei tool. Poi vedremo un elenco di quali sono questi strumenti che consentono di raccogliere informazioni interessanti e significative su quello che è ad esempio lo stato della rete che si vuole attaccare. La fase di riconoscimento rappresenta a tutti gli effetti il precursore di un attacco. Quindi, come vedremo dal punto di vista di chi deve difendere, riuscire a intercettare questo tipo di attività probabilmente è utile a identificare potenziali attacchi prima che questi si verificano e quindi a neutralizzarli prima che vengono condotti. Chiaramente non è sempre semplice riuscire a intercettare questo tipo di attività. Nel caso appunto del riconoscimento interno questo, come vedremo, è possibile. È possibile farlo. Alcuni esempi di attività di riconoscimento esterno. Ce ne sono diverse categorie. Un esempio abbastanza pratico di che cosa significa fare il riconoscimento esterno consiste nell'attività di dumpster diving. Cosa significa dumpster diving? Significa andare a rovistare negli scarti, nell'immondizia, che è detto proprio in termini molto spicci. sembra una scemenza, una fesseria, però è un'attività che ha consentito in più di un'occasione di portare a termini attacchi abbastanza significativi. Di solito il dumpster diving si fa accedendo a, che ne so, agli apparati hardware che vengono dismessi o andando nel bidone della carta che si trova fuori dall'ufficio della vittima. Adesso facendo un esempio estremamente banale. Quando si dismettono dispositivi hardware, soprattutto quando si dismettono dispositivi hardware che sono protocollati, quindi come quelli che ad esempio trovate qui all'interno dell'Ateneo, dietro ogni computer, così come sulle sedie, vedete, ci sono delle etichette che portano un numero di protocolli. Questo vale per tutti i dispositivi hardware, ma vale anche per l'invicenza software, tutti quanti i sistemi in dotazione all'ICT di un'azienda, dovrebbero essere immatricolati e protocollati, in maniera tale da avere sempre un archivio aggiornato di cosa c'è dove. Questo è importante per avere chiaramente una visione in tempo reale di quello che è lo stato attuale dell'azienda. Ed è importante anche quando certi dispositivi vengono dismessi. Perché diventati obsoleti. Devono essere deprotocollati. Quindi per tenere traccia del fatto che un dispositivo è stato dismesso, è stato messo in condizione di non operare più, ci sono delle procedure da seguire anche per la dismissione. In certe agenzie governative per poter dismettere un computer bisogna smontare tutti i dispositivi di memoria dal computer, estrarre fisicamente l'hard disk e attraverso una macchina opportuna perforare tutti i dischi, in modo tale che diventino inaccessibili. Sembra una precauzione forse eccessiva, ma è fondamentale perché sapete bene che anche andare a cancellare il contenuto di un hard disk spesso e volentieri non è sufficiente per evitare il recupero di informazioni che è presente su quell'hard disk. E quello che vale per i dispositivi hardware vale anche per la carta. Nel film vedete sempre che quando bisogna eliminare un documento lo si passa nel trattacarto dove il documento viene ridotto a un mucchio di strisciolette di carta che finiscono nel bidone. Conosco un'azienda che fa pen testing che è riuscito a recuperare delle password andando a recuperare le striscioline di carta dal bidone dell'immondizio. Perché? Perché comunque le striscioline di carta finiscono tutte nel nostro bidone. Si vanno a recuperare dal bidone e facendo un paziente lavoro di patchwork appunto si possono ricomporre i contenuti dei documenti. In questa maniera si possono ricomporre informazioni sensibili. In quel caso le informazioni sensibili erano gli account dei clienti con alcuni dati abbastanza sensibili appunto da questo punto di vista. Quindi la dismissione di tutto quello che non serve più che sia un foglio di carta o che sia un computer è sempre una questione da trattare con la dovuta attenzione. Proprio perché potrebbe diventare una fonte di informazioni per chi poi va a... entra in possesso anche semplicemente degli scarti. Questa è l'idea del dubb-cell diving. Una delle attività di maggior successo per quanto riguarda il riconoscimento esterno riguarda l'harvesting di informazioni che provengono da internet. Voi non avete idea di quante informazioni in chiaro pubbliche sono reperibili sulla rete riguardo qualunque cosa fondamentalmente. Che sia... che si tratti di una persona fisica, che si tratti di un'azienda, le informazioni che potete reperire dal web, da ripositori pubbliche o cose di questo genere è impressionante. Ci sono dei tool, uno di questi è Maltigo, di cui vi farò vedere un esempio in uno dei casi d'uso che vedremo. È un tool creato apposta per recuperare dal web tutte le informazioni relative ad un determinato topic, ad una determinata persona, ad una determinata azienda. Viene molto usato, ad esempio, dai giornalisti, da chi fa investigazioni e anche, naturalmente, dagli hacker, chiaramente. i risultati di questo tipo di harvesting sono impressionanti certe volte perché tool come questo sono in grado di combinare informazioni provenienti da fonti e da sorgenti diverse. È abbastanza facile, usando strumenti come questo, recuperare, ad esempio, il fatto che una certa persona ha un determinato profilo con un account name, magari chiaramente non la password, su determinati servizi, su determinati provider, rispetto a determinati repository, e quindi si riescono a incrociare informazioni relative alla stessa persona mettendo assieme tutti i diversi profili virtuali che questa persona ha, anche se apparentemente sembrerebbero scorrelati. E questo ci ricollega al discorso che facevamo l'altra volta quando dicevamo che l'identità fa parte del perimetro di sicurezza. Se siete in grado di violare una delle identità virtuali di un utente, spesso volentieri, per negligenza dell'utente, riuscite anche a violare le altre identità virtuali dello stesso utente. Se la prima che violate è il suo profilo di un social, e attraverso quella, vuoi perché usa le stesse credenziali o vuoi per altri motivi, riuscite a violare anche le sue credenziali aziendali, ecco che passate da un contesto apparentemente insignificante come il profilo social dell'utente, a quello che è invece l'accesso agli asset aziendali attraverso le sue credenziali. Quindi riuscire a combinare tutte le informazioni possibili relative ad un determinato oggetto diventa utile proprio per questo motivo qua. Non solo, lo scopo può essere anche quello di raccogliere informazioni che successivamente potrebbero facilitare determinati tipi di attacco basati su, ad esempio, social engineering, come nel caso del phishing di cui vi parlerò tra poco. Quindi il riconoscimento esterno basato sull'harvesting di informazioni raccolte dal web può avere diverse finalità. E anche questa è una cosa da non sottovalutare. Sono tutte attività di difficile identificazione, però attraverso opportune accorgimenti i rischi naturalmente si possono mitigare. Questo tipo di attività spesso e l'interno sono precursori di attacchi tipo social engineering. Il social engineering va un po' a cavallo tra il riconoscimento esterno e lo svolgimento vero e proprio poi di tipi particolari di attacco. Sotto l'ombrello del social engineering si ricomprendono tutta una serie di tecniche fondamentalmente di manipolazione psicologica ecco, mettiamolo in questi termini che si ispirano e nascono da un mondo che non ha nulla a che fare con la cyber security perché la maggior parte delle teorie che stanno qua dietro sono collegate poi alle tecniche di marketing ma che poi risultano essere efficaci anche per montare veri e propri attacchi contro gli agenti umani inducendoli a comportamenti che normalmente non sarebbero portati a seguire e che come effetto hanno che ne so l'exploit di una certa vulnerability può portare a montare un vero e proprio attacco al sistema che è l'idea come al solito diciamo un'altra volta siccome l'agente umano spesso volentieri è l'anello debole del perimetro si cerca di privilegiare attacchi rivolti proprio contro questo tipo di questo tipo di agente ora le leve che vengono sfruttate nella pratica poi magari adesso vi inviterò a cercare a fare voi qualche esempio o anche a testimoniare esempi di situazioni in cui siete ricaduti o avete rischiato di trovarvi sono innumerevoli adesso io qui ne ho citate solamente sei che sono le più comuni se vi interessa l'argomento vi posso dare uno o due riferimenti dove trovate una tassonomia piuttosto completa con esempi che riportano di attacchi significativi che sono stati condotti sfruttando social engineering sulla base di una o più combinazioni di questi elementi che poi spesso volentieri vengono combinati con altre tipologie di vettori d'attacco uno dei quali ad esempio il phishing di cui parleremo tra poco quindi social engineering viene visto da una parte come strumento di external reconnaissance ma al tempo stesso anche come elemento attivo per l'elaborazione di un vero e proprio attacco quindi già nella fase di di brecce fondamentalmente di cui dicevamo prima quali sono queste leve che vediamo di capire un po' il senso la prima è piuttosto comune semplice la reciprocità ok la reciprocation che si basa su quel diciamo quello quello spirito di gratitudine che anima le persone non dico ingenue perché qui non si parla di persone ingenue ma fondamentalmente delle persone oneste ok ingenue nel momento in cui cadono in questo tipo di situazioni normalmente una persona tende a ricambiare ciò che gli viene affetto la reciprocità consiste in questo tu fai un favore a me tipicamente tu io mi comporto in maniera tale da ricambiare il favore magari anche in maniera inconscia implicita però c'è una propensione a soddisfare determinate richieste laddove dall'altra parte per prima è stato fatto qualcosa per venire incontro per offrirmi qualcosa di disatteso l'esempio tipico è che ne so vi arriva l'email con un buono sconto o con qualunque genere di diciamo bonus regalo che potete riscuotere nel momento in cui fate qualcosa vi viene offerto qualcosa la natura dell'uomo vi spinge a ricambiare quel qualcosa tu fai qualcosa per me io faccio qualcosa per te mi compili questo questionario e io ti omaggio di 30 giorni di accesso gratuito a un determinato tipo di servizio queste sono leve che nell'ambito in tanti ambiti legati al marketing e all'economia funzionano chiaramente come come esche per e non hanno intenzionalità malevoli chiaramente però la stessa leva può essere usata associata di intenzioni malevole ok e può essere usata semplicemente per attirare l'attenzione e indurre la gente umana a fare un qualcosa che poi nel proseguio potrà avere delle conseguenze negative vedi ad esempio l'attività l'attivazione di un malware che era incapsulato in una mail di phishing ok sì quella diverso sì è più vicina la scarsità probabilmente che la reciprocità perché la reciprocità si basa perché lì la molla che scatta è un po' una molla coercitiva se non faccio qualcosa ci rimetto se non faccio beh non lo sai tu ne sei convinto quindi quindi la leva non è penso che tu mi stia facendo un favore sono incline a a secondarti qui invece la leva è mi stai mi stai obbligando a fare un qualcosa che non mi piace allora devo reagire è diverso è diverso il meccanismo e ripeto assomiglia di più alla seconda leva che è la scarsità la scarsezza dove per scarsezza cioè il fatto di manipolare l'agente umano spingendolo a fare un qualcosa dettato da appunto vincoli di scarsità cioè qualcosa che viene a mancare cos'è questo qualcosa che viene a mancare beh un esempio che facevi in questo caso può essere appunto un impatto di natura apprettamente economica però ciò che ti viene a mancare può essere qualcosa anche di intangibile l'esempio tipico è il tempo hai poco tempo per fare qualcosa no ti arriva un avviso devi cambiare la password dentro domani perché altrimenti ti blocchiamo ti blocchiamo l'account è lo stesso tipo di meccanismo psicologico cioè c'è qualcosa che ti viene a mancare devi fare qualcosa perché ti manca il tempo perché non hai abbastanza risorse economiche perché non hai qualunque altro genere di asset che ti viene a mancare tangibile o intangibile che sia e quindi ti spinge a muoverti con urgenza e a volte con fretta e la fretta è sempre una cattiva consigliera quando si tratta di identificare potenziali comportamenti malevoli bisogna sempre adottare dei comportamenti cauti quando bisogna attivarsi in un certo modo oramai penso sia capitato a tutti voi di ricevere almeno una volta una mail che dice che dovete accedere a un certo seguire un certo link per aggiornare le vostre credenziali di post pay piuttosto che il conto bancario piuttosto che l'account di post o qualunque cosa esso sia perché se non lo fate succede qualcosa entro domani entro 12 ore entro due settimane e spesso volentieri quello è il veicolo poi per attivare un attacco e la leva psicologica appunto è quella della scherzetta la terza nevra che è la consistenza io la associo spesso ritiene anche all'inerzia perché sfrutta l'inclinazione della gente umana a seguire il flusso degli eventi senza deviare da da esso quindi sempre secondo l'idea per cui io faccio il minimo sforzo quando sono ingaggiato in qualche cosa cerco sempre di fare il minimo sforzo quindi le mie reazioni a determinate azioni sono sempre legate a questo tipo di di gioco per cui cerco sempre di tendo sempre a minimizzare lo sforzo e attraverso questi meccanismi si possono montare degli attacchi abbastanza fini per cui l'avversario ti ingaggia inizialmente con in maniera molto easy molto poco costosa dal punto di vista del tempo che questo richiede e quindi è un'interazione che nelle prime fasi è quasi a costo zero e questo è importante perché quando tu vieni ingaggiato da una persona o da un qualcosa che non conosci tendenzialmente no qualcosa che non conosci lo rigetti a meno che non sia un qualcosa che ritieni innocuo innocuo ad esempio dal punto di vista del tempo che ti che ti chiede di investire quindi ti arriva una richiesta che non ti è mai arrivata prima però è qualcosa che ti porta via poco tempo una cosa che non ha conseguenze nell'immediato faccio un esempio banale ti arriva veramente un bonus un sconto però non ti chiede né di usarlo con urgenza né di aprire un link nulla di tutto questo semplicemente ti dice quando tu hai tempo e voglia tu ti puoi recare nel tal posto puoi usare questo bonus sconto magari lo fai dopo una settimana è una cosa che ti ha ingaggiato senza sforzo lo fai lo usi e hai un feedback positivo quindi di fatto cosa è successo senza che tu te ne sia accorto hai creato un legame con quella fonte che fino a poco tempo prima era del tutto sconosciuta è un legame di poco conto basato su situazioni di basso investimento però è già un piccolo gradino la volta successiva lo stesso agente magari ti ingaggia nuovamente facendoti fare un ulteriore piccolo gradino allora a forza di fare piccoli passi voi vi ritrovate lungo un cammino di interazioni per cui senza che ve ne accorgiate di lì a un po' di tempo vi ritrovate ingaggiati in maniera significativa con la controparte cominciate a fidarvi cominciate ad abbassare la la la soglia di attenzione nei suoi confronti fino ad arrivare al punto in cui quella fonte ti fa una richiesta che se te l'avesse fatta quando non vi conoscevate non ci avresti pensato minimamente l'avresti rigettata arrivati a quel punto invece vi viene naturale naturale soddisfare la richiesta ok proprio perché si è creato questa questa inerzia che vi ha portato a fidarvi di quella di quella fonte ok non so se raccontandomi queste cose mi vengono in mente situazioni reali significative però ripeto sono tutti casi in cui per i propri attacchi informatici sono stati poi messi in atto e sono un grande successo aggiungerei il liking è piuttosto semplice nel senso che anche qui si sfrutta la propensione umana ad ascoltare a seguire ad assecondare richieste che vengono da fonti che ci piacciono ok piuttosto che da fonti che non ci piacciono o che non conosciamo no e qui diciamo che l'efficacia di questo genere di neve è molto legata al discorso che facevamo prima sulla sulla fase di harvesting delle informazioni dal web no perché prendete il caso che ne so di di vi arriva vi arriva la famosa mail col buono sconto ok ora se l'avversario vi ha targetizzato come vittima quindi non è che sta mandando la flessa mail a tutti quanti così in massa ma ha targetizzato voi come vittima e quindi ha fatto una ricerca sui su di voi sa quali sono i vostri hobby sa dove mettete i like sui social sa quali sono le vostre pagine preferite cose di questo genere allora molto più facilmente è in grado di costruire no una situazione in cui vi propone un qualcosa vi fa una richiesta cose di questo genere che a voi piace piuttosto che no vi ricordate l'esempio che vi ho fatto l'altra volta sulla segretaria di quell'azienda che era stata avvicinata da da chi doveva fare il penetration testing che non avevano trovato un modo di penetrare la rete aziendale dall'esterno perché era difesa bene la squadra il blue team aveva lavorato bene ma avevano sfruttato la debolezza di un insider cioè della segretaria come l'avevano approcciata un bel giorno in azienda il tipo si è andato a fare delle chiacchiere con la segretaria mentre aspettava di incontrare il Ciso chiacchiera del più e del meno impara che lei ha ha un figlio di età prescolare insomma ha fatto anche se l'ha fatta di persone ha fatto attività di questo genere qua e dopodiché l'ha ingaggiata consigliandole di scaricare un'app per far giocare al suo figlio e da un certo repository l'app però era repackaged da loro e conteneva il malware quindi quando lei ha scaricato l'app l'ha attivata si è attivato il malware nel suo smartphone la prima volta che lei è andata in ufficio agganciando come fanno tutti lo smartphone al wifi aziendale il malware si è attivato e ha creato il breccio per penetrare il sistema ok ma operazioni di questo genere si possono fare comunemente ripeto raccogliendo informazioni su quelle che sono le preferenze degli utenti rispetto a qualunque genere di tema dopodiché se io imparo che la mia vittima è appassionata di barboncini e io gli mando un buon omaggio per la mostra del barboncino che ci sarà fra un mese in una località di mare e so che lei è appassionata di mare è molto più facile che io riesca a ingaggiarla rispetto ad utilizzare una leva generica che può essere lo sconto alla coppia o da qualunque altra parte insomma quindi più riesco a calarmi verticalmente su quelli che sono interessi specifici delle persone più ho probabilità di riuscire a ingaggiare quella quella persona ok e qui entro in gioco gli strumenti di cui parlavamo prima proprio per raccogliere le informazioni vi farò vedere un caso d'uso di una kill chain da A alla Z in cui useremo vi farò vedere come è stato usato un tool per combinare diversi profili virtuali di uno stesso agente e sfruttare queste informazioni per montare un attacco basato sulla direi sulla scarsità non mi ricordo che sfrutta come veicolo un email di phishing ecco questa è la idea e similar al liking c'è l'authority il meccanismo di base è esattamente lo stesso l'unica differenza sta nella propensione che io ho da una parte la propensione è quella di seguire situazioni che mi piacciono dall'altra invece si sfrutta la propensione a ottemperare a seguire richieste autorevoli ok dove per autorevoli che ne so faccio l'esempio vi arriva l'email della guardia di finanza vi telefona vi telefona una persona che si spaccia per carabiniere prete dottore quindi figure autorevoli che anche implicitamente siamo più portati a a seguire piuttosto che no ok una volta questo tipo di leve si usavano nelle truffe telefoniche adesso nella stessa misura si utilizzano sul web ok spesso questo va di pari passo con altre leve come ad esempio la scarsità o la reciprocità perché l'autorevolezza così come il liking si combina bene con le prime due con le prime due leve e l'ultimo esempio ma ripeto ce ne sono innumerevoli altri è la la social validation ovvero quella propensione che le persone hanno a seguire i comportamenti collettivi in situazioni particolari ok non è un caso che molte truffe esplodono quando si attivano i numeri verdi per aiutare le vittime di un terremoto per cui c'è questa percezione per cui la collettività la massa si adopera per aiutare in questo caso che è stato sfortunato e guarda caso in poi lo stesso momento si attivano decine e decine di truffe che sfruttano questo tipo di situazione quindi fonti che si spacciano per ONG ad esempio autorevoli che vi chiedono un contributo perché? perché ieri c'è stato un terremoto devastante in in Cappadocia e quindi bisogna aiutarli e questo tipo di situazioni sono quelle che rendono le persone un pochino più propense a comportamenti che normalmente non avrebbero la sensibilità sufficiente di secondare sì se lo fanno tutti e lo posso fare anch'io perché è una cosa buona è una cosa sicura è una cosa che non può portarmi a nessun tipo esatto esatto questo è un esempio tipico anche tu fai come il migliore di persone che ti hanno preceduto esattamente esattamente l'individuo è sempre portato a inseguire una sorta di validazione da parte della società e quindi tende a comportarsi in maniera conforme a quello che fanno gli altri e questo viene scottato questo è un esempio abbastanza canto anche da questo punto di vista voglio credere che è interessante che spesso che c'è un'amore di una di una di una di una di una di una di una di una dal direttore di dipartimento esatto è capitato un paio di volte nell'ultimo anno che arrivasse una mail dal dal mio direttore di dipartimento una mail di phishing naturalmente che mi chiedeva di fare qualcosa di urgente e lì c'è l'autorevolezza del direttore chiaro che se mi arriva una mail e dico non conosco i mettenti mi chiede di fare una cosa urgente io dico ma cosa vuoi chi se ne frega magari presi dalla fretta dall'urgenza dal timore di non fare qualcosa che mi viene richiesto uno rischia appunto di agire mi ha fatto venire in mente un attacco che la stessa azienda di pentesting di cui io parlavo prima fatto in un'altra situazione però quello era ispirato ad un attacco reale è un attacco reale abbastanza sofisticato tra l'altro condotto quasi esclusivamente via telefono a un certo punto ci sono stati non anche uno scambio di mail ma era partito via telefono e lì è stato abbastanza sofisticato perché l'attaccante aveva monitorato da tempo stava monitorando da tempo un un importante manager di un'azienda ok quindi monitorava gli spostamenti le attività sapeva chi erano le persone sotto le sue dirette dipendenze quali erano le tipologie di mansione che svolgevano e quali erano i clienti con cui avevano rapporto sono informazioni che sembrano sensibili sembrano riservate ma non è così difficile reperire questo tipo di informazioni facendo harvesting su web social engineering e compagnia bella quindi non è così difficile raccogliere questo tipo di informazioni hanno aspettato il momento giusto e il momento giusto è stato un giovedì che il manager partiva per una vacanza faceva un weekend lungo il giovedì pomeriggio arriva una telefonata o una mail non mi ricordo come era nata la cosa a uno dei suoi diretti sottoposti dicendo che si era dimenticato di completare un'operazione con il cliente con cui stavano lavorando in quel periodo morale alla favola chiedeva al sottoposto di completare un bonifico che lui non era in grado di fare perché poi il giorno dopo sarebbe stato in una zona irraggiungibile non aveva connessione questo era vero e non era in grado di effettuare l'operazione e non era la favola il sottoposto ha fatto il bonifico quello è ancora più potenzialmente pericoloso per tutte quelle persone comunque sono di virtuenza su tiktok adesso è abbastanza comune e fanno una marea di video con la loro voce si si si si ma adesso si vede abbastanza comunemente personaggi famosi che fanno dei post che non hanno mai fatto la voce la loro è sintetizzata tramite l'intelligenza artificiale per sfruttare la leva del lightning in quel caso comunque sono tutti attacchi che sono sempre hanno avuto sempre un discreto successo nella maggior parte dei casi non sempre le leve di social engineering di cui ho parlato vanno di pari passo vengono combinate con veri e propri vettori d'attacco quali il phishing ok tipicamente ma non so il phishing coinvolge l'utilizzo di strumenti di comunicazione come la mail una mail di phishing appare esattamente come una mail legittima con la differenza che o contiene direttamente un payload malevolo al suo interno o contiene delle richieste di reindirizzamento verso pagine web o servizi particolari che sono naturalmente non quelli legittimi ok vi farò vedere in un caso d'uso un tool ce ne sono diversi che si può utilizzare per confezionare una mail di phishing in maniera parametrica rispetto ai contenuti che volete inserire all'interno della mail ci sono un sacco di template volete una mail di phishing a oggetto paypal piuttosto che banco posta ci sono i template già preconfezionati dopodiché il contenuto lo stabilite voi stabilite voi il come mascherare attraverso diverse tecniche immittente come far apparire un nome nell'inbox che dice della mail diverso rispetto a quello che naturalmente è i mail che viene proprio utilizzata per veicolarla e quindi converrete con me a un certo punto quando vi farò vedere la mail confezionata che solo dopo un'attenta analisi risulta essere una mail di phishing ad una rapida occhiata assolutamente indistinguibile rispetto ad una mail legittima gli attacchi di tipo phishing nascono con questo tipo di mezzi di comunicazione la mail è sempre stato lo strumento privilegiato non è più l'unico la gente pensa che di dover stare attenta solo alle mail non è più così adesso esistono anche i post su facebook di phishing sembrano post legittimi andate ad aprire succede la stessa cosa che succede con la mail di phishing quindi ci sono tante situazioni legate non solo ai social ma a qualunque servizio online interattivo con contenuti dinamici che si prestano a questo tipo di di situazioni non ti arrivavano più quelli originari no no è assolutamente così vabbè su questo poi vedremo vedremo un po' di esempi di esempi pratici social engineering phishing si usano come ho appena detto spesso in combinazione per portare attacchi anche abbastanza sofisticati come quelli targettizzati di cui io parlavo prima nel caso del manager che è stato puntato personalmente attacchi di questo genere in generale sofisticati di questo tipo prendono il nome di pretexting quindi montati ad arte combinando diverse tipologie di leve diverse tipologie di vettori per costruire un attacco customizzato ok questa un po' è l'idea basandosi appunto sul spesso volentieri sul tentativo di impersonare da parte dell'avversario di impersonare altri soggetti non vi ho citato adesso non ce l'ho qui ah no sì ho il baiting non ho citato il baiting che è qualcosa di opposto rispetto al dumpster diving nel senso che col dumpster diving io vado a ravistare tra tra tra tra tra i fiuti ok quindi cerco di far uscire informazioni da da da da da da da da da quei dispositivi che escono dall'azienda col baiting io cerco di far entrare qualche dispositivo in azienda ok ci sono tanti modi per farlo lo usavano anche i governi i tecnici di baiting l'esempio classico sono le chiavette usb adesso non va più tanto di modo ma fino a qualche tempo fa fino a qualche anno fa c'è stato il periodo in cui agli eventi di qualunque genere il gadget tipico era la chiavetta usb no c'era abbastanza comunemente qualunque tipo di evento ma vengono in mente le conferenze scientifiche perché quello ad esempio è abbastanza eclatante per cui ti regalano la chiavetta all'interno della chiavetta c'è il volume digitale di tutti gli atti della conferenza però è un tipo di situazione oramai abbastanza comune da qualche tempo a questa parte questa moda è passata sta passando quasi quasi del tutto perché perché è cresciuta la diffidenza dovuta alla maggiore consapevolezza che le persone hanno rispetto al baiting ormai sanno tutti che dentro una chiavetta si può nascondere uno spyware un trojan un malware di qualunque genere tra tutti quelli che abbiamo visto la settimana scorsa quando li abbiamo classificati ok e ripeto forse un paio di decenni fa in maniera anche abbastanza ingenua a quello che potremmo pensare adesso i servizi segreti usavano questo tipo di tecnica regalando chiavetta a che ne so all'ambasciatore di turno piuttosto che al console piuttosto che all'ospite di qualche governo straniero perché perché poi dentro la chiavetta c'era celato il malware che consentiva di creare quella testa di ponte che permetteva poi di sfiltrare informazioni dalle macchine che accedeva alla vittima usando vettori che poi vedremo vedremo una volta agganciato un sistema all'anemoto creare una vpn quasi invisibile è abbastanza semplice l'approccio da seguire rispetto a tutto questo tipo diverse tipologie di situazioni comunque è sempre lo stesso cioè avere un approccio cauto non farsi mai prendere dall'urgenza non prendere decisioni avventate ma lasciarsi sempre il tempo di esaminare qualunque tipo di situazioni che ci si para di fronte anche quelle che sembrano diciamo non anomale ok questo è l'unico è l'unico dal punto di vista del comportamento dell'utente è l'unica è l'unica policy che funziona per davvero chiaramente va combinata con tutta un'altra serie di strumenti di cui parleremo quando discuteremo dei meccanismi del blue team e quindi utilizzare software opportuni per aiutarci a identificare ad esempio tentativi di phishing piuttosto che altro così come strumenti sofisticati per l'autenticazione degli utenti insomma tutto quello di cui in parte abbiamo già parlato e che comunque vedremo più nel dettaglio più avanti questo è un esempio di una di una mail di phishing creata con lo strumento che vi farò vedere lo vedete subito dal subject response required quindi carattere di urgenza della mail che vi mette delle condizioni di cliccare su qualcosa ok in questi casi ripeto la mail di phishing potrebbe essere essa stessa il vettore di attacco nel senso che potrebbe contenere già al suo interno il vettore di attacco sotto forma di un malware di qualche tipo oppure potrebbe essere il veicolo per portarvi in un altro luogo seguendo un link dove invece lì risiede l'attacco vero e proprio ok o ad esempio magari lo scopo dell'attacco non è quello di spettarvi con un malware ma di storici informazioni quindi nel caso banale può essere clicca qui autenticati e devi mettere il flag su alcune autorizzazioni che se non ci dai ti blocchiamo il conto nel giro di 24 ore questo è un esempio tipico allora uno prese la fretta dice no prima di domani dobbiamo andare dentro il sito autenticarmi mettere il flag dove viene richiesto che sono cose che normalmente ci chiedono anche i servizi legittimi perché perché cambiate la policy per tanti motivi quindi sono cose che siamo anche abituati in questo caso lo scopo è il data filtration nel senso che voi cliccate sul link mettete le vostre cadenziali ma non le state mettendo sul server legittimo lo state mettendo sul server fake che raccoglie le vostre cadenziali poi le utilizza per autenticarsi nel sito legittimo comportandosi come una sorta di man in the middle attacchi di cui parleremo e che giustificano il fatto come dicevamo prima di usare sempre sistemi basati su autenticazione multifattore perché anche qualora siate vittima di una media fishing di quel tipo lì probabilmente cadete nel tranello rispetto al primo fattore di autenticazione magari fate in tempo a ravedervi prima del secondo o l'attacco magari non prevede non è talmente sofisticato da prevedere il secondo fattore e quindi sfuma ok quindi là dove avete la possibilità di attivare voi fattori di autenticazione multipli fatelo per questo motivo perché il secondo fattore di solito è quello che vi salva da situazioni di questo genere nel 90% dei casi uno sbarramento sufficiente per evitare attacchi di questo genere ok ci vuole un avversario estremamente sofisticato per tra virgolette fregarvi durante un'autenticazione a due fattori ok tipicamente ci vuole un avversario che sia ad esempio in grado di delle immediate vicinanze attraverso che ne so strumenti radio sofisticati intercettare le vostre le vostre comunicazioni si ringrazio per l'uscita quindi stiamo parlando di attacchi impegnativi ecco come deterrente l'autenticazione di 8 ore è già più sufficiente e sono 5 minuti di pausa devo fare una cosa dopo vi racconto i i i i i i i i vedrò anche un po' di dritta su come utilizzarli, perché la maggior parte di quelli che vado a citare sono presenti nel pacchetto che potreste utilizzare se avete intenzione di fare il progetto sul pen testing. Bene, dunque come dicevo prima il riconoscimento interno quindi in forma attiva attraverso l'interazione diretta tra avversario e sistema vittima avviene tipicamente attraverso l'uso di tool automatici, che si dividono in due categorie, tool di sniffing e tool di scanning. I tool di sniffing di solito si limitano a osservare il traffico in entrate e in uscita da un certo sistema, quindi intercetta in news dropping i pacchetti con l'obiettivo poi di analizzarli. Ad esempio per individuare i pacchetti che fanno riferimento a certe applicazioni, ad esempio per individuare i pacchetti che si sa contengono una password, anche se cifrata, poi l'anticamera per condurre utilizzando un altro tool un attacco di brute force attack sulla password. Però la prima cosa fondamentale è individuare il pacchetto che la contiene, che contiene il valore cifrato della password o un hash della password. Quindi tool di sniffing sono uno degli strumenti di solito utilizzati insieme ad altri poi per montare un vero e proprio attacco, con l'obiettivo come dicevamo prima, fase di riconoscimento, massimizzare la quantità di informazioni che io ho a disposizione, io avversario riesco a mettere insieme e che ho a disposizione per identificare determinate vulnerabilità. A volte basta osservare alcuni pacchetti in ingresso e in uscita da un sistema per ad esempio capire che su quel sistema è attivo un determinato servizio, tramite un determinato software con una certa versione di cui è nota una vulnerabilità. Ok? Quindi già facendo sniffing io so già, imparo già qual è la vulnerabilità di cui si offre il sistema, trovo l'exploit adatto per quella vulnerabilità e ho già l'attacco pronto. Ok? I tool di scanning sono un pochino più sofisticati rispetto ai tool di sniffing, in quanto non si limitano appunto a osservare il traffico, ma interagiscono attivamente con il perimetro della rete, interrogando le porte ad esempio, cercando quali sono le porte attive su un determinato server in ascolto, identificando ad esempio qual è la versione del sistema operativo piuttosto che delle applicazioni che sono attive su determinati host in ascolto, e quindi operazioni di questo genere. Lo strumento fondamentale che di solito si usa per fare scanning tra i tanti forse è Nmap, che è particolarmente ricco di informazioni nel momento in cui le utilizzate per investigare quali sono le porte attive, quali sono i software in ascolto e via dicendo. La maggior parte di questi tool utilizzano lo stesso formato standard per la lettura dei pacchetti, che è il formato pick up, e molti di questi spesso e volentieri sono incapsulate all'interno di tool più ampi, che completano l'attività di riconoscimento proponendo già in autonomia direttamente all'attaccante, senza che questo debba fare nulla, qual è la tipologia di vettore d'attacco da utilizzare. Quindi sono strumenti che in linea di massima possono essere utilizzati anche da un inesperto. Lancia il tool, il tool interroga l'host, scopre che su quell'host è aperta la porta per l'FTP, scopre che su quel sistema c'è una lamp basata su una certa versione di Apache, per cui combinando la vulnerabilità di quella versione di Apache, che c'è sempre, con il fatto che c'è la porta FTP attiva, bene, l'attacco più efficace per questo tipo di configurazione è questo vettore qui preconfezionato, che fa parte dei repository di attacchi che il tool ha a sua disposizione. Cosa faccio? Lo lancio? Ecco, e quindi avete già l'attacco pronto ed efficace per il vostro host. La maggior parte dell'attività di pen testing si condone in questa maniera qua, senza dover avere conoscenze troppo specifiche appunto su quelle che sono la natura delle diverse vulnerabilità. Esistono già dei repository che fanno questo lavoro al posto nostro, quindi dobbiamo solo lanciare gli strumenti giusti e lasciare che siano loro a fare il lavoro. Quali sono gli strumenti principali di questo tipo? Vediamo una piccola carrellata, partendo da tool di sniffing. In ambiente Linux, tra i primi che sono diffusi, abbiamo Prism Dump e TCP Dump. Adesso sono meno utilizzati, però sono abbastanza efficienti per quanto riguarda la raccolta dei pacchetti di entrata e uscita. In particolare, TCP Dump è in grado anche di fare attività di analisi sui pacchetti che vengono raccolti, classificandoli in base all'applicazione di riferimento, alla tipologia del pacchetto e quindi andando a individuare quali sono i pacchetti che vale la pena esaminare in maniera più approfondita rispetto a determinati scopi o anche semplicemente per raccogliere informazioni. Nmap, come vi dicevo prima, è quello che chiunque di voi voglia fare il progetto di pen testing sicuramente si ritroverà ad utilizzare o nella versione puramente testuale da dado terminale o nella versione con interfaccia grafica che perde il nome di Zemmap. Nmap fa di tutto, fa sniffing, ha strumenti per lo scanning delle porte, chiaramente fino al livello IP della nostra cipolla Isosi. Qui tutte le informazioni, tutti i metadati caratteristici del livello IP sono catturati senza problemi da Nmap. In più, ha strumenti di scanning che vi consentono non solo di interrogare quali sono i servizi disponibili su un determinato host, ma ha anche servizi di scanning che vi permettono di esplorare una rete, una LAN ad esempio, con l'obiettivo di individuare quali sono gli host in ascolto su quella LAN e in ciascuno di questi quali servizi mette a disposizione. Quindi è un tool che potete usare anche per esplorare la topologia di una rete che non conoscete e cui magari avete avuto accesso per la prima volta attraverso un host che fa da front-end e da lì in avanti volete sapere come muovervi ulteriormente. È in grado anche di stabilire informazioni piuttosto dettagliate sul versioning delle applicazioni in ascolto sulle diverse porte e se sono attivi degli strumenti anti-intrusione. quindi intrusion detection system, firewalls, intrusion prevention system, strumenti di questo genere. Questo è importante perché spesso volentieri questi strumenti vengono messi in campo anche con l'intento di individuare tentativi di riconoscimento interno in una rete protetta decentemente attraverso questo tipo di strumenti voi non vi potete permettere di fare scanning a 360 gradi di tutte le porte, di tutti gli host che trovate nella landa perché se fate così dopo tre secondi venite buttati fuori. Ok? Proprio perché gli strumenti di intrusion prevention system sono attrezzati per intercettare questo tipo di attività. quindi prevenire l'attacco interagendo sui suoi precursori. E quindi NMAP non è in grado di mettere in atto contromosse rispetto a quelle che DBS mettono in campo per bloccare questo genere di attività. NMAP non è uno strumento nato ad uso e consumo di chi fa Red Team, Blue Team è uno strumento, un utility estremamente importante, estremamente efficace, storicamente utilizzata dai sistemisti di rete e quindi nasce con ben altre finalità. Poi, come per tutte le cose, nel momento in cui se ne vuole fare un uso malevolo ecco che le sue funzionalità possono diventare un problema. Ok? Poi invece ce ne sono altri che vedremo che invece sono stati sviluppati con l'intento specifico di attaccare un sistema, quindi con una intenzione malevola fin dall'origine. Questo è ad esempio il caso di Nessus, che è un tool sempre di scanning come NMAP, ma che ha integrato al suo interno delle funzionalità tipiche dell'hacking. Quindi, ad esempio, meccanismi per cercare di recuperare le password attraverso brute force attack. Come dicevo prima, una volta individuati i pacchetti che contengono la cifratura o l'hash di una password, ecco che strumenti come Nessus all'interno possono operare direttamente per cercare attraverso un attacco a forza brutta di recuperare la password in chiaro. Poi, tra l'altro, Nessus interagisce con altri tool che fanno, che ad esempio confessionano i vettori d'attacco e poi li implementano. Tutto questo lo troverete tutto insieme all'interno di un unico sistema che vi accompagna nelle fasi di riconoscimento interno fino ad arrivare alla fase di breach vera e propria. Quindi, in pratica, quasi senza know-how da parte vostra. Scanrun e Wireshark sono altri due esempi di tool di scanning. Wireshark è un po' come Nessus, nel senso che è un tool con chiare intenzioni malevole perché anche questo come Nessus ha la capacità di identificare, ha le funzionalità per andare a identificare nei pacchetti che vede passare quali sono quelli che hanno contenuti sensibili rispetto a determinate operazioni legate alla sicurezza. L'esempio tipico è l'autenticazione. Con Wireshark in mezzo a un traffico di pacchetti anche cifrate riuscite a individuare i pacchetti che contengono le informazioni relative all'autenticazione che, barra caso, di solito sono quelli che al loro interno contengono che cosa? Contengono gli hash delle password piuttosto che altre informazioni cifrate relative alle credenziali. E trovare quei pacchetti poi significa poter operare attacchi magari usando altri tool per la ricerca del password in chiaro. Un tool che racchiude tutte le funzionalità che vi ho raccontato adesso dallo sniffing in avanti e che troverete nel pacchetto che vi fornirò è Metasploit. È uno dei più utilizzati in assoluto. Metasploit vi trova la vulnerabilità se c'è, vi propone il vettore di attacco più adatto per sfruttare quella vulnerabilità e se volete vi lancia l'attacco fino al breach. Quindi copre tutte le fasi dalla vulnerability search all'attacco vero e proprio e al breach. Si ferma di fronte all'escalation quella è una fase che poi dovete portare avanti utilizzando altri strumenti. Quindi è entrato il sistema se avete necessità di spostare all'interno del sistema elevando i vostri privilegi dovete usare altri strumenti. spostare si si esatto allora guarda i tempi di reazione sono quelli di repository come Mitra Attack o altri repository a livello mondiale dove vengono pubblicati tutti gli zero day che saltano fuori dall'oggi al domani nel giro di non appena c'è la patch questi vengono pubblicati in alcuni repository pubblici su scala mondiale. Quello che vedremo lezioni è quello della Mitre che vi farò vedere lì c'è tutto. Un bravo blue team dovrebbe fare riferimento a questi repository. Quindi il tempo di reazione del blue team dipende da quanto sono diciamo sensibili a questo tipo di problema legato all'aggiornamento. I tempi di reazione dei repository pubblici sono quasi istantanei. Oggi c'è lo zero day tra due giorni lo trovate pubblicato su Mitra Attack non appena c'è la patch quindi quei tempi di reazione lì sono immediati. Quanto ci mette il blue team ad adattarsi purtroppo le cronache ci dicono tutt'altro perché se pensate che vi farò vedere la cronistoria di un ransomware che è da quando è nato a quando è stato diffuso a quando è stato debellato ok e vi dirò che tre mesi no forse sei tra i tre e sei mesi dopo che il ransom è stato debellato sono state pubblicate le patch e via dicendo è uscito un altro ransomware leggermente diverso rispetto a quello ma che sfruttava le stesse vulnerabilità e ha avuto quasi lo stesso successo questo cosa vuol dire? vuol dire che tre mesi quattro mesi cinque mesi non sono bastati alla maggior parte dei blue team per adeguarsi a quello che era successo nei mesi precedenti quindi i tempi sono variabili da questi quindi metasploit è uno strumento che se farete pen testing userete di solito negli esercizi di didattici di pen testing si usa in combinazione con una macchina vittima che guarda caso si chiama metasploitable ok quindi avete metasploit da una parte e metasploitable dall'altra che è una macchina che monta già di suo alcune vulnerabilità note e che voi potete divertirvi a cercare ci sono diversi livelli di difficoltà usando metasploit ok e uno dei compiti una delle attività tipiche legate allo sniffing allo scanning consiste poi da parte dell'attaccante nel cercare quelle informazioni sensibili come password credenziali che se svelate potrebbero permettergli in maniera abbastanza banale di bypassare i sistemi di controllo autenticandosi come utenti autorizzati ok quindi c'è una pletora di tool a disposizione letteratura per fare per effettuare l'attacco alle password attraverso tecniche basate sulla ricerca brutta adesso non vi sto a dare i dettagli perché quando studieremo i protocolli di identificazione quindi i classici protocolli scrittografici che si usano per in fase di autenticazione e in particolare studieremo i protocolli di identificazione basati su password cioè come una password viene trasmessa qual è l'hand shake tra chi si deve autenticare e chi deve verificare l'autenticazione comunque ci sono diverse tecniche ne vedremo e a monte di queste una delle costanti è che a un certo punto un'informazione sensibile viene trasmessa di solito non è mai la password ok ma è un valore che deriva dalla password il cosiddetto hash della password che è il risultato dell'applicazione di una funzione non invertibile sulla password non mi do i dettagli perché le funzioni hash le studieremo in una delle prossime in una delle prossime lezioni questo per arrivare a dire cosa che anche facendo scanning in maniera efficace potresti individuare un pacchetto che contiene cifrate determinate informazioni io per qualche motivo riesco a risalire non alla password ma al valore hash della password che è un valore ripeto non invertibile cioè un avversario efficiente un algoritmo efficiente preso l'hash della password non è in grado di risalire in tempo polinomiale alla password che lo ha generato l'unico attacco che si può portare in maniera decente è quello nei confronti della debolezza della password che è stata scelta perché è un attacco basato sulla ricerca forza brutta ci sono dei dizionari di password no? per cui se la vostra password a partire a quel dizionario io mi calcolo l'hash di tutte le password dei dizionari è una cosa che posso anche precalcolare faccio il confronto e vedo se la password la vostra password fa parte di quel dizionario se la vostra password è password o 123456 probabilmente fa parte di quel dizionario quindi probabilmente anche se la vostra password non viaggia in chiaro viene comunque violata perché è facile trovare qual è il valore che ha generato l'hash che voi trasmettete ok? questo per dire in due parole le cose che andremo a vedere un pochino più nel dettaglio tu come caino e abbe John the Ripper e Hydra sono tool che combinano attività di scanning e identificazione di informazioni sensibili come le passano all'interno dei pacchetti per poi attuare attacchi di ricerca forza bruta del tipo che vi ho appena appena detto si possono si può si si si si si si si si si si si sono adattabili ok? anzi spesso e volentieri sono tu che sono collegati dei repository dove vengono ottenuti aggiornati questi questi dizionari ok? quindi crescono continuamente e sono estremamente efficaci dal punto di vista del performance perché? perché sono attacchi che si possono fare offline se io vedo passare un hash della password non ho bisogno di interagire con un sistema ho il mio dizionario mi metto lì lo faccio lavorare e se c'è la trovo prima o poi non è che ho bisogno di interagire con un sistema con una latenza che mi dà un numero limitato di tentativi nel tempo niente di tutto questo ok? quindi sono pericolosi proprio per questo per questo motivo qua e qui rientra il discorso che facevamo l'altra volta legato al fatto che oggigiorno ogni 6-12 mesi si allunga di un carattere la lunghezza delle password che vi viene richiesta o della tipologia di diversi caratteri che dovete usare per formare la password il motivo di tutto questo è che i dizionari per gli attacchi offline sono sempre più sofisticati sempre più ricchi e quindi bisogna aumentare le dimensioni dello spazio di ricerca questo è un po' è è l'idea poi c'è tutto un mondo a parte di tool per fare sniffing scanning e hacking delle password che però riguarda il mondo delle reti wireless ok? quindi gli stessi strumenti che prima ho elencato e che si adattano a un contesto wired in questo caso invece funzionano per le reti wireless che hanno protocolli loro hanno formati loro per i pacchetti hanno modi diversi di gestire il traffico e quindi i tool devono adattarsi a queste diverse funzionalità questi tre sono tra i più utilizzati in questo ambito è accessibile sì è per adesso dovrebbe essere sempre più rara questo tipo di situazione però capita ancora sì sì si spera che nel frattempo si siano adeguati comunque le reti wireless per i motivi che abbiamo detto anche un po' di tempo fa sono fisiologicamente più deboli rispetto alle reti wired e il motivo è le minori risorse di calcolo che sono a disposizione nei vari dispositivi al di là della configurazione che invece dovrebbe essere quella fatta con tutti i crismi come dicevo prima la fase di riconoscimento è precursore alla definizione di un vettore d'attacco ok che rappresenterà lo strumento per fare breccia nel sistema ok come si conduce l'attacco dipende dal tipo di vulnerabilità che è stato individuato a volte non ci dobbiamo neanche preoccupare di trovare la vulnerabilità di definire l'attacco perché ci sono dei tour che lo fanno al nostro posto qui ho messo una tassonomia abbastanza ad alto livello di diverse tipologie di attacco realo che si basano su diversi vettori che dovessero emergere come più efficaci a seconda delle vulnerabilità che sono state individuate un attacco o exploit usando un termine più specifico come abbiamo già entrato la volta scorsa assume tante diverse forme un furto di credenziali è un attacco ok ma anche l'injection di un malware è un attacco quindi cose completamente diverse ma che hanno comunque finalità comuni sono considerabili vettori di attacco ok quindi rubare credenziali che siamo riusciti a individuare facendo scanning e facendo un attacco a forza brutta con i tour che abbiamo visto prima la vulnerabilità è la password debole l'attacco è io la uso per autenticarmi al posto dell'utente legittimo ok facendo scanning ho trovato che sulla porta tal dei tali di un certo host attivo un servizio che risale a una versione di due anni fa non è peccato e ha una vulnerabilità documentata ecco che io so che usando determinati vettori posso usare quella vulnerabilità è passare i controlli e entrare nel sistema quali possono essere questi vettori che ne so un software che non è peccato la presenza di una backdoor qualunque genere di un malware iniettato attraverso un un'interfaccia web a seconda del tipo di servizio che è ad ascolto quindi javascript piuttosto che piuttosto che altro una vulnerabilità del cms e via dicendo lì ce n'è di tutto di più a volte l'attacco di tipo zero day cioè nel senso che non la vulnerabilità che trovate è nuova non è mai stata sfruttata dovete predisporre un attacco completamente nuovo per sfruttarla e quindi in quel caso si tratta di un attacco tipo zero day mai visto prima allora quello è un altro mondo ancora il phishing può essere esso stesso un vettore d'attacco se si porta dietro un payload malevolo come dicevamo prima e via dicendo adesso gli esempi sono innumerevoli vi farò vedere qualche caso d'uso sufficientemente generico da adattarsi a tanti diversi a tanti diversi contesti ad esempio per quanto riguarda le password deboli questo discorso che avevamo già fatto avevamo già anticipato il fatto che gli utenti a volte usano le stesse credibilità in sistemi diversi e le social di un genio ci può aiutare a identificare i diversi portili virtuali adesso quello che mi interessa nel dettaglio è andare a vedere un po' come cercare di violare attraverso il brute force attack queste password a volte non serve neanche perché con un attacco di tipo phishing è l'agente umano stesso che ci rivela qual è la password senza doverla attaccare il caso d'uso di cui volevo parlare per portare un esempio abbastanza significativo riguarda una tecnica di gestione dell'autenticazione basata sul paradigma del pass del hash usata sia sotto windows che sotto linux come vi dicevo prima in questi sistemi di solito non si salva mai la password ok ma si salva l'hash della password cioè un valore che deriva dalla password attraverso l'applicazione della funzione non invertibile ok questo per motivi di sicurezza perché perché se qualcuno ha accesso al che ne so al DBMS se lì c'è una tabella che contiene le password degli utenti che accendono al database o qualunque altro tipo di server io per qualche motivo ho accesso alla macchina vado a vedere qual è la tabella qual è il file delle password me le ritrovo ed ecco che ho violato le credenziali di tutti gli utenti questo è il motivo per cui si memorizzano gli hash e non le password stesse se andate a vedere non so tra i vari dbms avete visto qualche dbms avete visto mysql come dbms vi siete mai presi la briga di andare a vedere come è fatto il database di amministrazione di mysql è un database dove ci sono alcune tabelle che contengono informazioni su che cosa su gli utenti registrati su quel dbms quali sono le autorizzazioni che hanno quegli utenti cioè su quali database all'interno gestito dal dbms l'utente ha accesso quali sono le credenziali di accesso di ciascun utente sul dbms e c'è una tabellina dove c'è il campo username e il campo password ok però nel campo password non trovate la password di un chiaro trovate una stringa illegibile pseudo-random che è che cos'è è l'hash della password nel caso nel caso di vedremo adesso quando vedremo le funzioni di hash ve lo dirò nel dettaglio nel caso di un sql non è neanche l'hash è il doppio hash è l'hash dell'hash della password comunque fatto sta che il utente che ha accesso alla macchina per qualche motivo si ritrova non con le password ma con gli hash delle password un meccanismo analogo viene usato anche per il passaggio delle credenziali da un sistema all'altro questo è tipico dei sistemi di tipo single sign on ok cioè voi vi autenticate presso un servizio e per passare da quel servizio a un secondo servizio non dovete riautenticarvi presso il secondo servizio ma sono i due servizi che dialogano tra di loro ok quindi di fatto dal vostro punto di vista quell'unica autenticazione che avete fatto vi dà accesso a molteplici servizi no nell'arco della stessa sessione come fanno a dialogare questi servizi non è che si passano in chiaro tra di loro le vostre credenziali si passano l'hash della vostra della vostra password un protocollo tipico che si usa e assomiglia molto a quelli che studieremo più avanti quando faremo i protocolli criptografici è quello implementato all'interno di un protocollo di autenticazione client server di Windows che è il protocollo Ntlm che fa la seguente cosa l'utente quando si deve autenticare fornisce il proprio username ok al server dall'altra parte viene passato lo username ma non viene passata la password ok dall'altra parte il server che cosa fa genera un numero casuale quello che qui viene chiamato nonce e lo restituisce al client il client che cosa fa il client deve usare l'hash della password ok come chiave per cifrare con un cifrare simmetrico qualunque tra quelli che abbiamo visto il valore casuale ricevuto dal server ok e lo restituisce al server il server cosa fa fa la verifica siccome il server conosce l'hash della password del client fa la stessa cosa la usa come chiave per cifrare il nodes che aveva generato se i due ciphertext coincidono ecco che il server non ha la prova di autenticazione del client però vedete è un esempio di situazione in cui l'informazione usata per l'autenticazione non è la password ma è l'hash della password ripeto nei sistemi basati su single sign on voi vi ritrovate gli hash delle password degli utenti i memorie distribuiti tra i vari service provider perché le informazioni che si scambiano si basano sull'uso di questi di questi hash ok tutti i sistemi basati sul paradigma pass the hash sono basati su questa idea qua l'end shake di autenticazione si basa sulla conoscenza dell'hash della password e non la password memorizzata non la trovate da nessuna parte ok di fatto conoscere lei si si si non mai fatto infatti nei passaggi da provider da provider se io entro in possesso dell'hash riesco riesco a esportare l'autenticazione anche da altri servizi senza conoscere la poste si serve per la prima autenticazione serve per la prima autenticazione che fa il client perché il client non ha l'hash della password memorizzata lo calcola quando l'utente visita la password poi dal di là in avanti quando si espande tra i vari provider la password non serve più è uno dei motivi però diciamo che è una delle situazioni in cui conoscere l'hash è già sufficiente per attaccare i sistemi di single sign on senza da quella attraverso il brutto forse attack dover per forza risalire alla password in chiara questo ripeto è un dialogo che coinvolge i diversi provider dei servizi e va bene no niente adesso non c'è più tempo la prossima volta vi faccio vedere qualche altro esempio di vettore d'attacco basato sull'injection di informazioni di dati o anche di comandi aspetta che intanto aspetta un secondo per��