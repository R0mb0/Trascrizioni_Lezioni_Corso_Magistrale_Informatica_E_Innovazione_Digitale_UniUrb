Bene, ieri abbiamo iniziato un po' a introdurre quelli che sono alcuni elementi che caratterizzano un po' lo scenario relativo alla security posture degli ambienti aziendali ed eravamo arrivati a introdurre le due facce della medaglia, i due diversi approcci, quindi da una parte il team degli attaccanti e dall'altra il team dei difensori. Chiaramente tratteremo quello che è un po' il ciclo di vita della gestione di un attacco dal punto di vista degli attaccanti, quindi parleremo di quella che viene chiamata kill chain e dall'altra parte invece parleremo di quelle che sono invece le attività, le azioni che il team blu deve intraprendere rispetto a protezione del perimetro, rispetto a detection delle minacce, rispetto infine alla risposta che si deve mettere in atto ogni qualvolta il perimetro viene violato e quindi anche rispetto al team blu vedremo quello che è un po' il ciclo di vita della gestione degli incidenti. Prima di iniziare a vedere i due diversi approcci, noi oggi inizieremo con la kill chain e quindi inizieremo con l'approccio dal punto di vista del red team, chiudiamo questa serie di slide introduttive con un piccolo esempio che mostra la timeline di un tipico incidente di sicurezza e attraverso questa timeline vediamo come si intersecano da una parte le attività della kill chain, quindi cosa fa il red team, dall'altra invece le attività del blue team, quindi le azioni che vengono messe in campo per proteggere il perimetro, identificare incidenti di sicurezza e rispondere. Quindi immaginatevi un contesto aziendale generico, questa linea temporale mostra una sequenza di eventi a partire da uno scenario in cui tutto sta funzionando correttamente, non ci sono segnali alert di alcun genere nella fase 1. Già da questo punto di vista è chiaro che è importante, e qui mi riferisco chiaramente al blue team, è importante definire in maniera chiara che cosa significa dire che il sistema sta funzionando correttamente. perché se io non ho idee chiare su quelli che sono i parametri che caratterizzano un funzionamento normale, è chiaro che poi faccio fatica a identificare situazioni anomale. e quindi anche nei momenti, chiamiamoli tranquilli, in cui non sta succedendo niente, il blue team deve comunque avere attività di monitoraggio attive che permettano di stabilire che siamo in una fase di tranquillità, non sta succedendo nulla. Quali sono gli indicatori che mi permettono di concludere che non sta succedendo nulla di strano? E vedremo quali sono gli strumenti di protezione che aiutano a dare una risposta a questo tipo di domanda. Poi a un certo punto succede qualcosa, questo è l'esempio classico. Come? Sì, e quindi diciamo che prima di tutto dobbiamo capire qual è la situazione normale, anche perché così non scegliamo magari casi limite, esempio momenti magari in cui era particolarmente vulnerabile il sistema, cioè noi dobbiamo avere la baseline. Allora la baseline è indispensabile per capire quali sono i valori degli indicatori interessanti, vedremo quali sono questi indicatori, che mi permettono di concludere che non siamo sotto attacco. Sì. Ok? Perché poi come vedremo nella maggior parte dei casi, gli attacchi prima di, diciamo, essere identificabili, no? Sì. Purtroppo c'è tutta una fase preliminare durante la quale noi rischiamo di non accorgerci di essere sotto attacco. Ce ne accorgiamo quando l'attacco manifesta i suoi effetti, ma in quel caso spesso e volentieri è troppo tardi. Sì. Ok? E quindi è fondamentale riuscire a intercettare il prima possibile eventuali vettori d'attacco proprio per neutralizzarne l'effetto il prima possibile. Per questo la baseline è importante da questo punto di vista. Ci sono degli strumenti che servono appunto per stabilire qual è una baseline e quali sono i possibili indicatori di compromissione. Poi chiaramente c'è tutta una problematica relativa agli indicatori che risultano essere dei falsi positivi. E lì diventa importante fare uso di strumenti automatici che servono appunto per filtrare questo tipo di situazioni. Ma di questo poi parleremo più a profondità. Più avanti. Ok? Sì. Poi a un certo punto succede qualcosa che magari ancora non è rilevabile, non è rilevato dai sistemi. L'esempio tipico è l'utente che apre una mail sospetta. Magari lui per primo non se ne accorge di aver fatto qualcosa che non doveva. E qui prima ancora degli strumenti di protezione giocano un ruolo fondamentale in attività di training. Gli utenti devono essere consapevoli di quelli che sono i rischi di sicurezza. Anche gli utenti inesperti. Perché spesso e volentieri è proprio dalla loro, chiamiamola superficialità, che poi nascono situazioni indesiderate. Poi cosa succede? Succede che per un certo lasso di tempo i sensori degli strumenti di protezione non rilevano nulla di anomalo. E questa latenza deriva in parte dal fatto che non esistono sistemi di protezione che siano efficaci ed efficienti al 100%. Quindi un periodo di latenza lo si paga inevitabilmente dal punto di vista degli strumenti di identificazione. E questo mette in evidenza quanto è importante la consapevolezza e quindi il training degli utenti. Perché la durata di questa fase 3 è uno dei fattori più problematici in assoluto. Perché impatta su uno degli indicatori più importanti, che è appunto la durata media della latenza che c'è tra il momento in cui si attiva l'attacco e il momento in cui questo viene identificato. Forse è uno dei parametri più importanti in assoluto. Ad un certo punto succede qualcosa per cui iniziano i primi alert. Ad esempio l'utente, quello che aveva aperto la mail sospetta, ad un certo punto si accorge che non riesce più ad autenticarsi, usando le proprie credenziali. Questo è un esempio tipico. E quindi l'utente appunto solleva un alert. Questo fa sì che si inneschi un processo di gestione di quello che per il momento non è ancora un incidente di sicurezza, ma è solo un indicatore di compromissione che va investigato. Potrebbe essere un falso positivo, oppure potrebbe essere il segnale di un vero e proprio incidente di sicurezza. Anche qui c'è da pagare una latenza, un tempo che trascorre durante il quale c'è un'attività di investigazione. Ad esempio, che ne so, il team di sicurezza va a osservare quelli che sono i log di sistema che potrebbero contenere delle informazioni utili su quanto è successo. Ci sono diversi strumenti a questo proposito. Ad un certo punto vi farò riferimento ad un tool che mette a disposizione un'interfaccia grafica molto user-friendly per navigare nei log di sistema. e andare a vedere se c'è qualche indicatore o qualche indizio nell'audio sistema che conferma, ad esempio, i sospetti relativi a un determinato attacco a seguito dell'indicazione da parte dell'utente. Vi farò vedere anche un tool dove fare qualche esperimento da questo punto di vista. Quindi, Quindi l'indicatore, diciamo, questa report da parte dell'utente del fatto che non può dedicarsi è un indicatore di attacco, si può dire? È un alert. È uno di diversi possibili alert che attivano, diciamo, il team di sicurezza. E quindi gli indicatori sono indicatori di attacco, di vulnerabilità, come si dice? Beh, allora, sono alert come questo, sono dei potenziali segnali di attacco. Il motivo per cui l'utente non è in grado di autenticarsi potrebbe semplicemente essere che non si ricordi di aver cambiato la password, ok? O ha dimenticato la password. Quindi ancora non abbiamo la certezza del fatto che non riesce ad autenticare o, ad esempio, che ne so, un crash del sistema, dovuto ad altri tipi di anomalie. Quindi ancora non abbiamo la certezza del fatto di essere sotto attacco. Per questo è che è necessario investigare per capire se quell'indicatore di compromissione è reale oppure no. Sì. Potrebbe essere un falso positivo. Cioè potrebbe essere dovuto ad altri motivi. Per questo, tutti gli alert che provengono, in questo esempio, l'alert proviene dall'utente. In altri casi, gli alert arrivano dai sistemi di sensoristica, arrivano da un firewall, arrivano da un EDR, arrivano da un SIEM, quindi da software di monitoraggio e di controllo, ok? Quindi, gli indicatori di compromissione possono arrivare da diverse fonti. A un certo punto, quando arrivano questi indicatori, le informazioni vanno combinate per andare a vedere se effettivamente messi assieme questi indicatori rappresentano indizi di un vero e proprio attacco. Ok? Sì. Vi racconterò un po' quali sono strumenti che sono preposti a questo tipo di monitoraggio. Quindi si mettono insieme i loro risultati per capire se effettivamente è un attacco o no. Esatto, esatto. Ok. Quindi, oltre alla latenza dovuta alla fase 3, durante la quale ancora non si avevano questi indicatori, si va ad aggiungere la latenza della fase 5, diciamo, durante la quale si raccolgono queste informazioni, con lo scopo di, diciamo, filtrare tutti quegli indicatori che in realtà non sono direttamente correlati a incidenti di sicurezza, ma magari a qualcos'altro. Poi magari a un certo punto si arriva a confermare l'attacco, si hanno sufficienti indizi del fatto che siamo sotto attacco, quindi nella fase 6, e vedete che dallo step 2, dall'inizio dello step 2 allo step 6 può passare molto tempo, possono essere minuti, ma possono essere anche giorni. e questo è l'intervallo di tempo più critico, perché è un intervallo di tempo durante il quale noi non stiamo reagendo ad un attacco in corso. Dopodiché nello step 6 inizia la risposta. Qui naturalmente il team di sicurezza seguirà sperabilmente un protocollo di gestione dell'incidente che prevede una serie di attività durante le quali gli obiettivi sono innanzitutto neutralizzare l'attacco, ok, e in seconda battuta mitigarne gli effetti. Ok, anche qui vedremo che ci sono diverse cose da fare. Poi naturalmente ci sarà una reportistica, quindi il feedback di tutto quello che è successo durante la timeline viene registrato perché poi contribuisce ad alimentare il ciclo di vita per quanto riguarda le attività che sono a carico del team blu e quindi questo feedback poi periodicamente può portare ad esempio a riprogettare i sistemi di protezione, di prevenzione, di risposta a seconda delle criticità che sono state riscontrate ed esperienza serve sempre un po' per migliorare nelle fasi successive. Ok, quindi questo è un esempio del ciclo di vita di un incidente tipico e del modo in cui il team blu dovrebbe reagire. Cosa succede dall'inizio della fase 2 all'inizio della fase 6 diciamo che dipende dalla kill chain ovvero dipende da quella sequenza di eventi di attività che vengono messe in atto dalla squadra rossa dal team. Ok, e noi oggi inizieremo a vedere appunto diciamo mettere in fila un po' quelle che sono le diverse attività che caratterizzano la la kill chain. Ok, tutto chiaro? Ci sono domande? prof, ma dalla parte dell'attaccante c'è la kill chain che sono la serie di azioni da parte degli attaccanti dai pensori non c'è un termine particolare per indicare i sistemi di protezione? No, non c'è un termine particolare diciamo perché sono una risposta all'atto pratico quello che viene fatto nella kill chain? Ok, non è solo una risposta la risposta è una delle attività critiche del Blue Team ma ci sono anche chiaramente a monte protection e detection protection quindi decidere quali su quali strumenti investire per la protezione del perimetro di sicurezza e questo dipende sempre dall'esito di attività di analisi dei rischi che il Blue Team deve fare detection viene di conseguenza perché gli strumenti di protezione devono servire anche per identificare attacchi in corso e infine la risposta però non c'è un termine univoco per descrivere tutte le attività complesse che il Blue Team deve mettere in alto sì diciamo che sono tutte le corrispondenti attività rispetto alle fasi della Kill Chain sì sì sono lo specchio di tutto quello che caratterizza la Kill Chain naturalmente insomma due facce di una stessa medaglia no? del stesso attacco sì sì sì sì quindi cominciamo a vedere come agisce il Red Team ok? e quindi cominciamo a vedere quali sono le frasi del di un di un attacco no? no ho messo in pausa la condivisione scusate abbiamo fatto però vediamo la side 3 un attimo che mi risulta in pausa so perché dove siamo? aspetta non lo vedo più riprendo grazie non lo vedevo poi mi si sposta ok e vabbè ci siamo allora cominciamo a vedere quali sono le fasi che caratterizzano la la Kill Chain i tre diciamo elementi fondamentali che caratterizzano la Kill Chain e che sono associate alla timeline che abbiamo mostrato prima nell'esempio riguardano innanzitutto la ricerca di vulnerabilità la prima cosa che un attaccante deve fare quando identifica un potenziale target è capire se quel target ha delle vulnerabilità che possono essere sfruttate ok una volta identificate le vulnerabilità l'attaccante prepara quello che in gergo viene chiamato exploit che quindi può essere una una tecnica per aggirare un determinato tipo di controllo può essere un malware può essere l'applicazione di un metodo di social engineering insomma ci sono tanti modi come vedremo di confezionare un exploit e l'attaccante sulla base di vulnerabilità che ha identificato confeziona l'exploit e lo lancia se questo è successo il sistema chiaramente viene il perimetro del sistema viene aggirato il sistema viene penetrato e a questo punto una volta che l'attaccante è dentro il sistema di solito ha necessità di muoversi all'interno del sistema che è stato penetrato ad esempio perché il punto del perimetro di sicurezza che è stato violato non è quello dove risiedono gli asset che l'attaccante vuole recuperare ok vuole violare e quindi ha bisogno di spostarsi spostarsi all'interno del sistema significa ragionare in due essenzialmente due modi distinti ovvero spostarsi lateralmente se ad esempio occorre che ne so spostarsi da una macchina all'altra da una lana all'altra e quindi occorre in qualche modo trovare il modo di navigare all'interno del sistema che è stato violato ma spostarsi significa anche in certi casi muoversi verticalmente cosa significa questo significa elevare i propri privilegi perché l'attaccante potrebbe essere riuscito sì a penetrare il sistema ma magari non ha ancora le credenziali di accesso necessarie per accedere agli asset e quindi ha bisogno di fare quella che viene chiamata attività di escalation quindi elevare aumentare i propri privilegi di accesso per raggiungere il target quindi le due attività tipiche prendono il nome di lateral movement o escalation che sono appunto gli spostamenti orizzontali e verticale dopodiché una volta raggiunto l'asset naturalmente l'attaccante completa la propria attività a seconda di quelli che sono i suoi obiettivi che possono essere semplicemente che ne so data exfiltration quindi violazione di confidenzialità o può anche essere arrecare un danno in termini di compromissione delle funzionalità del sistema qui chiaramente dipende da quali sono gli scopi di solito all'interno di questa terza fase può essere utile per l'attaccante anche cercare di mascherare la propria attività quindi cancellare le tracce no in maniera tale da rendere difficoltoso per il team blu verificare l'incidente di sicurezza ok spesso volentieri uno degli scopi dell'attaccante non solo penetrare il sistema e raggiungere gli asset ma in qualche modo rendersi invisibile per mantenere una presenza all'interno del sistema che non sia chiaramente rilevata perché di fatto nel momento in cui un attacco viene rilevato entra in azione l'attività di risposta del team blu e quindi diciamo a quel punto l'attaccante non ha più modo di continuare a infliggere un danno ok quindi delle volte la durata la persistenza dell'attacco hanno un ruolo chiave in certi contesti prof quindi una volta usato l'icepite per entrare nel sistema per arrivare agli asset può fare o lateral movement dove si muove tra diverse macchine o escalation dove ovviamente i suoi privilegi hanno il sistema o entrambe le cose chiaramente ok quindi io sì sì e poi raggiunto il target infligge il danno che è sequestrare il file eliminarlo dipende ad esempio un obiettivo potrebbe essere quello di ripulire i log di sistema per appunto eliminare tracce e indizi che come dicevamo prima sono quelli che poi sollevano gli alert sulla base dei quali il blue team identifica no quegli indicatori che rappresentano la prova di un attacco in corso ecco allora partendo dalla vulnerability search quindi prima cosa che l'attaccante deve fare è chiaramente una volta individuato il target scoprirne eventualmente le vulnerabilità e da questo punto di vista chiaramente sono diverse cose che possono essere messe in campo dall'attaccante fondamentalmente le attività di riconoscimento delle vulnerabilità possono essere esterne o interne ok sono esterne quando queste attività non richiedono di interagire direttamente col sistema col sistema target ok ad esempio qualunque attività di intelligence che l'attaccante fa senza dover interagire col sistema direttamente ecco che rientra in questa in questa categoria ne vedremo alcuni esempietti no invece le attività di riconoscimento cosiddette interne sono quelle che richiedono un'interazione diretta tipicamente tipicamente attraverso tool attraverso strumenti software usati per interagire per dialogare direttamente col perimetro del sistema target ok che ne so prendete ad esempio ne citeremo qualcuno tool che servono per esplorare quali sono le porte aperte messe a disposizione da un server web no tool come Nmap tanto per citarne uno ecco che quello è uno strumento di ricerca delle vulnerabilità interno interno perché richiede un'interazione diretta chiaramente le ricerche interne sono quelle dal punto di vista dell'attaccante più delicate più pericolose perché possono essere identificate no dai sistemi di prevenzione del blue team mentre invece le attività di ricerca esterna quelle non sono non sono assolutamente identificabili il riconoscimento quindi a tutti gli effetti è il precursore di un attacco perché consente all'attaccante di raccogliere tutte le informazioni utili per decidere che tipo di exploit sfruttare no per lanciare il proprio il proprio attacco ok alcuni esempi di riconoscimento esterno esempio classico che può sembrare anche stupido il dumpster il dumpster diving che consiste nel andare a cercare nei rifiuti letteralmente no sembra una banalità ma molto spesso quando vengono dismessi i dispositivi hardware non si prendono diciamo accorgimenti per rendere questi dispositivi non più accessibili a chi ne dovesse entrare in possesso ok una pratica tipica dovrebbe essere quella ad esempio di rendere di distruggere gli hard disk ok in modo tale perché perché un dispositivo che viene dismesso potrebbe comunque continuare a contenere delle informazioni sensibili ok e nel momento in cui lo buttate via diventa accessibile a chiunque segue un po' la filiera no della gestione dei rifiuti tanti tanti attacchi sono famosi sono nati attraverso attività di dumpster diving quindi non è una cosa da sottovalutare nell'era dei social network la rete è diventata un'altra fonte molto utile interessante per gli attaccanti che hanno a disposizione una quantità di informazioni a volte anche sensibili innumerevole semplicemente navigando su internet navigando sui social la gente non se ne rende conto ma condivide una quantità innumerevole di dati personali di informazioni sensibili soprattutto sui social che possono servire una volta raccolte per ad esempio decidere che tipo di manipolazione di social engineering utilizzare per attaccare una determinata persona se un attaccante sa che quali sono i vostri hobby le vostre abitudini le vostre preferenze rispetto a determinati argomenti determinati temi sono tutte informazioni che l'attaccante può utilizzare per ad esempio creare una mail di phishing credibile personalizzata che potrebbe indurvi a leggerla aprirla e fare cose che non dovreste fare come poi vedremo attraverso un po' di esempi ci sono dei tool e me ne citerò uno che servono vengono utilizzati per fare ricerche di questo tipo non è difficile presa presa una informazione relativa ad una persona a partire da alcune informazioni di base molto molto semplici ci sono strumenti che consentono di esplorare un'interra rete alla ricerca di account legati a quella persona in modo tale ad esempio da collegare informazioni trasversali e profilare una persona e una volta che voi avete profilato una persona sapete molte cose di quella persona e quindi quella persona diventa vulnerabile prof ma questi tool sono legali? eh sì quello che vi citerò io è legale perché comunque l'obiettivo di questi tool è recuperare informazioni che sono disponibili pubblicamente ok ok quindi e tipicamente vengono usati in svariati contesti pensate a che ne so gli investigatori privati i giornalisti ci sono tanti contesti in cui può essere utile ma le stesse le stesse ci pensiamo le stesse organizzazioni governative pensate a che ne so un'indagine fiscale fatta nei confronti di un contribuente ebbene può fare uso anche di strumenti di questo genere per che ne so andare a vedere qual è il tenore di vita di una di una persona se una persona pubblica sui social la sua permanenza in un hotel di lusso in una località famosa per un certo periodo di tempo è chiaro che quella persona sta dimostrando un tenore di vita che che non è un'informazione privata non è un'informazione è a disposizione di tutti no in un certo senso quindi nella maggior parte dei casi ripeto si tratta di di tool assolutamente legale poi vedremo che uso si può fare di questo tipo di informazioni fondamentalmente fondamentalmente lo scopo è quello di facilitare tecniche di manipolazione legate al social engineering è chiaro che più informazioni io so di una persona e più per me diventa facile provare a manipolare quella persona ok quindi appunto le informazioni trovate su social media sensibili a una persona sono usate per sviluppare un social meeting un social engineering particolare per quella persona si ok esatto così che funzioni effettivamente gli facciamo fare quello che vogliamo si si vi farò vedere la la la kill chain associata ad un attacco di tipo fishing che mette in pratica tutte queste cose che vi sto ascoltando ok quali sono le levi tipiche del social engineering utilizzate per montare attacchi di questo di questo genere qui ne vedete alcune ora non dovete pensare agli esempi di fishing di qualche anno fa che erano generici non erano indirizzati da una persona specifica erano confezionati in maniera abbastanza dosdinale e quindi erano facilmente identificabili da chiunque oggi specialmente quando l'attaccante identifica un target specifico è possibile creare diciamo ad esempio mail ma non solo mail di fishing estremamente difficili da identificare come tali ok e purtroppo ci sono dei tool che aiutano a fare questo in maniera anche abbastanza efficiente e le leve che di solito si usano sono quelle che vedete qui e vencate e fanno leva su quelle che sono i bias e le debolezze tipiche del comportamento umano quindi reciprocità scherzezza consistenza liking è l'attitudine è l'inclinazione a fidarsi di ciò che ci piace l'autorevolezza la validazione sociale chiaro che sono tutte leve adesso vi farò qualche esempio che diventano quanto più efficaci quando l'argomento che l'attaccante sceglie per mettere in pratica queste leve è un argomento cui la vittima è sensibile ok ma questo succede quando io ho profilato la vittima attraverso l'attività di harvesting delle informazioni di cui parlavamo prima ok tra queste adesso non voglio entrare nei dettagli di tutte perché il discorso sarebbe abbastanza lungo però prendete in considerazione che ne so la scarsità la seconda leva l'esempio tipico è vi arriva una mail che vi offre un'offerta no a tempo limitato e questa offerta riguarda un qualcosa che a voi interessa molto ok oppure vi arriva una mail da parte del team di sicurezza di un servizio web cui voi siete registrati e che vi chiede di andare a confermare le impostazioni della privacy del vostro account ok e così via no di solito l'urgenza è una delle leve più utilizzate perché chi riceve la richiesta diciamo sente la necessità di reagire urgentemente e chiaramente la fretta fa sì che non si mettono in atto quelle cautele necessarie per verificare se la comunicazione è legittima oppure oppure no ripeto immaginate di confezionare un messaggio di phishing sfruttando una qualunque o una combinazione di queste leve è chiaro che la probabilità che queste diventino efficaci aumenta se i topic gli argomenti che vengono tirati in ballo sono sensibili dal punto di vista della della ritima ok e comunque come vi ho detto vi vi mostrerò una la kill chain completa relativa ad un esempio di questo di questo genere tra l'altro guardate bene il phishing non è solo ed esclusivamente una prerogativa delle mail non si realizza solo attraverso comunicazioni via mail oramai il phishing può essere veicolato attraverso altri canali potete ricevere un messaggio di phishing via sms via whatsapp o telegram uno qualunque dei social che usate per le comunicazioni potrebbe essere il veicolo per un messaggio di phishing un post sul social network potrebbe essere il mezzo per realizzare phishing quindi non pensate che siano solo le mail gli strumenti usati per questo genere di attacchi qualunque forma di comunicazione digitale oramai potenzialmente può essere utilizzata per un attacco di tipo phishing per esempio ci sono anche alcuni siti che ci sono pubblicità che si aprono che dicono che sei a rischio che devi chiamare un certo numero di telefono diciamo in ogni caso per arrivare sul sito hai bisogno di una comunicazione che ti ci porti diciamola così chiaramente allora di solito di solito una comunicazione un messaggio di phishing poi porta con sé il vettore di attacco in modi che possono essere diversi ma di base i vettori di attacco fondamentalmente sono due ovvero o il messaggio stesso è il vettore di attacco perché include al proprio interno ad esempio un malware ok e questo è un caso l'altro caso tipico è il messaggio non è esso stesso portatore di malware ma vi induce a che ne so visitare un sito che in realtà non è legittimo ma è una copia fake di un sito legittimo e su quel sito magari voi siete portati a che ne so inserire informazioni sensibili che poi vi vengono rubate ok queste sono le due modalità tipiche tipiche attraverso cui poi un attacco di tipo phishing viene viene realizzato poi ripeto ci sono tanti modi pratici di realizzare attacchi di questo genere e che non si basano necessariamente su messaggi veicolate attraverso un canale ma ci sono tante varianti adesso non parleremo di varianti basate sul fatto che ricevete una telefonata piuttosto che un messaggio o situazioni analoghe in cui ricevete un gadget no e quel gadget è portatore di malware l'esempio classico la chiavetta usb c'è stato un caso abbastanza eclatante in cui gli ospiti di un'ambasciata straniera ad una festa ricevevano un gadget alla fine della festa e questo gadget era una chiavetta usb e questa chiavetta usb conteneva uno spyware che naturalmente poi consentiva di monitorare le attività se gli ospiti erano ambasciatori consoli responsabili di uffici governativi capite bene che potesse essere l'intento da questo punto di vista oppure adesso funziona di meno però una volta un altro approccio abbastanza tipico era quello di abbandonare volutamente in luoghi chiave vicino all'azienda che voleva essere attaccata una chiavetta usb piuttosto che un'altra cosa che sembrava smarrita ma in realtà era messa in certi posti critici ad esempio che non so una mensa piuttosto che il bar di fronte all'azienda e lì il dipendente un po' sproveduto che trovava il dispositivo poi se lo teneva e al suo interno chiaramente si attivava lo spyware nel momento stesso in cui poi la chiavetta veniva collegata ai dispositivi dell'utente di esempi di questo genere è piena la letteratura sul phishing e sulle varianti del phishing naturalmente ci sono diversi strumenti che possono essere utilizzati per cercare di prevenire questo tipo di situazioni il training dell'utente è una delle attività più importanti oltre all'uso di strumenti software come antivirus o strumenti di autenticazione multifattore che in certi casi naturalmente possono essere importanti quando si vuole proteggere le credenziali degli utenti comunque vedremo un esempio in particolare vedremo un esempio di una kill chain il cui obiettivo è quello di confezionare una mail di phishing credibile e vi farò vedere due varianti rispetto al discorso che facevo prima nella prima variante l'obiettivo è confezionare una mail di phishing che contiene il link ad un sito fake ok la seconda variante è una mail di phishing che contiene un allegato che è un pdf che al suo interno contiene un malware che si attiva nel momento in cui la vittima legge la mail e apre l'allegato queste sono le due varianti che che vi mostrerò e in entrambi i casi il confezionamento la preparazione della mail di phishing è stata un'operazione relativamente facile la vittima ero io sono stato io e l'exploit è stato preparato da da un vostro collega di annate precedenti ok per quanto invece sì ma il malware si attiva quando si apre l'email o quando si scarica l'allegato quando si apre l'allegato solo quando si apre non serve neanche scaricarlo no no quando si apre perché adesso l'esempio che vedremo noi l'allegato è un pdf ok sì e adesso al giorno d'oggi ad esempio i browser hanno la possibilità di installare quegli add-on che ti permettono di gestire determinati tipi di allegati per cui l'allegato tu lo apri già all'interno del browser a strumenti come gli add-on dell'adobe che vi permettono di gestire un pdf senza doverlo scaricare localmente e aprirlo localmente lo potete fare dal browser ecco in una situazione di quel genere lì chiaramente già aprire l'allegato all'interno del browser potrebbe essere sufficiente per attivare il malware ok invece per quanto riguarda il riconoscimento interno gli strumenti tipici sono quelli che consentono di fare da una parte sniffing del traffico ok e qui chiaramente l'obiettivo è quello di fare analisi dei pacchetti in entrate in uscita dalla rete che rappresenta il nostro il nostro target oppure i tool che fanno scanning delle porte ok ci sono innumerevoli tool di sniffing e di scanning anche perché questi tool nascono in origine come strumento di supporto ai sistemisti di rete ok non nascono come strumento di supporto alla vulnerability search e quindi va da sé che molti tool tipicamente usati per la legittima analisi della rete in realtà diventino diventino nelle mani sbagliate uno strumento per fare per fare vulnerability search ce ne sono diversi quello che vedremo noi negli esempi di penetration testing è quasi sempre Nmap ok che non so se conoscete già o se avete visto nell'ambito di qualche corso di reti che avete seguito però ripeto ce ne sono diversi adesso qui vedete elencati alcuni a seconda del contesto di riferimento e delle funzionalità ad esempio print dump è basato su linux ed è un tool per fare solo ed esclusivamente sniffing dei pacchetti no? quindi intercette i pacchetti ma non non ha funzionalità per l'analisi dei pacchetti quindi occorre usare altri strumenti poi per esaminarlo TCP dump è un pochino più evoluto perché è in grado di fare sniffing di pacchetti che soddisfano determinati pattern e quindi di farne un'analisi un pochino più puntuale tra i tanti Nmap forse è quello più potente completo è più completo grazie esiste una versione con l'interfaccia grafica permette di fare attività di sniffing ma anche scanning delle porte lavora a livello IP quindi a quel livello è in grado di filtrare filtrare tutte le informazioni del caso e quindi consente anche tra le altre cose di identificare non solo le porte aperte ma anche i servizi che sono in ascolto sulle sulle porte se sono attivi dei firewall quali sono le regole e anche attività di di monitoraggio perché Nmap è uno degli strumenti più utilizzati per la vulnerability search perché vi consente ad esempio di verificare che su un certo server web è attiva la porta che ne so 3306 sulla quale è nascorto la versione 3.0.12 di MySQL se l'attaccante sa che quella particolare versione di quel particolare servizio di quel particolare protocollo attivo su quella porta ha una vulnerabilità documentata per la quale esiste esistono degli exploit ecco che l'attaccante ha trovato il la vulnerabilità e nella maggior parte dei casi ha a disposizione già l'exploit pronto confezionato da usare per sfruttare quella vulnerabilità il sistema che vi proporò di utilizzare che si basa su una distribuzione di Linux che si chiama Kali ha a disposizione strumenti di questo genere quindi potete usare Nmap per fare scanning delle porte trovare i servizi vedere il versioning delle varie applicazioni dopodiché c'è un tool dentro la Kali che interrogato vi dice se quella particolare versione di quel particolare software ha delle vulnerabilità e vi fa l'elenco di tutti gli exploit che lui conosce per montare attacchi basati su quella vulnerabilità e vi permette anche di lanciarle ok quindi diciamo uno strumento abbastanza completo 360 gradi per identificare ma vulnerabilità ma poi anche sfruttarle per montare un determinato determinato attacco ok poi ci sono strumenti più evoluti più specifici nell'ambito della cyber security perché chiaramente Nmap è uno strumento general purpose utilizzato anche dai sistemisti di rete mentre invece questi che vi cito sono un pochino più orientati alla cyber security Warshark è uno dei più utilizzati per fare sniffing e scanning da questo punto di vista perché offre la possibilità di identificare i pacchetti che trasmettono dati sensibili come ad esempio la cifratura delle password che dovessero essere trasmesse e questo diventa importante nel momento in cui volete provare a compromettere le password che vengono trasmesse e cifrate attraverso un attacco a forza brutta un brute force attacker cui obiettivo è quello di provare a recuperare la password a partire dalla sua cifratura e quando la password è debole la probabilità di riuscire in questo intento è piuttosto elevata anche Nessus ha le stesse funzionalità di Warshark da questo punto di vista e tra l'altro offre anche la possibilità di interagire con altri tool che invece sono preposti all'implementazione dell'attacca a forza brutta ok quindi magari ho usato Nessus per recuperare dai pacchetti i ciphertext delle password e poi ne ho usato un altro per provare a a crackare la password questo è lo strumento forse più importante che è disponibile sulla Kali Linux ovvero Metasploit e Metasploit fa esattamente quello che vi dicevo prima ovvero vi consente di individuare quale exploit è più adatto per sfruttare una vulnerabilità nota che è stata identificata facendo riconoscimento tramite Nmap e per la quale Metasploit ha nel proprio repository già il codice pronto no dentro Metasploit trovate tutta una serie di exploit già confezionati vanno solo parametrizzati ma solo specificato quali sono i metadati del target del vostro attacco e lui vi prepara l'exploit e lo lancia direttamente ok la maggior parte degli esempi che vi farò vedere e quindi fanno uso nell'ambito della keychain di Nmap come strumento di ricerca della vulnerabilità e di Metasploit come strumento di confezionamento delle preparazioni dell'exploit associati alla vulnerabilità queste sono due pilastri di queste fasi della keychain che prenderemo in considerazione poi ci sono strumenti usati invece come dicevo prima per provare a craccare le cifratura delle password che vengono intercettate ad esempio attraverso uno strumento come Nessus e alcuni di questi integrano le funzionalità di sniffing dei pacchetti analisi dei pacchetti con l'obiettivo di individuare dove sta se c'è all'interno di un pacchetto la cifratura di una password e dopodiché implementano tecniche di ricerca forza brutta cosa vuol dire ricerca forza brutta vuol dire che questi strumenti sono dotati di un dizionario di password in chiaro che vengono cifrate e il risultato della cifratura viene confrontato con il ciphertext che è stato intercettato in un determinato pacchetto se i due coincidono vuol dire che ho trovato la password che ha originato quella cifratura ricerca forza brutta si chiama così proprio perché non tenta di fare criptanalisi che è quell'attività di cui parleremo quando faremo un po' di teoria e il obiettivo è quello di cercare a partire da una cifratura di risalire in base a qualche criterio al plaintext che ha generato quel ciphertext ok e vedremo quali sono un po' in teoria le tecniche da questo punto di vista invece no qui si tratta proprio dell'attacco più brutale che possiamo immaginare io provo tutte le parole del dizionario per vedere se tra queste c'è quella che è stata usata e di cui ho visto passare in un pacchetto il corrispondente ciphertext ok caino bene fa questo john the ripper idem anche THC idra bene o male sono diverse varianti di questo tipo di attacco ok l'efficienza di questi strumenti è il motivo per cui anno dopo anno le regole per scegliere una password diventano sempre più pesanti e sono regole che di solito fanno un po' spazientire l'utente che magari ogni sei mesi magari ogni anno dipende dai tipi di servizi è costretto a cambiare la propria password ok perché è chiaro che più è il tempo no di durata di una password più è il tempo che questi strumenti hanno a disposizione per cercare attraverso una ricerca forza bruta di trovarla e la probabilità che questo avvenga con successo è direttamente proporzionale alla semplicità con cui la password è stata scelta questo è il motivo per cui aumentano aumentano sempre di più la lunghezza delle password ormai siamo partiti qualche anno fa che bastavano password di 8 caratteri adesso in molti casi siamo diventati siamo passati a 12 addirittura in certi contesti particolarmente sensibili ve ne chiedono 16 ok non bastano più poi i caratteri di un certo tipo ma bisogna usare diverse combinazioni minuscole maiuscole caratteri speciali numeri ok e non pensate di risolverla usando usando delle delle regole banali di mapping da caratteri speciali a caratteri non speciali no l'esempio tipico è vabbè sono costretto a usare dei caratteri speciali che cosa faccio uso il dollaro quando vorrei usare la S uso la E commerciale quando vorrei usare la E uso il punto esclamativo quando vorrei usare la I e via ce ne sono tanti uso la chiocciola quando vorrei usare la A oppure uso il 3 quando vorrei usare la E potrei andare avanti per minuti interi a fare esempi di situazioni in cui si usano numeri o caratteri speciali al posto dei caratteri dell'alfabeto minuscole e minuscole che siano ebbene questi sono trucchi che ormai non contribuiscono solo per voi semplificano la scelta della password e la memorizzazione della password in realtà rendono la password vulnerabile ok è meno e meno robusta perché questi strumenti sono veramente veramente efficienti poi chiaramente quando faremo la teoria di questi argomenti capiremo anche qual è la complessità associata alla ricerca a forza brutta ok entriamo un pochino più nel nel dettaglio di di questo e prof si nel forza brutta com'è che si trova la cifratura della password analizzando i pacchetti allora in certi casi è in tool stesso come ad esempio Caino Abene lo fa che facendo sniffing dei pacchetti individua fa filtraggio fa filtering dei pacchetti di autenticazione perché hanno dei pattern particolari e all'interno di questi pacchetti individua i byte che contengono la cifratura di una password ok il tipo di cifratura e il tipo di cifratura chiaramente questo vale anche per tool come nessus e wire shark no quindi una volta che avete reperito la cifratura delle password ecco che poi vengono dati in pasto ad esempio a John the Ripper che comincia che implementa l'attacco forza brutta delle volte le cifrature delle password non vengono sniffate durante la trasmissione ma vengono sfiltrate direttamente dal sistema se questo è stato penetrato in precedenza da un attacco ok faccio l'esempio di prima il DBMS e SQL gestisce al proprio interno delle tabelle che contengono i dati relativi a tutti gli utenti che si possono autenticare in una di queste tabelle c'è una determinata cifratura fatta come ve lo dirò perché chiaramente dobbiamo ancora trattare di argomenti teorici ma è una cifratura fatta usando una funzione hash un certo numero di volte ok ma quale funzione di cifratura e come viene utilizzata per creare il valore che viene memorizzato nella tabella questa è un'informazione pubblica ok il tipo di cifratura che usano determinati sistemi è noto ok non è un'informazione riservata ma si riuscire a capire quante volte è usato sì ma ripeto non c'è nulla di segreto negli algoritmi di cifratura nel modo in cui vengono utilizzate ok quello che viene fatto vedere Shah Shah 56 sì sì no no ma ripeto allora il codice degli algoritmi di cifratura è pubblico quali algoritmi di cifratura vengono usati da quali protocolli anche questa è un'informazione pubblica è tutto pubblico l'unico segreto come vedremo su questo calcheremo molto insisterò parecchio l'unico segreto di tutta questa storia di tutta questa faccenda è il valore della passo quella è l'unica informazione segreta tutto il resto è noto a tutti ok attaccante compreso quindi non possiamo fare affidamento sul fatto che l'attaccante non sa che una certa cifratura che sta passando in quel momento sulla rete è stata fatta usando un algoritmo piuttosto che un altro di quelli che studieremo no perché noi dobbiamo sempre assumere che queste informazioni siano note ok non so se ho risposto alla domanda sì sì sì cioè all'autopatico l'unica cosa che è nascosta è la password in plain dell'utente che è solo lui esatto la password in chiave il cosiddetto plain text quella è l'unica informazione segreta dopodiché tutto il resto è noto compreso il ciphertext quindi compreso la cifratura della password ok basta abbastanza tempo per caccarla attopatico e allora no dipende dipende ci sono dei limiti computazionali no che dipendono appunto da dalla complessità con cui è stata scelta scelta la password teniamo conto del fatto che questi tool usano dei dizionari no che sono elenchi di password candidate da provare da tentare sì quindi è chiaro che se voi scegliete una password che rientra in questi dizionari ve la craccano ecco ovvio questo questo è naturale no sì va bene poi andando avanti ci sono strumenti e qui ne cito tre che sono invece specifici delle reti wifi mentre invece quelli che ho citato in precedenza si applicano nel caso delle reti wired e questi appunto sono tre tra i più utilizzati per fare sniffing e scanning dei pacchetti che vengono trasmesse su reti wifi e alcuni di questi come Aircrack ha anche funzionalità per l'implementazione dell'attacco a forza brutta sulle password cifrate che vengono trasmesse ci sono domande su questo sì il dizionario allora vengono continuamente aggiornati no quindi banalmente il dizionario di partenza è che ne so quello della lingua inglese ok dopodiché questo viene arricchito poco per volta come viene arricchito viene arricchito con varianti delle parole che ne fanno parte viene arricchito con password che vengono craccate ok nel dark web se ne si si trovano ripositori immensi di password che sono state craccate voi pensate ogni qualvolta un un servizio viene viene violato e quindi vengono svelate le che ne so faccio un esempio 15 anni fa Linkedin ha subito un attacco sono stati violati i dati le credenziali di 6 milioni di utenti quindi 6 milioni di password ok queste diventano chiamiamolo una sorta di tesoretto che va a popolare i repository di dizionari che usano student tool di questo di questo genere quindi man mano che le password vengono violate queste vanno queste e le loro varianti vanno a popolare i dizionari ok poi quando parleremo delle password vi farò vedere che ci sono dei siti che tengono una classifica anno per anno delle password più comuni e questi siti come fanno a sapere che ne so la password 123456 è una delle più utilizzate perché ogni qualvolta una password come 123456 viene violata poi questa informazione viene diffusa ok e quindi è attraverso strumenti di questo genere che poi si viene a sapere come vengono composti i dizionari o quali sono le classifiche delle password più deboli maggiormente maggiormente utilizzate ok comunque su questo torneremo vediamo un po' no vabbè assolutamente sì sì sì sì sì la gente continua a usare password di cui sa benissimo che non sono più sicure da questo punto di vista visti i requisiti del giorno d'oggi il consiglio che mi sento di dare è utilizzate un gestore delle password ok perché per due motivi fondamentalmente il primo è che il gestore delle password crea automaticamente password robuste quindi e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e volentieri si assomigliano e ciclicamente le riutilizza per diversi servizi. Per cui se viene attaccato su un certo servizio, di solito l'attaccante cosa fa? Nel momento in cui riesce a carcare, a penetrare un sistema e a recuperare la password in utenza, quella stessa password prova a utilizzarla per violare le credenziali di quella stessa utenza. Come fa a saperlo? Si torna al discorso dei servizi di intelligence di cui parlavamo prima. Vi faccio vedere che utilizzando un certo tool è possibile recuperare abbastanza rapidamente che io, Alessandro Aldini, ho un certo account, adesso sparo a caso, ho un certo account Twitter, un certo account Facebook, un certo account di home banking, ok? Sono sempre io, o di un altro, di Amazon, o di un altro servizio ancora online e questi account sono tutti collegati tra di loro. uno di questi viene bucato e io uso la stessa password sugli altri, ecco che automaticamente rendo vulnerabili tutti i miei account. Quindi un gestore delle password vi aiuta anche in questo, usare password diverse per servizi diverse. Rof, ma se uno usa un gestore di password, però dopo questo viene bucato, dopo non è un casino che ci sono tutte le password dentro? Sì, sì, è vero, è vero, però diciamo che è assai meno probabile che venga bucato un gestore delle password, che usa strumenti che sono continuamente pecciati rispetto alle vulnerabilità che escono continuamente. è un po', è il solito dilemma, no? Mi gestisco le cose per conto mio sperando di non essere mai la vittima di un attacco oppure le do in outsourcing ad un servizio in cloud. Il servizio in cloud è un servizio che può fare investimenti in sicurezza che io non mi posso permettere di fare. E quindi molto probabilmente lo strumento che il servizio in cloud usa per gestire il mio wallet di password è sufficientemente robusto da rendere trascurabile la probabilità che venga violata. Ok, capito. Questo è un po' il discorso. Sicuramente è più affidabile di una gestione casalinga, è fatta in casa, di un repository che io uso, locale, magari di una macchina, dove io tengo tutte le password, confidando nel fatto che quella particolare macchina non venga mai bucata. Sicuramente è una soluzione meno affidabile. Altre domande? Tutto chiaro? Sì. Bene. Visti i tempi non vi mostro oggi l'esempio di Kill Chain che mette insieme tutte le cose che ci siamo detti, specialmente relativamente al phishing. magari quello lo facciamo la prossima volta. Mentre invece adesso, visto che stiamo parlando di Kill Chain, magari vi inizio a raccontare qualcosa delle fasi successive. Ok. Ovvero il Breach Eccalation. Vedete le slide nuove, giusto? Sì. Breach Eccalation and Damage. Quindi abbiamo detto che il primo compito dell'avversario è quello di raccogliere informazioni sul target per capire se ci sono delle vulnerabilità che può sfruttare attraverso un qualche tipo di exploit. supponiamo che queste fasi vadano a buon fine, l'attaccante trova una vulnerabilità, prepara un exploit attraverso il quale riesce a penetrare il sistema. In cosa consiste l'exploit? Perché qui si apre un mondo, vedremo un po' di esempi, ma chiaramente non ci sarà modo di esplorarli tutti. In certi casi l'exploit può essere rappresentato direttamente dai dati sensibili che l'attaccante è riuscito a recuperare, ad esempio direttamente dalla vittima, imbrogliandola attraverso un tentativo di phishing. Quello è il caso più banale. L'attaccante manda una mail di phishing che indirizza a un sito fake dove l'utente è indotto a inserire il proprio account e la propria password. Quei dati lì di fatto vengono consegnati. Spontaneamente all'attaccante. Quei dati sono già l'exploit. Perché poi l'attaccante userà quei dati per accedere ad esempio all'on banking della vittima. Tanto per fare un esempio. In molti altri casi l'exploit in cosa consiste? Consiste in una tecnica che sfrutta una determinata vulnerabilità di cui soffre un certo software. Ad esempio, pensate a, che ne so, un codice PHP che un programmatore ha sviluppato per realizzare una interfaccia che attraverso un form raccoglie dei dati, no? Che servono per interrogare poi un database. Il programmatore non è un esperto di problematiche di sicurezza e quindi il codice che ha scritto non implementa nessuna tecnica di sanificazione degli input, di controllo dei dati che chi compila il form inserisce. Qual è l'exploit che un attaccante può utilizzare per sfruttare questa lacuna, questa involontaria vulnerabilità che il programmatore ha inserito nel proprio codice? la tecnica di injection. SQL è un esempio di contesto in cui gli attacchi di tipo injection hanno sempre funzionato e vi farò vedere qualche esempietto. In questo caso l'exploit consiste nel realizzare l'injection che come vedremo consiste detta in modo molto semplice nell'andare a modificare l'input in maniera tale da forzare l'esecuzione di comandi che non sono quelli previsti per l'interazione in questo caso con un database. Gli exploit possono essere chiaramente basati non su tecniche note come l'injection ma possono basarsi su vulnerabilità di tipo zero day ovvero lacune nel software piuttosto che in un protocollo piuttosto che addirittura ad esempio che sono in un sistema operativo non solo in un'applicazione quindi vulnerabilità di cui nessuna conoscenza l'attaccante ne scopre una nuova e quindi confeziona in modo attraverso qualche riga di codice per bypassare il sistema sfruttando la vulnerabilità. Gli attacchi di tipo zero day cioè basati su vulnerabilità a rilascio ignote sono tra i più difficili da identificare. C'è una domanda? Sì, diciamo a rilascio dell'applicazione o nuova versione dell'applicazione praticamente. Beh, sì diciamo che gli zero day possono riguardare anche vecchie versioni ciò che ricaratterizza il fatto che descrivono vulnerabilità che non sono mai state identificate in nessuna versione del software. Chiaramente sono le più rare e più difficili da identificare però diciamo che a volte possono addirittura riguardare problemi nel firmware e quindi arrivare quasi al livello dell'hardware. le vulnerabilità di tipo zero day. Recentemente era stata trovata intanto per fare un esempio in una serie di processori della Intel una vulnerabilità di tipo zero day che fortunatamente è stata trovata in casa e poi è stata risolta e quindi non è stata sfruttata per montare degli attacchi. Le vulnerabilità di questo tipo possono riguardare tutti i livelli dalla vulnerabilità relativa ad una libreria di gestione che ne so dell'input output fino ad arrivare a scendere a livello del firmware dell'hardware. Gli exploit possono consistere in brani di codice che rientrano nelle categorie di cui parlavamo ieri quindi qualunque tipologia di malware è a tutti gli effetti in exploit. abbiamo diciamo parlato del fatto che il phishing stesso è un vettore di attacco che può portare al proprio interno un qualche exploit come nel caso di un allegato ok che è stato diciamo alterato con un payload quindi con un contenuto il cui obiettivo è quello di appunto eseguire eseguire un codice malevolo gli exploit possono essere innestati direttamente all'interno di applicazioni che voi scaricate da uno store diciamo il caso delle app che ne so per sistemi per dispositivi mobili nel caso di Android ma nel caso anche di IOS se scaricate un'app da uno store non ufficiale è assai probabile che quell'app possa contenere al suo interno un exploit a volte addirittura è successo di app del Google Store che contenessero all'interno degli exploit quindi nonostante il fatto che tutte le app che vengono pubblicate sul Google Store come potete ben immaginare passano tutta una serie di controlli di check antivirus molto diciamo intensi da questo punto di vista oramai gli exploit possono essere veicolati attraverso i dispositivi e software più disparati una videocamera di un sistema di sorveglianza può contenere al suo interno un exploit che è stato iniettato se quel particolare tipo di sensore è accessibile da remoto ok quindi ha un'interfaccia di input out gli exploit possono essere iniettati quando appaiono sotto forma di codice possono essere iniettati all'interno di qualunque tipo di dispositivo e all'interno di qualunque tipo di software anche quelli apparentemente non legati direttamente all'esecuzione di codici vi ho fatto l'esempio dei pdf in caso del phishing noi siamo portati a pensare che un pdf non possa essere uno strumento che possa veicolare un malware perché un pdf nella nostra concezione non è un eseguibile e quindi un virus per essere attivato bisogna un eseguibile e quindi siamo portati a pensare che un pdf non possa essere uno strumento adatto per questo tipo di scopo non è così non è così perché i pdf sono oramai no dei file strutturati che contengono dei metadati che possono addirittura contenere del codice sviluppo possono avere dei link possono avere tante possono contenere dei dati che hanno un ruolo attivo ok e questo perché l'acrobat oramai ha tante diverse funzionalità un pdf può contenere una firma digitale che deve essere verificata attraverso un software può contenere tante informazioni alcune di queste possono innescare l'esecuzione di codici ok questo è un esempio poi ce ne sono chiaramente tanti tanti altri pensate ai documenti word che contengono delle macro che a loro volta possono essere associate a un esecuzione di un qualche un qualche codice chiaramente una delle più grosse vulnerabilità e quindi molti exploit sono associati al discorso delle credenziali degli utenti l'abbiamo sottolineato prima quanto spesso volentieri lo scopo di attacchi di tipo phishing e il social engineering abbiano come obiettivo quello di violare le credenziali degli utenti ok quindi se da una parte il phishing ha come obiettivo quello di farsi in qualche modo consegnare volontariamente dalla vittima le proprie credenziali e quindi in quel caso non c'è necessità di mettere in piedi un attacco in altri casi invece è necessario cercare perlomeno l'obiettivo dell'attaccante provare a violare le credenziali ad esempio come dicevamo prima attraverso attacchi a forza brutta ok ma ci sono tecniche anche più subdole da questo punto di vista vi faccio un esempio uno degli exploit più comunemente utilizzati per cercare di violare le credenziali degli utenti consiste un attacco che prende il nome di pass di hash e adesso vi mostro un esempio di come funziona prof quindi diciamo o si fa il brew forcing delle password o col phishing se le fa dare diciamo automaticamente oppure il pass di hash pass di hash è una terza variante diciamo ah ok è una terza variante legata a scenari come quello che adesso vado a raccontare intanto cos'è l'hash lo vedremo perché nell'ambito della parte teorica del corso vedremo che le funzioni hash sono particolari funzioni che hanno una caratteristica ovvero una volta che voi applicate la funzione hash a un input invertire la funzione è particolarmente difficile ok adesso permettetemi di usare un termine un aggettivo qualificativo senza motivarlo da un punto di vista scientifico questo cosa significa significa che l'hash il valore hash di un certo input può essere utilizzato come informazione diciamo utile in contesti legati all'autenticazione perché anche se voi vedete passare l'hash il valore hash di una password non siete comunque in grado di risalire la password se la funzione hash che è stata utilizzata è robusta ok e vedremo naturalmente come si costruiscono le funzioni hash in modo tale garantire questa caratteristica molti sistemi basati sia su windows che su linux effettivamente sfruttano gli hash per la memorizzazione o l'utilizzo delle password proprio perché ad esempio MySQL non memorizza al proprio interno le password memorizza solo l'hash il valore hash delle password ok e questo per garantire che la password in chiaro non sia memorizzata da nessuna parte ma solo il suo valore il valore hash ok vi faccio un esempio ma molti sistemi funzionano sulla base di questo principio c'è un protocollo di comunicazione sviluppato dalla Microsoft che si chiama Ntlm ok che serve per governare l'autenticazione dei sistemi client server cioè quando il client si deve autenticare presso presso un server ok e come funziona qui vedete le quattro fasi dell'autenticazione l'utente si identifica con il proprio no con il proprio username calcola localmente l'hash della propria password no e manda lo username al server e dice mi voglio mi voglio autenticare ok il server al suo interno in memoria da qualche parte ha non la password dell'utente ma il valore hash della sua password come ad esempio nel caso di MySQL ok quindi la mia password io sono l'utente Aldini la mia password è Pippo presso il server che gestisce le mie credenziali ci sarà un record che dice che che non dice che la password dell'utente Aldini è Pippo ma dice che l'hash della password dell'utente Aldini è una stringa di 64 bit assolutamente incomprensibile e non riconducibile al valore Pippo ok come faccio per autenticarmi usando questo tipo di protocollo beh è un protocollo che fa parte della categoria cosiddetta di challenge and response che studieremo a livello teorico si chiama così perché perché il server io mando il mio nome e il username il server e il server dice va bene mi devi dimostrare di essere Aldini quindi ti do una challenge questa challenge prende la forma di una stringa casuale che il server sceglie e che mi manda ok io cosa devo fare devo cifrare la stringa casuale che il server ha scelto e che è una stringa che viene usata una volta sola usando come chiave di cifratura non la mia password ma l'hash della mia password che io sono in grado di calcolare perché conosco la mia password ok quindi la mia password diventa la chiave per cifrare la challenge il valore casuale che il server mi ha mandato dopodiché trasmetto il risultato il server che conosce non la mia password ma l'hash della mia password fa la stessa cosa usa l'hash della password come chiave per cifrare la challenge e poi fa il confronto tra il valore che ho calcolato io e il valore che ha calcolato lui se coincidono vuol dire che mi riconosce sono io nessun altro sarebbe stato in grado di calcolare lo stesso valore ok ditemi se quello che vi ho raccontato è chiaro anche se ancora non sapete nulla di cifratura di come si calcolano gli hash però ve l'ho detto a un livello di estrazione abbastanza alto che anche se non conosce dei dettagli di come funzionano questi algoritmi che vedremo però diciamo che l'idea del protocollo dovrebbe essere abbastanza abbastanza semplice no? vi torna vi convince sì quindi la nonce sarebbe una stringa random scelta dal server il nonce è una stringa random usata una sola volta quindi scelta dal server e prasmessa a me che mi voglia autenticare ok e poi come viene controllato viene cifrata utilizzando l'hash della nostra password e quindi io che ricevo questo nonce dal server che cosa faccio cifro il nonce usando l'hash della mia password come chiave di cifratura sì ok questo io questo lo posso fare io lo posso fare perché perché conosco la mia password e quindi so calcolare l'hash della mia password e quindi posso calcolare la cifratura del nonce la stessa cosa la può fare in maniera un po' più semplice il server che non conosce la mia password ma conosce l'hash della mia password e quindi può usarlo direttamente come chiave di cifratura ok quindi sia i client che il server fanno la cifratura della nonce utilizzando come chiave l'hash della nostra password che noi abbiamo messo prima in plain text al client lui ha calcolato l'hash e poi l'ha utilizzata esatto l'unico che conosce la password in chiaro è il client sì è il client il server nel proprio store ha solo l'hash sì sì e se entrambi coincidono vuol dire che la password è corretta e quindi l'accesso se il calcolo che faccio io e che trasmetto al server coincide col calcolo che fa il server vuol dire che la password è giusta la password è giusta perfetto sì molti sistemi di autenticazione funzionano così poi questo è uno dei metodi che noi studieremo no e chiaramente il server riesce a fare questa cosa se conosce l'hash della mia password e quindi i valori hash delle passwords sono memorizzati no all'interno dei vari sistemi e la conoscenza di questi valori hash è anche alla base del meccanismo di implementazione efficiente dei sistemi di single sign on se non avete mai sentito parlare questi sono sistemi che consentono a voi di autenticarvi una volta sola presso un server o presso un servizio e nell'ambito della stessa sessione avere gratis l'autenticazione anche presso altri server e servizi perché perché fondamentalmente questi servizi dialogano tra di loro scambiandosi scambiandosi gli hash necessari per realizzare i controlli e quindi voi gratis senza dovervi tutte le volte autenticare avete l'accesso a diverse tipologie di servizi per su cui siete registrati ok perché vi ho raccontato questa di questa di questa infrastruttura perché questa infrastruttura per funzionare ha bisogno di far circolare di memorizzare magari in maniera temporanea nella cache di sistema per tutto il ciclo di vita di una sessione i valori non delle password ma dei suoi hash ok da qui il nome della tecnica pass the hash perché in realtà per autenticare un utente a questo punto non serve più sapere la password conoscere la password basta conoscere l'hash se conoscete l'hash ecco che siete in grado di di di di di di di di di di di di di di di di di di di di di di di di di di di di di di di di di Questo naturalmente può rappresentare una vulnerabilità nel momento in cui un attaccante che per qualche motivo attraverso altri attacchi riesce ad accedere alla memoria di uno di questi sistemi, nel momento in cui nella sua cache ha memorizzato l'hash di una password, ebbene se l'attaccante riesce a sniffare l'hash di una password ha tutto quello che gli serve per autenticarsi al posto dell'utente legittimo senza conoscere la password, perché ha già l'hash e tutto quello che gli serve è questo. Ok? Ok? Filtrare delle informazioni che può utilizzare per impersonare uno delle parti coinvolte in un protocollo legittimo. Ok? Quindi il campo d'azione degli attacchi di tipo man in the middle è piuttosto ampio. In questo caso specifico qui non è necessario per l'attaccante usare un attacco di tipo man in the middle per entrare in possesso del lash. Perché come ha detto adesso per l'attaccante è sufficiente entrare in possesso del lash, ad esempio perché ha violato la cache del server e lì ha letto l'hash. Non ha, anzi spesso e lì ha letto l'hash, non ha la possibilità di intercettare l'hash in nessuna comunicazione, perché come vedi nel protocollo NTLM l'hash non viaggia. No? Viaggia la nostra scura del nonce fatta usando il lash come chiave. Ok? Un attacco di tipo man in the middle in questo contesto l'attaccante dovrebbe realizzarlo intercettando ad esempio il messaggio del client e riutilizzandolo poi per autenticarsi con il server ad esempio. Ok? Però professendo che è una nonce viene usata solo una volta quindi non puoi. Esatto, esatto. Il motivo per cui i nonce si usano una volta sola è proprio evitare il loro riutilizzo. Ok? Un altro esempio di attacco man in the middle in questo caso potrebbe essere finalizzato dal punto di vista dell'attaccante a impersonare il server e indurre il client a trasmettergli delle informazioni sensibili. Però di nuovo in questo caso non ci sono informazioni sensibili che viaggiano. Ok? Quindi in questo tipo di protocollo un attacco di man in the middle è piuttosto difficile da realizzare in maniera efficiente. Vedremo tanti tipi di esempi di attacchi di tipo man in the middle più avanti e vedremo come questi si realizzano. Ma qui la vulnerabilità non sta tanto nel protocollo ma nel fatto che sui vari sistemi durante l'esecuzione di certe sessioni gli hash delle password si trovano nella cache del sistema. E se l'attaccante per qualche motivo ha accesso a queste cache sniffa gli hash delle password e lì il gioco è fatto perché a quel punto l'attaccante può impersonare il client. In qualunque sessione successiva. Può fare la stessa cosa che fa il server per controllare l'annonso? Cifrarla attraverso la versione hashed? Sì, sì, sì. Può pretendere di impersonare il client presso il server legittimo dato che è in grado di rispondere alle challenge del server. Sì. Quindi vedete ci sono tanti modi a seconda del contesto per cercare di violare le credenziali. I due strumenti di cui abbiamo parlato prima molto frequenti sono il phishing alla parte, cioè un modo per farsene dare direttamente dalla vittima. Oppure il brute force attack dall'altra, cioè un tentativo di critanalisi pura fatta sui ciphertext. Questo è un esempio di situazioni in cui non si applica né una tecnica né l'altra, ma è un exploit che deriva dal modo in cui funzionano certi sistemi. Ok? E quindi l'attaccante a seconda del sistema cerca di sfruttare le sue vulnerabilità e le conseguenze possono essere entrare in possesso di informazioni sensibili, quali ad esempio gli hashed e le password che servono per autenticarsi. Ecco. Questo era un esempio che vi ho fatto semplicemente per dimostrarvi che ci possono essere tanti modi diversi di arrivare a violare una password. Io direi che ci possiamo formare qui, così la prossima volta ne vediamo altri e poi vi faccio vedere quel caso di studio di kill chain basato sul phishing. Ok? Ci sono domande? Tutto chiaro? Sì. Ok, benissimo. Bene. Noi ci vediamo... Faccio un po' che interrompo la registrazione.