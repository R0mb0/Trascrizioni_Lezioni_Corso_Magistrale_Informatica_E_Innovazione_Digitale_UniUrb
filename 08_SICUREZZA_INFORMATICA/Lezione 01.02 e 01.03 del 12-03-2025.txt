Grazie. Grazie. Grazie. Grazie. Ho mostrato qualche esempio dettagliato riguardanti gli Zero Days, spesso e volentieri per fare breccia del sistema si utilizzano strumenti mirati a bypassare i controlli di sicurezza, le cosiddette backdoor, che rappresentano di solito porzioni di codice, a volte sia lato software ma molto più spesso lato firmware, nascoste nel sistema operativo, che consentono fondamentalmente di accedere a determinati permessi bypassando i controlli di sicurezza. Noi non parleremo delle backdoor, di solito le backdoor o sono già presenti o vengono iniettate attraverso uno degli strumenti che abbiamo visto la settimana scorsa, quindi non rappresentano un elemento di novità, di interesse da approfondire. Così come non parleremo di vulnerabilità di dispositivi mobili, attraverso di solito applicazioni app malevoli, il motivo è che fondamentalmente i tipi di malware che si utilizzano in questo contesto sono una variante di quelli che funzionano invece lato desktop. E quindi non ci sono elementi di originalità in queste tipologie di attacco. Idem per quanto riguarda l'utilizzo dei dispositivi mobili per attacchi tipo denial of service basati sui botnet. La cosa interessante invece, una volta che si è individuato l'exploit da sfruttare per fare breccia nel sistema, consiste nel navigare all'interno del sistema fino ad arrivare all'asset che rappresenta l'obiettivo principale dell'attacco. Perché spesso non intende quello che succede è che l'attaccante riesce a sfruttare una vulnerabilità del sistema per penetrare il sistema, ma lo penetra in un punto dove non si trova l'asset che rappresenta il suo obiettivo principale. Per svariati motivi, o perché fisicamente non è l'host che ospita l'asset, o perché invece da un punto di vista logico l'avversario non ha ancora i privilegi necessari per accedere all'asset. Che magari è riuscito a bucare il sistema usando delle credenziali rubate associate all'utente che non ha i permessi di accesso per accedere direttamente all'asset che interessa la vittima. Quindi questo significa che una volta sfruttato l'exploit per penetrare il sistema, l'attaccante ha bisogno di muoversi all'interno del sistema fino ad arrivare all'obiettivo prefissato. Questo movimento può richiedere di dover elevare i privilegi che l'avversario ha in quel momento e che invece gli servono per accedere a risorse che gli interessano. Quindi diciamo che esistono diverse tipologie di attività cosiddette di escalation che servono appunto all'attaccante per muoversi all'interno del sistema che ha appena penetrato. Il cosiddetto movimento laterale, lateral movement, che consente all'avversario appunto di spostarsi all'interno del sistema richiede la conoscenza di informazioni che di base l'avversario non ha. L'avversario si trova su un host che rappresenta la falla nel periodo dell'interno del sistema e da quell'host magari si deve spostare all'interno della rete locale dell'azienda. E per farlo ha bisogno di informazioni, quantomeno per capire quali sono gli host collegati all'interno della rete, quali sono i server che ospitano gli asset che gli interessano e via dicendo. Dove reperire questo tipo di informazioni? Come può fare l'attaccante per spostarsi lateralmente all'interno della rete che ha appena bucato? Beh, la cosa interessante è che nella maggior parte dei casi non ha bisogno di iniettare nel codice a questo scopo, ma può usare, posto che riesca a fare escalation dei permessi, software che è già presente all'interno del sistema. E tipicamente si tratta del software che i sistemisti della rete utilizzano per configurare la rete e per configurare i vari host di rete. Questo è il motivo per cui di solito gli avversari hanno una conoscenza abbastanza approfondita di come funzionano questi software, che sono software legittimi. Perché, ripeto, sono i software che normalmente vengono usati a lato, appunto, a lato Blue Team, a lato sistemista di rete, per configurare e installare tutte le macchine di rete, ma che al tempo stesso rappresentano una fonte di informazione per l'avversario che ha appena penetrato il sistema. Questo significa, tra le altre cose, che la protezione di questi software deve essere uno degli obiettivi fondamentali dei sistemisti di rete, perché sono software dedicati, dedicati proprio perché hanno, elaborano e gestiscono tutte le informazioni necessarie per la gestione della rete, che quindi sono le informazioni che servono all'avversario per muoversi all'interno della rete. Qui vedete un elenco di questi software, a seconda del sistema operativo di riferimento, e che sono quelli che tipicamente l'avversario cerca di utilizzare a proprio vantaggio, nel momento in cui ha avuto accesso al sistema. Uno che già conosciamo, perché l'abbiamo citato la volta scorsa, appunto, è Nmap. Perché? Perché è il software di base che può essere utilizzato appunto per esplorare la rete, capire quali sono gli host e i server ospitate all'interno della rete, dove l'avversario si sta muovendo. L'uso di questi software da parte dell'avversario all'interno della rete è piuttosto difficile da identificare, perché stiamo parlando di un avversario che non è fuori dalla rete e sta cercando di penetrarlo, stiamo parlando di un avversario che ha già penetrato il sistema. Quindi ha già superato tutta una serie di controlli attivi, e di solito quello che accade è che all'interno del sistema questi controlli sono molto più blandi. Questo giustificherà il fatto, quando parleremo delle tecniche di difesa del Blue Team, della necessità di usare ulteriori strumenti utili proprio per verificare cosa succede all'interno del sistema, non per monitorare i tentativi di ingresso del sistema, proprio perché una volta che l'avversario ha buttato il sistema lì dentro, occorre mettere in atto strumenti per cercare di mitigarlo, identificare i suoi spostamenti all'interno del sistema stesso. E proteggere questi software qua è uno dei modi, attraverso una oculata gestione dei permessi, delle credenziali e della protezione delle informazioni che questi sistemi gestiscono. Mi trovate un elenco di quelle che sono le funzionalità di massima di alcuni di questi, e del motivo per cui sono uno strumento privilegiato per l'avversario. Ad esempio PowerShell è un tool Microsoft che viene utilizzato dai sistemisti per la distribuzione dei task sugli host da remoto e per la configurazione della rete. Ha un'uso di una scelta di comando, con il suo linguaggio di scripting dedicato, ed è uno strumento particolarmente adatto per navigare la rete, per installare software da remoto sui vari host, e quindi tutta attività che chiaramente l'avversario che entra, diciamo, che è in grado di usare questo strumento all'interno della rete, tutta attività che può fare con finalità malevole. Lo stesso discorso, al netto delle diverse funzionalità, vale per tool come SIS Internals, che tra le altre cose utilizza un tool che PSXX ha fatto apposta per eseguire comandi da remoto, quindi a partire da un host lanciare dei comandi eseguiti su altri host, che è un'operazione particolarmente utile quando bisogna, ad esempio, installare uno stesso software su tutte le macchine di una LAN, o cose di questo genere. Quindi tutti quegli strumenti software che servono per il controllo remoto delle macchine, naturalmente, sono strumenti utili per l'avversario. Ok? E così dicendo, altri sono remote desktop, WMI e active directory sotto Microsoft, dovete porsi l'estrumento fondamentale, perché contiene tutte le informazioni utili per navigare il sistema, capire quali sono gli host, capire quali sono le utenze, chi ha permesso di fare cosa. È un avversario che entra in controllo di questi tool, fondamentalmente entra in controllo dell'intera rete. Questa è l'idea di fondo. Come dicevamo prima, l'avversario può avere la necessità di aumentare i propri privilegi per accedere, ad esempio, a questi tool. E non è detto che abbia questi privilegi nel momento in cui riesce a penetrare il sistema. Ad esempio, lo fa prima, hackerando delle credenziali che hanno dei permessi di accesso piuttosto limitati e non sono sicuramente quelli necessari per eseguire i tool che abbiamo visto prima. Quindi, uno dei compiti tipici, una delle attività tipiche che fa l'avversario che ha penetrato il sistema consiste nel cercare di aumentare i propri privilegi di accesso per poter utilizzare i tool che dicevamo prima. Questa è una delle strategie tipiche. L'escalation dei privilegi può essere orizzontale o verticale. Orizzontale significa passare da un account all'altro, fondamentalmente. Quindi, l'avversario è entrato nel sistema hackerando un account, cerca di spostarsi da quell'account che ha dei privilegi bassi ad un altro che ha privilegi più alti. Come fa a fare questo? Beh, ad esempio, andando a cercare i file delle password delle altre utenze cercando di hackerare la password di un altro utente che magari ha privilegi da admin. Questo è uno dei tentativi tipici, no? Chiaramente che funzionano dove le password sono deboli. L'altro tentativo, invece, consiste invece nel fare una quella che viene chiamata l'escalation verticale, invece corizzontale. L'escalation verticale ha come scopo quello di aumentare i privilegi dell'account di cui l'avversario ha controllo. Quindi, senza spostarsi su altri account, ma cercando di aumentare quelli dell'account che in quel momento sta controllando. Come fare? Beh, ad esempio, le tecniche che abbiamo visto la settimana scorsa sono un modo, no? Quindi, causare un buffer overflow associato all'esecuzione di un comando iniettato che viene eseguito non direttamente dall'utente controllato dall'avversario, ma dal sistema stesso, no? L'avevi visto l'altra volta, se si fa injection di comandi, si ha la possibilità di far eseguire certi comandi al sistema, e il sistema nel momento in cui li esegue ha permesso di admin, e quindi in questo modo si fa di fatto escalation verticale. Cioè, il comando non lo eseguo io, ma chiedo al sistema di eseguirelo al posto mio. E come faccio a chiedere al sistema di eseguirelo al posto mio? Il buffer overflow è una delle tecniche che tipicamente si utilizzano. Ce ne sono altre, il buffer overflow è un esempio, altre sfruttano le vulnerabilità delle cosiddette accessibility features dei sistemi operativi, che sono quelle features che consentono l'utilizzo di funzionalità del sistema operativo da parte di utenti che hanno delle disabilità. Tipicamente queste features dei sistemi operativi utilizzano funzioni e comandi che bypassano i controlli di sicurezza e quindi eseguono comandi con privilegi ad alto livello, quindi entrando in controllo di queste features si riescono ad eseguire comandi ad alto livello di privilegio un altro exploit consiste nello sfruttare i token di altri processi, di processi che hanno privilegi elevati, i token sono quei pezzi di informazione che codificano in qualche misura l'identità dei processi, quindi di fatto un processo viene identificato con il suo token, se io che ho un processo a basso livello di privilegio entro in processo del token, di un processo ad alti livelli di privilegio ecco che riesco a fare escalation verticale dei miei diritti d'accesso. Le idee si basano sempre sul meccanismo che vi ho raccontato relativo al buffer dell'altra volta perché anche l'exploit dell'injection delle librerie di sistema è un altro modo, cioè se io riesco a iniettare codice all'interno di una libreria, poi quando quella libreria viene invocata dal sistema, di fatto attiva il codice male quello che sta al suo interno, quindi uno dei tentativi tipici consiste addirittura iniettare o sostituire librerie di sistema, chiaramente questa cosa funziona laddove queste librerie non sono sufficientemente protette, quindi il principio di fondo è sempre lo stesso, riuscire a forzare il sistema a eseguire codice di mia scelta, laddove io direttamente non lo posso eseguire perché non ho gli stessi privilegi del sistema, però ci sono delle scappatoie per forzare il sistema a eseguire questi comandi e questi sono una serie di esempi tipici che vengono vengono vengono sfruttati. Una volta che l'avversario ha acquisito i privilegi di accesso che gli interessano ecco che l'attacco viene finalizzato, ok? Quindi l'avversario ha avuto accesso all'asset dopo aver fatto scalazione di privilegi e da qui comincia diciamo a realizzarsi il danno. Ok? Che può consistere in un furto di un'informazione quindi a discapito della confidenzialità può consistere nella compromissione delle informazioni e quindi di quella che è l'integrità delle informazioni perché l'obiettivo dell'avversario potrebbe essere modificare o cancellare dati. Può essere semplicemente anche quello di installare una backdoor magari l'avversario lo scopo dell'attacco non è quello di andare a compromettere le personalità del sistema ma di avere un accesso privilegiato al sistema per poter monitorare tutto quello che succede lì sopra in maniera nascosta. Ok? Quindi in questo caso di solito cosa succede? L'avversario che ha penetrato il sistema acquisito i privilegi che gli interessavano che cosa fa? Installa una backdoor cioè installa un pezzo di software che da quel momento in avanti consente all'avversario di entrare da remoto all'interno del sistema bypassando da quel momento in avanti tutti i controlli di sicurezza e così via una volta che l'avversario ha controllo del sistema poi può realizzare tutti gli attacchi di cui abbiamo anche parlato in passato spesso per concludere l'attacco l'avversario cosa fa? Applica delle cosiddette tecniche di offuscamento per cancellare le tracce che ha lasciato quindi eliminare i file di log che rappresentano gli archivi di tutte le attività che si svolgono all'interno del sistema e questa di solito è l'operazione tipica che viene eseguita vi farò vedere alcuni esempietti in questo senso le attività che l'avversario esegue su un sistema una volta che ha completato il suo attacco vi faccio un ulteriore esempio vi racconto un ulteriore esempio che mette insieme un po' delle cose che ci siamo detti che è la storia di come si è realizzato il primo attacco basato su ransomware documentato su larga scala che risale al 2016 WannaCry è stato il primo ransomware largamente diffuso che ha avuto un buon successo e che combina una serie di strategie che risalgono addirittura a quelle messe in atto dal Morrisworm che è il primo caso di malware che vi ho raccontato che risale appunto agli anni 80 proprio perché WannaCry agisce come in prima istanza come un worm ok quindi il principio di base è quello del Morrisworm di cui abbiamo già parlato cioè un software che sfruttando certe vulnerabilità riesce a replicarsi da una macchina all'altra ok nel caso di WannaCry la vulnerabilità è sfruttata e rappresenta all'interno del protocollo samba della Microsoft ok quindi sfruttando questa vulnerabilità del protocollo che agisce in ascolto sulla porta 445 il worm riusciva a replicarsi da una macchina all'altra quindi in pratica il ransomware che si installava su una macchina svifava il traffico per individuare altri host presenti nella stessa rete e cercava quelli che avessero la porta 445 aperta in ascolto quindi host che fossero disposti a eseguire il protocollo samba per la comunicazione tra macchine Windows individuate queste sfruttava la vulnerabilità per trasferire il worm e replicarlo su queste macchine e così via diffondendolo samba è un protocollo piuttosto diffuso e quindi la diffusione è stata abbastanza rapida e su larga scala nel momento in cui il worm veniva trasferito installato sulla macchina questo attivava il malware vero e proprio ok il malware vero e proprio era un'applicazione che fondamentalmente faceva una cosa ovvero cercava cercava all'interno del file system della macchina locale tutti i file con una certa estensione quindi esplorava il file system e riconosceva fino a 175 diversi tipi di file e tutti i file individuati in questa maniera venivano cifrati ok ogni file veniva cifrato con una chiave diversa il principio della sicurezza semantica di cui parlavamo e di cui abbiamo parlato anche stamattina usando AES in CBCMOD che è una delle due modalità che abbiamo studiato stamattina ok quindi usando un cifrario probabilistico no AES 128 in CBCMOD quindi ripeto ogni ogni file individuato con una delle estensioni riconosciute veniva veniva cifrato con una chiave diversa dal malware dopodiché e qui invece subentra una parte che dobbiamo ancora studiare tutte le chiavi usate per cifrare supponiamo che nel file system al malware trovi mille mille file quindi mille chiavi usate per cifrare questi questi file e queste queste chiavi devono essere memorizzate da qualche parte in maniera non accessibile naturalmente alla vittima perché poi l'idea era quella proprio di ricattare la vittima per recuperare i file dietro di scappo quindi tutte queste chiavi venivano collezionate in un unico luogo diciamo in un unico file che a sua volta veniva cifrato usando un sistema di cifratura che ancora dobbiamo studiare un sistema di cifratura chiave asimmetrica cioè un sistema di cifratura dove la chiave di cifratura è diversa dalla chiave di cifratura quindi tutti questi file venivano cifrati usando quella che viene chiamata chiave pubblica che era una delle due chiave appunto quella per cifrare e per recuperare la cifratura di questi era necessaria la chiave di cifratura corrispondente la cosiddetta chiave segreta che chiaramente anche questa a sua volta veniva cifrata quindi c'era una catena di cifrature ok quindi una una situazione in cui una sorta di meccanismo di scatole cinesi adesso non voglio entrare nel metà del sistema di cifratura chiave pubblica che dobbiamo ancora studiare però l'idea è appunto che voi avete tutte le chiavi no ciascuna delle quali usate per cifrare un diverso file queste venivano impacchettate ok e cifrate usando quella che viene chiamata chiave pubblica di un sistema che andremo a studiare per recuperare il plaintext cioè per recuperare l'insieme delle chiavi è necessaria una chiave segreta corrispondente alla chiave pubblica usata per cifrare le nostre chiavi quindi altre parole per recuperare i miei file cifrati mi servono queste chiavi per recuperare queste chiavi mi serve questa perché queste sono cifrate con questa chiave qua ok questa a sua volta è incapsulata un cifrate cifrato con un'altra chiave pubblica ancora diversa da quella precedente ok e per recuperare questa occorreva una chiave segreta corrispondente che non è memorizzata all'interno del sistema ma è conosciuta solo all'avversario ok quindi la catena di cifratura è abbastanza complessa e allora a questo punto l'avversario mandava un messaggio alla vittima dicendo guarda il tuo file system è cifrato per recuperare i tuoi file ti serve questa chiave questa chiave qua giù perché perché con questa riesci a decifrare questo ciphertext che ti dà accesso a questa chiave questa chiave ti serve per decifrare questo ciphertext e quindi recuperare tutte queste chiavi che sono quelle usate per cifrare i file di file system questa è la catena di dipendenze noi sappiamo come funziona la cifratura dei file usando queste perché abbiamo appena detto che il sistema che si usa è S&C B C Mod non conosciamo ancora il modo in cui invece questo ciphertext è stato creato così come non conosciamo il modo in cui questo ciphertext è stato creato ma lo studieremo nelle prossime nelle prossime lezioni quando vedremo come funziona la cifratura a chiave asimmetrica ok va detto però che tutti i sistemi utilizzati in questa catena di cifrature sono sistemi sicuri molto sicuri quindi non c'è nessuna speranza per la vittima senza conoscere questa di recuperare i fine in plaintext e quindi l'unico modo per la vittima consisteva nel pagare il riscatto e avere accesso quindi a questa a questa chiave qua ok e questo è il modo in cui funziona questo tipo di di ransomware e un po' tutti quanti ransomware la differenza tra diverse categorie di ransomware consiste tipicamente nella diversa vulnerabilità che utilizzano per attaccare il sistema ok in questo caso si utilizzava la vulnerabilità di questo protocollo poi una volta penetrato il sistema grossomodo questa catena di cifrature anche se in maniera più o meno variegata rappresenta di fatto l'implementazione dell'attacco la prossima volta vi racconterò l'altra faccia di WannaCry e questo diciamo è il comportamento tecnico del del ransomware la prossima volta vi dirò qualcosa che riguarda cosa si è fatto e cosa si poteva fare dal punto di vista dell'intelligence quindi dal punto di vista delle attività che il blue team poteva avrebbe potuto fare per non solo mitigare o addirittura annullare gli effetti di questo attacco ma anche per evitare varianti future di questo tipo di attacco perché spesso e valentieri come vedremo il blue team avrebbe a disposizione delle soluzioni o per annullare o per mitigare l'attacco ma per un motivo o per l'altro queste non vengono realizzate e il caso di WannaCry da questo punto di vista è abbastanza eclatante perché sono stati fatti tutta una serie di errori abbastanza importanti che poi hanno determinato il successo di questo tipo di ransomware e ulteriori successivi ok come ho anticipato la volta la volta scorsa esistono dei framework esistono dei repository che rappresentano un po' lo stato dell'arte dal punto di vista delle diverse strategie che l'avversario può mettere in atto nello svolgimento delle varie fasi della kill chain quindi dal riconoscimento fino al brecce e quindi al vettore di attacco vero e proprio e che sono disponibili online e cui linea di principio il blue team dovrebbe fare sempre riferimento in letteratura forse il repository in assoluto più completo da questo punto di vista è quello della mitre che si chiama attack e che è in questo sito vediamo se riesco solo che da qui non funziona il link diretto andiamo a cercare vediamo un attimo se riesco a condividere forse è disabilizzato ah ok ora vediamo se riusciamo a farlo partire senza troppi eccolo qua è in condivisione è in condivisione anche da remoto vero? ho questo dubbio è poi dire di sì no non è in condivisione allora devo cambiare la condivisione ecco ai fatti eccolo qua ok adesso dovrebbe essere condiviso ok perfetto questo è il sito la landing page del repository qui trovate una tassonomia completa di tutte le tattiche e le tecniche che l'avversario note che si possono adottare rispetto a tre diversi domini che sono il mondo del mobile il mondo del desktop il mondo OT quindi vedete ci sono diverse matrici a seconda del contesto ad esempio che ne so prendiamo il contesto enterprise ok e qui trovate la tabellina è una tabellina che ripeto contiene suddivisione in righe colonne tattiche e tecniche no nelle colonne riconoscete che cosa riconoscete le fasi della kill chain ok quindi le diverse tattiche cosa fa cosa posso fare in fase di riconoscimento cosa posso fare in fase di escalation e io dicendo nelle righe invece trovate le diverse tecniche che tattica per tattica possono essere utilizzate e man mano che se ne scoprono delle nuove qui vengono pubblicate ok quindi che ne so interessa sapere come fare privilege escalation sfruttando i token di accesso che è una delle cose che abbiamo citato poco fa andate a vedere qua e trovate una descrizione di tutte le tecniche note per fare appunto manipolazione dei token dei processi in modo tale da fare ereditare a un processo a basso livello di privilegi i diritti in un altro processo che invece ha altri privilegi di accesso semplicemente andando a manipolare il token del processo sotto il controllo dell'avversario e trovate tutti i riferimenti anche le descrizioni di attacchi vi interessa la tattica di riconoscimento in particolare il caso del phishing qui trovate anche in questo caso no una descrizione di tutte e quante le tecniche di phishing che si utilizzano in letteratura ok e questa cosa come dicevo prima la trovate rispetto a tre diversi contesti enterprise ricomprende il mondo delle aziende quindi un ambiente desktop indipendentemente da quello che è il sistema operativo di riferimento che siano windows server o altro non ha importanza quindi a tutto tondo tutto quello che riguarda la sicurezza delle delle reti wired e dei sistemi desktop mobile invece riguarda appunto tutto il mondo dei dispositivi mobili e IoT quindi la stessa tabellina però con tutte le tattiche che si utilizzano in questo in questo contesto ICS invece il contesto industriale quindi l'operational technology OT e quindi dove ci sono situazioni più stringenti per quanto riguarda i requisiti real time ne avremmo ne avevamo anche parlato qualche lezione fa delle problematiche di sicurezza in contesti industriali dove le stesse macchine industriali dei processi produttivi vengono controllate spesso momenti da remoto attraverso dei software di controllo che possono essere oggetto di attacchi quindi anche in questo contesto ci sono delle dinamiche particolari per quanto riguarda i possibili attacchi quindi diciamo che questo sito di solito è lo strumento baso di riferimento per il blue team che vuole documentarsi su quelle che sono le potenziali vulnerabilità di cui il proprio sistema potrebbe soffrire e quindi chiaramente mettere in atto delle soluzioni adeguate può anche essere un riferimento per voi nell'andare a cercare a individuare tipologie di attacchi che magari volete sperimentare in un esercizio di penetration testing concentrandosi su una delle diverse tattiche e andando a vedere quali sono quelle che vi interessano o vi interessa replicare ok su questo torneremo quando vedremo qualche esempio di penetration testing però questo è il repository di riferimento da questo punto di vista ok chiaro come navigarlo le due dimensioni delle tattiche sulle colonne delle tecniche sulle righe poi chiaramente si possono andare a cercare attraverso diversi diversi punti di accesso ad esempio in questa pagina vedete proprio l'elenco di tutte le tecniche a seconda del con la loro descrizione e il link a seconda della tipologia di scenario di riferimento ma trovate anche informazioni sugli strumenti di difesa quindi come mitigare i vari attacchi sempre in diversi contesti quindi un punto di riferimento anche per chi deve mettere in atto gli strumenti di difesa di cui parleremo già in questa e nella prossima lezione ok quindi chiunque si preoccupa di sicurezza all'interno del perimetro aziendale deve conoscere bene questo repository questo è certo bene torniamo alle slide quindi eravamo qua ecco qua quindi appunto come dicevo a seconda dello scenario che vi interessa trovati vari riferimenti non li ho citati tutti ma nel sito si trovano informazioni su tutti i sistemi di riferimento Windows Mac OS Linux ambienti cloud in ambito mobile sia Android che iOS in ambito industriale ci sono solo i proprietari di solito a disposizione detto questo direi che qui si conclude la parte descrittiva relativa al lato malevolo della kill chain quindi come avevo promesso all'inizio studiamo la kill chain sotto due punti di vista l'abbiamo fatto dal punto di vista dell'attaccamento quindi abbiamo esplorato quali sono tutte le fasi della kill chain cosa fa dal punto di vista delle strategie delle tecniche cosa fa l'avversario per realizzare un attacco che poi vedremo attraverso esempi di penetration testing ma anche l'altra parte quindi il punto di vista del blue team cosa fa il blue team per cercare di spezzare la kill chain in uno qualunque dei suoi punti lo team può cercare di intervenire già nella fase di riconoscimento per prevenire un attacco oppure può utilizzare degli strumenti per cercare di neutralizzare un attacco che ha già già stato in grado di penetrare il sistema ma di cui si vuole evitare la propagazione di cui si vuole evitare l'escalation quindi ci sono diversi strumenti che il blue team ha a sua disposizione per intercettare un attacco lungo le varie fasi della kill chain quindi diciamo ogni punto del ciclo di vita della kill chain ha a sua disposizione strumenti che il blue team può utilizzare per intercettare in quel punto l'attacco e neutralizzarlo e oggi cominciamo a vedere quali sono questi questi strumenti vediamo un po' bene direi dovrebbe essere in condivisione le slide quindi cominciamo a vedere che cosa succede dal punto di vista grazie dal punto di vista del di chi deve difendere il il perimetro cercando di ottimizzare quella che è la security posture della dell'azienda o chi che sia come si fa a spezzare la kill chain intervenendo in uno qualunque dei vari punti che la caratterizzano cioè ci sono diverse diciamo strategie che il blue team può mettere in atto e che noi cercheremo di classificare ok allora in primo luogo diventa è fondamentale per il per il blue team prepararsi diciamo in via in via preventiva in che maniera stabilendo innanzitutto quali sono gli asset da proteggere ok perché è chiaro che il blue team deve avere chi ha deve deve deve avere una una fotografia la più fedele possibile di quelli che sono tutti gli asset che deve proteggere deve fare una valutazione accurata di tutti i rischi e vedremo come perché perché di solito quello che succede è che ci possono essere tante diverse vulnerabilità che contribuiscono ad aumentare in qualche misura il rischio di essere oggetto di attacco come avevo già sottolineato più di una volta è quasi impossibile garantire la massima protezione di tutti gli asset e quindi bisogna bisogna fare una quella che appunto si chiama risk assessment cioè la valutazione dei rischi con obiettivo quello di stabilire quali sono le priorità cosa vale la pena proteggere quanto dobbiamo investire sulla protezione dei vari asset e poi naturalmente stabilire quali sono gli strumenti da mettere in atto per mitigare gli attacchi di cui inevitabilmente il sistema sarà prima o poi vittima vedremo che esiste un processo un ciclo di vita per quanto riguarda la gestione e delle minacce potenziali e degli attacchi veri e propri perché è vero che il sistema cerca di fare prevenzione ma deve fare anche monitoring quindi deve verificare se sta succedendo qualcosa che potenzialmente è un attacco magari ancora non lo sappiamo però potenzialmente è un attacco quindi bisogna gestire tutte le possibili minacce fino ad arrivare al momento in cui una di queste si rivela essere un attacco vero e proprio allora in quel caso bisogna gestire l'attacco con lo scopo di neutralizzarlo o mitigarlo e quindi ripristinare il sistema quindi c'è tutta una serie di azioni che il Blue Team deve mettere in atto che sono descritte in un ciclo di vita della gestione delle minacce e questo l'efficacia naturalmente di questo processo gestionale dipende naturalmente da quelli che sono gli strumenti che il Blue Team mette in atto e che si dividono in diverse categorie abbiamo le policy di sicurezza che il Blue Team deve stabilire cioè regole che determinano ad esempio chi può avere accesso a che cosa quando e perché quindi tutta una serie di regole per regolamentare appunto l'accesso agli asset ok poi deve mettere in atto delle strategie per la difesa per prevenire o identificare quelle minacce che potrebbero diventare attacchi veri e propri e in ultima istanza laddove un incidente di sicurezza si dovesse verificare perché siamo vittima di un attacco che non siamo stati in grado di intercettare allora bisogna mettere in atto un processo di risposta all'incidente l'obiettivo appunto di mitigarlo e di neutralizzarlo e di ripristino del sistema ok quindi le policy le regole servono per stabilire quello che è un contesto ideale all'interno del quale si fa un uso corretto delle risorse si stabilisce chi può usare le risorse e quindi tutta una serie di vincoli di constraint che dovrebbero in qualche modo proteggere gli asset poi però ci vogliono dei meccanismi per proteggere fisicamente gli asset e infine ci vogliono altri meccanismi per diciamo neutralizzare quegli attacchi che inevitabilmente dovessero verificarsi ok quindi diciamo che la combinazione di tutti questi elementi quindi determinare cosa dobbiamo proteggere e con quali risorse stabilire qual è un corretto ciclo di vita della gestione delle problematiche di sicurezza stabilire regole meccanismi di difesa e processi di risposta e ripristino tutto questo messo assieme definisce di fatto quello che all'inizio abbiamo descritto come la security posto dell'azienda quindi definire la postura di sicurezza dell'azienda significa occuparsi nella maniera più rigorosa possibile di tutti questi aspetti ok e noi per ciascuno di questi andremo a vedere un pochettino quali sono le soluzioni che sono a disposizione del del blue team a partire dall'assessment ok cosa significa fare assessment quindi cosa significa innanzitutto stabilire quali sono gli asset da proteggere ok bisogna fare un vero e proprio inventario di tutto quello che può essere una fonte di vulnerabilità o un asset da da proteggere e l'inventario riguarda tutto riguarda il il sistema informativo stesso quali sono quali sono gli asset vulnerabili quali sono i software che l'azienda utilizza per accedere e per gestire questi asset ok quali sono le macchine dispositivi hardware che vengono utilizzati per far girare questi software quindi ci sono un po' dentro tutte le dimensioni fare l'inventario di tutte queste cose significa raccogliere informazioni per descrivere nella maniera più completa possibile le caratteristiche dei vari dispositivi che utilizziamo che siano hardware che siano software quindi ad esempio nel caso del software è fondamentale sapere qual è la versione attualmente installata con quali licenze quali sono le patch che sono state montate e via dicendo cioè sono tutte informazioni che sono utili perché perché semplificano il lavoro del blue team ad esempio nel momento in cui vengono a conoscenza di un nuovo tipo di attacco viene pubblicato una nuova vulnerability sul sito che abbiamo visto prima il blue team nel più breve tempo possibile deve capire se il proprio sistema soffre di quella vulnerabilità ok e per sapere questa cosa qui naturalmente ho bisogno di sapere cosa è installato nel mio sistema e quali sono i software che girano eccetera eccetera e quindi bisogna accedere all'inventario se l'inventario è fatto male mancano delle informazioni questo significa che molto probabilmente nel mio sistema ci potrebbero essere delle vulnerabilità di cui io non sono a conoscenza ok la gestione dell'inventario degli asset è supportata da strumenti software che semplificano in parte automatizzano il processo di raccolta di queste informazioni ce ne sono diverse in interlatura quindi ne vedete alcuni e il loro obiettivo è proprio quello di supportare il gluten nella nella gestione degli inventari e lo stesso vale per quanto riguarda tool che invece fanno lo stesso tipo di lavoro però non rispetto a software e hardware ma rispetto ai sistemi informativi quindi com'è organizzato un sistema informativo all'interno dell'azienda ad esempio che ne so quanti e quali sono i database che vengono gestiti come sono collegati tra di loro quali sono le applicazioni che accedono ai vari database quali processi hanno visibilità di quali porzioni di database quali utenti hanno accesso alle applicazioni che accedono ai database quindi una raccolta diciamo completa di tutto quello che riguarda la gestione dei sistemi informativi anche questo è fondamentale per capire appunto come è strutturato il sistema e dove fluiscono le informazioni attraverso quali canali un inventario fatto bene su questi due fronti semplifica molto il lavoro del blue team perché gli permette di individuare tempestivamente dove potrebbero essere le vulnerabilità ok sulla base di questo il primo compito del blue team è quello di fare il cosiddetto risk assessment quindi stabilire se e dove sono presenti dei rischi ok possibilmente farlo nella maniera più rigorosa e oggettiva possibile poi vi faccio vedere uno strumento che si utilizza per fare il risk assessment ok per fare il risk assessment bisogna intanto stabilire di cosa lo vogliamo fare ok quindi rispetto a quali asset vogliamo stabilire i rischi dobbiamo fare l'inventario di cui parlavamo prima perché per conoscere gli asset abbiamo bisogno di un inventario e di tutto quello che riguarda la security posture associata ai vari ai vari asset e a valle di tutto questo fare un'analisi delle vulnerabilità come si fa l'analisi delle vulnerabilità di fatto cercando di simulare il comportamento del red team quindi facendo ad esempio penetration testing ok e di fatto i tool che il blue team utilizza per fare questo tipo di analisi sono gli stessi che usa il red team tanto per perché chiaramente se voglio simulare le capacità del red team devo usare i suoi stessi strumenti quindi diciamo che a lato blue team bisogna avere competenze analoghe a quelle del red team se non si hanno questo tipo di competenze queste cose si fanno in outsourcing una volta fatta l'analisi delle vulnerabilità quindi immaginatevi ho individuato gli asset che l'azienda deve proteggere ho fatto un inventario di tutto ciò che è collegato a questi asset quali sono i dispositivi hardware dove questi asset si trovano quali sono i software che accedono a questi asset quali sono le regole le policy di accesso a questi asset quindi ho descritto tutto una volta che ho tutte queste informazioni posso analizzare le vulnerabilità come faccio ad analizzarle o faccio riferimento al riposito di come il meter attack che abbiamo visto prima per cui lui mi dice che un certo software che io uso è vulnerabile quindi cosa devo fare analizzare il rischio associato con la vulnerabilità voglio fare un'analisi ancora più completa faccio pen testing lo faccio io lo faccio fare una squadra di professionisti ci sono tanti modi di fare un'analisi più o meno approfondita il risultato di questa analisi sarà un elenco di di vulnerabilità un elenco di vulnerabilità e associate quindi a dei rischi perché dei rischi perché se io ho una vulnerabilità nel mio sistema c'è un rischio che un potenziale avversario la possa sfruttare per attaccarmi ok quindi che cosa faccio faccio un'analisi di quelle che sono le minacce associate a queste vulnerabilità ok in che modo faccio un esempio ho fatto pen testing e ho scoperto che un determinato software che io uso per proteggere un database è vulnerabile ok questa vulnerabilità non è documentata sul sito meter attack ok qual è il rischio che un potenziale avversario la individui e la sfrutti per attaccarmi ho bisogno di quantificare no si tratta di una vulnerabilità difficile da scovare si tratta di una vulnerabilità che richiede un exploit particolarmente costoso da mettere in piedi ci sono degli avversari che sono interessati a quel particolare asset e quindi potrebbero essere motivati a investire per montare quel tipo di attacco tutta una serie di questioni di poco conto perché ripeto un conto è individuare le vulnerabilità del sistema un conto è una volta fatto questo identificare quali sono le minacce reali che vengono dall'esterno e che sfruttando quelle vulnerabilità potrebbero montare un attacco e quindi creare un danno quindi alla luce di queste informazioni io devo fare un'analisi per stimare i rischi oggettivi e dire bene ho una vulnerabilità più o meno grave la minaccia associata a questa vulnerabilità è più o meno grave anche questa combino le due cose nel combinare queste due cose io mi faccio un'idea possibilmente quantitativa di quella che è la probabilità che un attaccante mi buchi il sistema sfruttando quella vulnerabilità quanto è alta questa probabilità è molto alta beh se è molto alta allora cosa vuol dire vuol dire che io devo cercare di mitigare quella vulnerabilità quanto costa mitigare quella vulnerabilità in termini di risorse perché tanto tutto ha un costo la sicurezza ha un costo ed è un costo diciamo a fondo perduto perché non è un costo legato alla produttività è un costo che io pago per prevenire eventuali danni che non so neanche se si verificheranno quindi di solito il budget è limitato quindi quanto costa la mitigazione la soluzione al problema costa toglie sono disposto a pagarlo sì no forse quindi vedete ci sono tutta una serie di questioni non tutte legate alla sicurezza ma anche all'economia dell'azienda stessa il cui esito finale deve essere bene quella vulnerabilità la risolvo oppure no non la risolvo e se la risolvo come se invece non la risolvo la devo tenere lì documentata perché perché so che la devo monitorare anche se ho deciso di non risolverla ok non è non è banale fare combinare queste tipologie di analisi da una parte delle vulnerabilità dall'altra delle minacce però ripeto la combinazione di queste attività mi porta a determinare come risultato una valutazione quantitativa del rischio ok ed è sulla base della valutazione quantitativa del rischio che chi deve decidere mi dirà bene lì ci mettiamo una toppa là non ce la mettiamo ok e ora vi faccio vedere un esempio ci sono diversi tool che aiutano naturalmente a fare questo tipo di attività vi faccio vedere un esempio specifico di come si fa risk assessment che si basa su uno standard promosso dall'OASP che è una di quelle organizzazioni che abbiamo anche citato una delle volte scorse e che appunto come obiettivo l'OASP è una organizzazione non profita come obiettivo quello di sensibilizzare soprattutto le aziende ad adottare strumenti adeguati per una corretta security posture da una parte e dall'altra anche sensibilizzare i governi comunque gli enti pubblici a investire in questo tipo di risorse secondo il modello dell'OASP il rischio è il prodotto è la combinazione di due fattori il primo è la probabilità che una minaccia diventi reale quindi che una minaccia si trasformi in un attacco che io subisco quanto è probabile un attacco legato a una certa minaccia l'altro fattore è il danno quanto quanto è grave il danno che un attacco di quel genere mi porterebbe quindi il rischio è il prodotto di questi due fattori un modello di questo genere si utilizza anche nei processi di valutazione dei rischi sul luogo di lavoro quindi la valutazione dei rischi di incidenti sul luogo di lavoro quindi qualcosa che non ha a che fare con la cyber security ma ha a che fare con la sicurezza del luogo di lavoro l'analisi dei rischi combina la probabilità che si possa verificare un certo incidente con il danno che un incidente potrebbe infliggere e quindi sulla base di questa valutazione quantitativa chiaramente rischi elevati vanno in qualche modo risolti rischi meno elevati possono essere non dico trascurati ma comunque tenuti sotto controllo ora nell'ambito della cyber security o wasp classifica quelli che sono gli elementi che contribuiscono ai due aspetti probabilità di una minaccia e danno inflitto e il risultato finale è una valutazione del rischio in questa tabellina vedete un caso d'uso che ho preso reale dove diciamo trovate tutti gli elementi che contribuiscono alla probabilità al calcolo della probabilità e tutti gli elementi che invece contribuiscono alla valutazione del danno ok quindi vedete ci sono otto diversi elementi la cui valutazione ci dà una misura della probabilità di una certa minaccia e ce ne sono altre tanti che invece ci permettono di valutare di quantificare il danno una tabellina di questo genere andrebbe costruita rispetto a quello che è lo scopo del risk assessment come dicevamo nella slide precedente cioè prima cosa del risk assessment è di quale asset vogliamo valutare i rischi di incidente dovuti ad attacchi di agenti malevoli quindi individuiamo un asset facciamo il risk assessment di quell'asset ok e per valutare tutti i fattori che adesso andremo a commentare è fondamentale avere a disposizione gli inventari di cui parlavamo prima ok vogliamo fare il risk assessment di una risorsa questa risorsa è un database perché perché questo database contiene informazioni sensibili ad esempio i numeri di carte di credito dei miei clienti ok bene faccio l'inventario quali sono i dispositivi hardware che sono coinvolti ovvero i server dove sono memorizzati fisicamente i database gli host che hanno degli accessi a questi server e via dicendo quali sono i software usati per la gestione di questo database quali sono le policy che ho messo in atto per la protezione di questo database con parole semplici chi sono gli utenti che hanno accesso a queste a retabelle di database con quali diritti di lettura scrittura e via dicendo quindi tutte quelle informazioni che abbiamo di cui abbiamo raccontato nelle sbagli precedenti quindi ho il mio inventario ok di tutto quello che mi serve sapere per valutare che cosa per valutare quantitativamente tutti gli elementi che trovate in questa tabella ok dopo di che si parte elemento per elemento si va a stimare con un numero ok l'impatto di ciascun elemento sul calcolo di probabilità della minaccia o danno allora partiamo dalla stima della probabilità della minaccia gli elementi sono otto e sono divisi in due categorie ci sono elementi fattori che riguardano la minaccia cioè l'attaccante la descrizione dell'attaccante dell'avversario ce ne sono altri che invece riguardano fattori interni che descrivono le vulnerabilità degli strumenti che sono coinvolti nella gestione dell'asset quindi in qualche modo i primi quattro elementi sono esogeni sono esterni riguardano l'avversario e invece gli altri quattro elementi sono endogeni cioè riguardano gli strumenti che io ho in casa per gestire l'asset ok ciascuno di questi elementi va valutato gli va dato un peso da 0 a 9 0 vuol dire che quel fattore pesa poco nel contribuire al calcolo della probabilità 9 valore massimo vuol dire che quel fattore pesa molto ok i numeri che trovate in questa tabella sono un caso d'uso specifico a noi quello che interessa è capire il senso di ciascuno di questi fattori e il senso legato ad ogni valore numerico ad esempio partiamo dal primo fattore che sono le skill dove per skill si intende abilità dell'avversario cioè questo fattore serve per stimare quanto deve essere bravo quanto deve essere abile l'avversario che vuole attaccare il mio asset ok ad esempio se il mio avversario non ha skill tecniche il voto è basso ok se invece l'avversario che ho di fronte ha delle capacità di fare penetration dei sistemi quindi skillato allora il valore sarà massimo sarà 9 in mezzo ci sono tutti i casi intermedi quindi in pratica in questo fattore vado a stimare quelle che sono secondo me le capacità dell'avversario che potrebbe essere interessato al mio asset chiaro che se si tratta di un asset di poco valore molto probabilmente io qui estimerò che l'avversario non è particolarmente skillato perché un avversario particolarmente skillato punta a degli obiettivi di valore chiaramente qui ad esempio nel caso d'uso si stima che il valore di abilità dell'avversario rispetto al nostro asset di riferimento sia un valore medio pari a 5 ok e in maniera analoga si ragiona sugli altri fattori quindi ad esempio la motivazione è una stima di quella che noi riteniamo essere il livello di motivazione dell'avversario quanto è motivato l'avversario quanto potrebbe essere motivato l'avversario a attaccare il nostro asset anche qui è una stima che faremo in base al valore dell'asset ok se l'avversario non è motivato il voto è basso se l'avversario è molto motivato perché è alto il reward che potrebbe avere chiaro che se l'asset sono i numeri di carta di credito allora la motivazione aumenta se l'asset sono le email dei miei clienti probabilmente la motivazione è più bassa ok quindi anche qui dà un valore no e gli altri fattori sono l'opportunità ok ovvero una stima di quelle che secondo me sono le opportunità che l'avversario ha di riuscire a sfruttare le vulnerabilità legate al nostro asset ad esempio se l'avversario ha modo di sfruttare una vulnerabilità del nostro asset senza usare risorse particolari allora il rischio è più elevato e quindi gli si dà peso massimo 9 se per sfruttare la vulnerabilità io so che l'avversario deve riuscire a penetrare il sistema usando risorse particolarmente costose poi una volta che ha penetrato il sistema deve fare escalation e anche questo ha un costo per arrivare all'asset quindi deve superare tutta una serie di ostacoli importanti è chiaro che le opportunità che lui ha a disposizione per arrivare all'asset diminuiscono e quindi il peso diventa più basso ok l'ultimo l'ultimo fattore è la dimensione del gruppo di potenziali avversari ok dimensione intesa come ampiezza della categoria cioè chi è il mio avversario il mio avversario un qualunque utente che ha un accesso a internet è considerabile un mio avversario se sì la cosa è grave cosa significa questo se un qualunque utente che ha accesso a internet per me è un avversario cosa significa significa che chi ha accesso a internet ecco che ha già gli strumenti necessari per poter provare ad attaccarli quindi vuol dire che la platea di potenziali attaccanti commenta se invece i miei potenziali avversari sono solo ed esclusivamente degli insider cioè degli utenti interni al sistema perché solo loro conoscono determinate informazioni o hanno la possibilità di attaccare il mio asset ad esempio perché il mio asset non è collegato a internet e quindi per forza un avversario è un qualcuno che ha accesso fisicamente alla mia alla mia l'anno al mio sistema è chiaro che la platea di possibili avversari si riduce chiaramente a quelli che hanno accesso fisico al sistema è chiaro che maggiore la platea di possibili avversari maggiore sarà il rischio e quindi vedete che i valori numerici aumentano ok sulla base delle valutazioni vedete che per ciascuno dei fattori schiene motivation opportunity size è stata fatta una stima in questo caso particolare ok che sono quei quattro stime che vedete lì gli altri stimare i fattori esogeni è un po' più complicato perché devo cercare di mettermi nei panni dei potenziali versari che potrebbero attaccarmi e quindi potrei non avere informazioni sufficienti per riuscire a stimare correttamente queste informazioni questi aspetti chiaramente mentre invece per quanto riguarda i fattori endogeni è più facile è più facile perché si tratta di fattori che riguardano le caratteristiche del mio sistema ok e quali sono questi fattori sono la discovery easy quanto è facile individuare vulnerabilità associate al mio asset è chiaro che per dare una risposta a questa domanda io devo analizzare il mio sistema ad esempio devo provare a fare penetration test o io o dei professionisti se il risultato del penetration testing è che non ci sono vulnerabilità allora è chiaro che la discovery easy sarà avrà un valore basso valore pari euro significa praticamente impossibile ad esempio situazione ideale se la vulnerabilità di cui soffre il mio sistema è documentata su meter attack e non solo esistono degli exploit preconfezionati disponibili su dei tool che chiunque può usare è chiaro che la discovery easy avrà il valore massimo chiaramente quindi la discovery easy è una misura della difficoltà di individuare l'eventuale vulnerabilità l'exploit easy è qualcosa di analogo misura la facilità nel montare un attacco che sfrutta quella vulnerabilità un conto è un conto è quanto è facile trovare una vulnerabilità ma un conto è quanto è facile costruire un attacco che sfrutti quella vulnerabilità quindi questo è l'exploit easy può essere molto facile molto difficile anche qui si dà un voto l'awareness misura il livello di conoscenza di quella vulnerabilità torno ad esempio di prima so so che il mio asset soffre di una vulnerabilità che è documentata su un mitra attacco quindi cosa vuol dire vuol dire che tutti la conoscono perché è documentata in un repository pubblico quindi valore massimo 9 trovo una vulnerabilità che richiederebbe uno zero degli attacco perché quella vulnerabilità non la conosce nessuno non è documentata da nessuna parte sono stato fortunato io a trovarla facendo il penetration testing vuol dire che non c'è consapevolezza di quel tipo di vulnerabilità e quindi vuol dire che diventa ancora più difficile per l'attaccante scovarla ok e quindi si dà un valore molto basso e l'ultimo fattore la identification ability è una stima di quanto è facile per me identificare bloccare un attacco che sfrutti la vulnerabilità che ho individuato ok no perché faccio un caso il mio asset è una vulnerabilità esiste un exploit di quella vulnerabilità documentata un attaccante potrebbe usarla però io ho uno strumento di difesa in grado di bloccare quell'exploit quindi vuol dire che la minaccia perde di di importanza perché vuol dire che io ho uno strumento di difesa sufficientemente robusto per riuscire a bloccare quel tipo di di attacco ok anche qui si dà dei pesi si fa la stima morale della favola una volta che io ho calcolato tutti questi valori numerici che vedete nella colonna in fondo a destra della tabella si fa la media pesata ok si fa la media pesata in questo caso la media pesata dà come risultato 3,5 e 3,5 è valutato come probabilità media in una scala molto semplificata in cui vediamo un po' in cui da da da 0 a 3 è considerato basso low da 3 a 6 è considerato medium e da 6 a 9 è considerato high alto ok visto che nel nostro caso è venuto fuori 3,5 come valore pesato di queste stime quindi significa che la probabilità associata alla minaccia è di livello medio ok chiaro che tanto più giuste sono queste stime tanto più fedele sarà il risk assessment se le stime sono strampalate il risultato che ottengo non è significativo ok con lo stesso approccio si va a misurare il danno potenziale e i fattori sono quelli che vedete qui anche in questo caso si tratta di fattori di due tipi fattori che hanno impatto tecnico e fattori che hanno un impatto economico ok quali sono questi fattori beh l'impatto tecnico è anche abbastanza facile da commentare sono i diversi livelli di perdita di compromissione di proprietà di sicurezza legate ad un eventuale attacco che dovesse andare a buon fine nei confronti del nostro asset ok quindi se l'avversario riesce a completare l'attacco con successo dal punto di vista materiale dal punto di vista tecnico che cosa ci rimetto cosa ci perdo potrei perderci in confidenzialità se il mio asset era il database di cui parlavamo prima e questo database contiene informazioni sensibili che non voglio che vengano divulgate ho una perda di confidenzialità ok e anche qui devo valutare che cosa significa quantitativamente perdere confidenzialità perdo pochi dati non sensibili il valore sarà basso perdo tutti i dati compresi quelli sensibili beh allora il valore sarà il più alto possibile ok dopodiché si ragiona analogamente per gli altri fattori rischio di perdere anche l'integrità cioè l'attaccante non solo ha la possibilità di rubarmi i dati ma anche la possibilità di compromettere i dati interno nella database modificandoli addirittura cancellandoli quindi in quel caso ho una perdita di integrità e anche qui i valori potranno essere più o meno elevati gli altri fattori interessanti sono la availability ok l'attacco rischia di compromettere la disponibilità dei servizi aziendali sì no in che misura l'attacco blocca la produttività dell'azienda se la risposta è sì allora il suo peso è particolarmente elevato se nessun servizio fondamentale viene compromesso allora il peso sarà più più basso ok e l'ultimo che è non meno importante l'accountability ok che è una misura della tracciabilità di quello che è successo no cioè io mi devo anche chiedere in che misura io riesco ad accorgermi dell'attacco che sto subendo ok perché se io me ne accorgo subito vuol dire che ho anche dei tempi di reazione più rapidi e quindi ho la possibilità di neutralizzare l'attacco ma se io dell'attacco non me ne accorgo perché perché ho solo perso confidenzialità l'avversario è stato bravo a mascherare le proprie tracce e mi ha messo su una backdoor e io di tutte queste cose non mi accorgo quindi vuol dire che l'attaccante continua a fare dei danni nel tempo ok quindi se non ho alcuna possibilità di tracciare quello che è successo non ho neanche una possibilità di tracciare poi chi è l'avversario bloccato quindi anche qui ho una valutazione e poi infine ci sono i fattori economici economicamente e non solo in realtà quanto mi costa l'attacco che ho subito che subisco dall'attaccante ho un danno finanziario no che può essere di poco conto ok questo è emblematico se il danno economico che io subisco è inferiore alle risorse che io avrei dovuto spendere per neutralizzare la vulnerabilità cosa mi conviene fare mi conviene lasciare lì la vulnerabilità tanto se qualcuno la sfrutta mi fa un danno è inferiore a quello che mi sarebbe costato a me per eliminare la vulnerabilità allora chi se ne frega ma se il danno porta alla mancarotta chiaramente questo rappresenta un rischio elevatissimo è un altro fattore la reputazione è un altro fattore il danno finanziario è di mera natura economica ok squisitamente di natura economica perché poi un altro fattore è il danno di reputazione che può avere chiaramente non immediatamente ma nel tempo una ricaduta sulla sugli aspetti di natura finanziaria chiaramente ci vuole più tempo però chiaro se una banca è vittima di un attacco che finisce sui giornali è chiaro che è un grosso danno di reputazione per la banca magari potenziali clienti invece di rivolgersi a quella si rivolgeranno a un'altra se vogliono fare un banking aprire un conto in un banking quindi il danno di immagine è altrettanto importante anche se ha una ricaduta forse non non immediata un altro fattore importante è la compliance ovvero se io subisco un attacco che va a buon fine indipendentemente dai danni che genera solleva una una mia negligenza punibile in termini di legge o in termini di altri regolamenti cui io devo sottostare o in termini di contratti faccio un esempio banale conoscete il GDPR la normativa europea in termini di gestione della di garanzia relativa alla privacy degli utenti quindi come ad esempio un'azienda deve gestire i dati personali degli utenti ok ora se l'azienda subisce un attacco che comporta una violazione di informazioni sensibili dei clienti e che mette in evidenza una negligenza dell'azienda nei confronti del GDPR ecco che quell'azienda subisce un danno non solo dall'attacco in sé per sé ma anche dalle conseguenze dell'attacco in termini magari di sanzioni prendete anche il caso di non di violazione di legge ma di violazione di contratti io ho un contratto con uno stakeholder che mi impone di fare determinate cose subisco un attacco che fa sì che io che le cose non riesca a rispettarle alla fine era colpa mia e quindi subisco i danni stabiliti in base alle norme contrattuali e quindi anche questo è un aspetto da prendere in considerazione infine l'ultimo aspetto non meno importante è la dimensione della violazione della privacy la privacy è considerato un elemento particolarmente rilevante è ortogonale rispetto a questi fattori tecnici e anche la violazione della privacy va valutata in che misura si perde privacy quanti soggetti sono coinvolti dalla perte di privacy dovuta all'attacco ok quindi anche qui si fa la stima la stima la correttezza delle stime di questi fattori è più semplice perché ripeto sono fattori endogeni al sistema aziendale se ho fatto bene tutte le fasi precedenti ho fatto bene l'inventario ho fatto bene l'analisi e quindi ho individuato tutte le potenziali vulnerabilità eccetera eccetera eccetera ecco che la valutazione di questi aspetti diventa abbastanza accurata quelli un po' più difficili da valutare sono questi ma solamente in parte ok anche qui si fa la somma pesata delle stime e si ottiene un valore che è la media ok in questo caso supera il 6 quindi il valore considerato alto come si combinano i due valori in genere si usa una tabellina come questa che ci dice di che tipo di rischio si tratta basso medio o alto andando a combinare il valore della probabilità della minaccia con il valore del danno associato a quella minaccia nel nostro caso era saltato fuori che la probabilità era medium il danno era elevato e questa tabellina qua sulla destra mi dice che se ho la combo medio elevato allora il rischio è elevato ok quindi vedete questa è una procedura sistematica il cui obiettivo è cercare di quantificare nella maniera più oggettiva possibile qual è il rischio associato a tutti gli asset che io ho necessità di proteggere quindi verrà fuori un report dove io ho l'elenco di tutti gli asset dei rischi associati ai vari asset e qualcuno ai piani alti dovrà decidere quali sono i rischi tollerabili su cui non investire strumenti di difesa e quali sono invece i rischi che non possono essere ignorati magari un rischio elevato va risolto subito come policy un rischio basso magari lo si può ignorare e rivalutare magari fra un anno per vedere se da basso aumenta oppure no un rischio medio magari può essere posticipato di qualche tempo queste potrebbero essere le policy che vengono adottate ok due parole su OWASP poi chiediamo il modellino che vi ho appena fatto vedere è uno standard proposto da OWASP ci sono dei tool che supportano questo tipo di modello per cui potete creare il vostro modello di risk assessment all'interno dell'azienda usando questo modello qua OWASP come dicevo prima una fondazione non profit che ha l'obiettivo di promuovere le good practices nell'ambito della security posture in contesti aziendali o corporate in generale e tra i suoi obiettivi c'è anche quello appunto di promuovere queste buone prassi come ad esempio il risk assessment ma non solo ok vi faccio vedere il sito perché anche questo può essere un riferimento interessante per approfondire determinate tematiche qua dentro volevo andare in quello geografico qua dentro trovate fermati lì trovate diversi progetti in cui OWASP è coinvolto nella definizione di standard di sicurezza adeguati e se non arrivare i contesti e quindi potete trovare informazioni relative agli strumenti di difesa come utilizzarli come definire le policy security policy come fare risk assessment come gestire il ciclo di vita delle minacce quindi tutta una serie di linee guida utili per guidare che cosa? beh uno qualunque dei processi che abbiamo descritto qui quindi dall'assessing della security posture alla gestione del ciclo di vita delle minacce agli strumenti che si possono utilizzare per migliorare la postura di sicurezza in maniera trasversale su tutti questi argomenti esistono esistono delle linee guida che OWASP mette a disposizione e che potrebbero rappresentare un potenziale approfondimento per il vostro progetto ad esempio va bene direi che per oggi ci possiamo fermare qua a 과 non