ok allora oggi vi faccio vedere un po di esempi di applicazione di tecniche di modelli di penetration testing quindi molti degli esempi che vi farò vedere oggi anche la prossima volta alcuni di questi sono veri e propri progetti quindi possono essere presi come riferimento come spunto per lo svolgimento di progetti che riguardino il pen testing a partire da come si crea un ambiente di prova di simulazione fino ad arrivare alla scelta delle macchine degli osti da coinvolgere la tipologia di attività da svolgere che coprono possono coprire un po tutte le fasi della keychain che abbiamo visto nelle scorse settimane quindi dal riconoscimento in questo caso attivo delle possibili vulnerabilità fino alla scelta del vettore di attacco più appropriato in base alle vulnerabilità che si sono individuate fino ad arrivare al lancio dell'attacco e poi eventualmente la prosecuzione dell'attacco attraverso attività di privilege escalation o lateral movement a seconda di quelli che possono essere i diversi obiettivi e per quanto riguarda l'ambiente per quanto riguarda l'ambiente virtuale dove fare dove provare a fare questo tipo di esercizi come vi ho anticipato l'altra volta è necessario farvi in un contesto virtualizzato perché nessuna delle operazioni che vedremo a partire dal riconoscimento attivo si possono fare in un contesto open in un contesto di direte che dir si voglia perché già l'uso di nmap come strumento di scanning delle porte se non è autorizzato è illegale quindi tutto questo tipo di porti si sia chiaramente ma ve ne farò vedere ve ne citerò un paio di sì sì sì sì sì un'alternativa allo sviluppo in casa di un ambiente virtuale di test ci sono dei siti che metteranno a disposizione questi ambienti utilizzando magari anche soluzioni più contenute come ad esempio dei locker o soluzioni tecniche di questo genere che chiaramente dipende dalla tipologia di attacco ad esempio ci sono molti molti siti che mettono semplicemente a disposizione un'interfaccia web per fare per provare a fare attacchi di quel tipo lì insomma quindi che ne so attacchi di injection contro contro le applicazioni web altri invece che mettono semplicemente a disposizione un vero e proprio ambienti virtuale attrezzato con degli host virtuali dove invece provare a implementare attacchi un pochino più complessi crearsi un ambiente virtuale per fare penetration testing in casa non si può fare fondamentalmente in maniera più semplice attraverso due strumenti uno è virtual box e l'altro è VMware virtual box lo trovate per tutte le piattaforme open source e gratis non so se VMware ultimamente si è aperto anche per distribuzioni particolari come macOS o altro perché fino a poco tempo fa non era disponibile gratuitamente per certi sistemi operativi sicuramente per Linux direi anche per Windows non so se in altri contesti in altri corsi avete mai avuto modo di di vedere di utilizzare questo tipo di strumenti diciamo che per per il tipo di attività che è legato al penetration testing che potreste fare c'è un elemento della configurazione della rete virtuale che bisogna fare attenzione ed è il tipo di connessione che la rete virtuale che andate a creare deve avere potete optare per tre modalità per tre modalità quando create un ambiente virtuale che non è un certo numero di host potete avere una connessione diretta alla rete esterna e quindi modalità bridge quando create un ambiente virtuale con un certo numero di host potete avere una connessione diretta alla rete esterna quindi modalità bridge questo significa che la rete virtuale che andate a creare è a tutti gli effetti un elemento della rete fisica in cui si trova la vostra macchina server dove andate a installare la rete virtuale quindi a tutti gli effetti gli host virtuali che state creando sono la stessa stregua degli host fisici quindi questo tra le altre cose significa che hanno loro ip visibile dall'esterno e significa che possono accedere alle risorse esterne a tutte le risorse esterne cui ha accesso la macchina fisica dove installate la rete e quindi di fatto diventano un'estensione fisica della vostra macchina con la piena capacità di accedere alla rete esterna se la vostra macchina ha accesso alla rete esterna e di essere accessibile dall'esterno e questa è la modalità che io sconsiglio di utilizzare per fare esercizi di penetration testing perché perché essendo gli host che andate a creare parte stessa della rete in cui vi trovate nulla impedisce che effetti collaterali ma ad esempio di malware che testate sulla vostra rete virtuale vengono propagati anche all'esterno e quindi attacchi che vengono condotti sugli host virtuali potrebbero propagarsi anche sulla rete esterna mentre invece è sempre meglio avere un confine ben definito tra la rete del vostro e del virtuale il mondo esterno la soluzione ideale è di isolarlo completamente isolare completamente la vostra rete virtuale dall'ambiente esterno quindi è dalla terza modalità quindi la rete interna in questo modo gli host che andate a creare di fatto non hanno accesso alla rete esterna non ip non hanno nulla e non sono nemmeno visibili da fuori e quindi di fatto è come se fosse una lan completamente distaccata dal mondo esterno quindi quello che succede lì dentro rimane lì dentro ok una via di mezzo praticabile con attenzione la modalità nat in cui la vostra rete virtuale interna è sì in un certo senso isolata nel senso che non ha un accesso diretto al mondo esterno e non è direttamente osservabile dal mondo visibile dal mondo esterno ma il tutto avviene attraverso l'interfaccia dell'host che ospita la rete virtuale che diventa un tramite tra l'alarm virtuale che state creando il mondo esterno quindi avete comunque una possibilità di accedere alla rete esterna ma lo potete fare per il tramite dell'host che ospita la virtuale che diventa tutti gli effetti una sorta di router di gateway di interfaccia ok e quindi eventuali comunicazioni da verso il mondo esterno sono comunque mediati dal dall'host che ospita la rete virtuale a meno di casi particolari in cui quello che volete implementare necessita di una connessione a internet per qualche motivo particolare ad esempio perché dovete accedere in tempo reale dei ripositori esterni o cose di questo genere in tutti gli altri casi è sufficiente ed è bene configurare come rete interna la rete virtuale che andate che andate a creare questo senza ombra di dubbio questo ad esempio di una fase di configurazione della rete quali quali quali flag dovete andare impostare per la modalità rete interna ok quindi ad esempio in particolare vedete che in questo caso state configurando una macchina virtuale con il suo indirizzo che però è connesso solo ed esclusivamente all'host che la ospita quindi non non ha accesso alla rete esterni in questa maniera appunto potete configurare tutti quanti gli host della della vostra lan della vostra virtuale che macchine andare a installare sulla vostra lan quantomeno se volete fare delle esercizze di pen testing servono due macchine una attaccante e una vittima ok quindi questa è la configurazione minima la macchina attaccante è sempre per il caso più più più semplice è sempre una versione di di linux si chiama kali e che è nativamente equipaggiata con tutti gli strumenti di pen testing in particolare quelli che abbiamo citato come abbiamo fatto quella lezione sulla sulla keychain dedicata al red team quindi tutti gli strumenti di di scanning tutti gli strumenti necessari per poi fare montare spettare exploit e via dicendo ci sono due distribuzioni fondamentalmente dalla cali una è la full e l'altra è una light la full è un po più pesante però i tool li contiene tutti la light piuttosto più leggera lo contiene solo alcuni in genere viene utilizzata quando volete montare una rete con più di due host in cui ad esempio volete provare a sperimentare attacchi di tipo man in the middle quindi attacchi dove c'è una macchina che smiffa il traffico tra le altre due però diciamo che in una configurazione classica con un attaccante la vittima la full ha tutte le funzionalità quantomeno rispetto a tutti i tipi di esempi che vi farò che vi farò vedere è free open source punto la distribuzione di linux è quello l'indirizzo dove potete andare a a scaricarvi la versione vediamo se solo che la cosina numero condivide togliamo sta roba facciamo condivisione dello schermo e provate già le immagini a seconda del tra l'altro nel caso del provate già la macchina virtuale della cali sia per virtual bosch che per la one aware quindi vi scaricate quella se avete a seconda del tipo di nav virtuale che avete va su da solo in automatico già preconfigurata quindi seguendo questo link trovate già il pacchetto preconfezionato per la vostra per la vostra macchina virtuale queste lecce questo di sinistra versione se invece avrete proprio installare sul nostro vostro os fisico ma questo è un altro discorso che probabilmente non interessa quindi questa cosa funziona cosa sto condividendo condividendo funzioni questo per quanto riguarda l'attaccante poi vedremo un po vi darò qualche riferimento su quali che sono gli strumenti al suo al suo interno qui vedete un esempio di di di di di alcuni dei parametri di configurazione che è bene come minimo impostare per nel momento in cui l'andate a configurare su su virtual box quindi la quantità di memoria che chiede specialmente per quanto riguarda la ram però ripeto praticamente va va su da sola non ci sono accortezze particolari da prendere da prendere da prendere in considerazione invece per quanto riguarda la macchina vittima qui ci sono diverse soluzioni diverse possibilità a seconda naturalmente del tipo di vittima che vi interessano innanzitutto dovete individuare il sistema operativo nella vostra la vostra macchina vittima la macchina linux la macchina windows è qualcos'altro quindi questa è la prima cosa da qui a cui pensare se come macchina vittima volete una macchina linux su web trovate innumerevoli innumerevoli fonti da cui scaricare l'immagine per virtual box per virtual box o vmware in entrambi i casi della versione di linux che vi interessa ok io qui ne ho citate due generaliste che sono quelle dove di solito si attinge quando si vuole fare un'installazione della macchina virtuale linux e solo la distro watch la thunkey linux in particolare thunkey linux.org non è che mi richiede tutto il nuovo no ok e qui trovate le trovate tutte tutte ok tra l'altro già già in certi casi già arricchite con alcuni degli strumenti che magari potreste utilizzare per i vostri attacchi qui trovate la classica ad esempio la classica lamp in linux con a pass ma sql php che può essere utile se ad esempio le vulnerabilità che volete andare a testare riguardano riguardano alcuni di questi alcuni di questi strumenti e e vabbè poi chiaramente ci sono delle varie tutte le varie versioni però la classica lamp è un esempio abbastanza abbastanza tipico poi invece ci sono delle repository dove e questo diciamo a seconda del tipo di pen testing che volete fare no perché voi potreste provare a fare pen testing su una macchina classica quindi andate sulla tarcchi linux volete provare ad attaccare una certa versione della lamp usandolo la kali e attaccate e attaccate la macchina classica perché sarebbe la stessa tipologia di macchina che di installazione che fareste distribuzione scegliereste per installare il sul vostro laptop ok nessuna differenza rispetto a un contesto reale e quella è una possibilità un'altra possibilità forse leggermente più semplice consiste nell'andare a scegliere invece una distribuzione di linux pre confezionata pre confezionata con delle vulnerabilità usata apposta per gli esercizi di pen testing ok quindi non è una distribuzione standard di quelle che usereste per installare linux sul vostro laptop ma è una distribuzione adatta per fare esercizi creata appositamente per fare esercizi di pen testing quindi una distribuzione che contiene già delle vulnerabilità note che non dovete andare a scovare voi ma che sono già comunque presenti e documentate tra queste la più diffusa in assoluta e di solito quella più utilizzata negli esercizi di pen testing è la metasploitable ok che è una distribuzione appunto di linux appositamente vulnerabile mettiamola così ok che contiene contiene già diverse diversi servizi diverse applicazioni con un sacco di vulnerabilità ok quindi vedete la differenza tra scegliere una distribuzione standard e una pre confezionata per il pen testing sta proprio un po' nella nel livello di difficoltà che volete che volete che volete che volete affrontare fermo restando che comunque in ogni caso adesso vi farò vedere qualche esempio però immaginiamo che voi vogliate provare un certo tipo di attacco un certo tipo di vulnerabilità che ne so un punto di partenza tipico può essere vado sul sito mitre attack che vi ho fatto vedere qualche settimana fa vi volete concentrare su un tipo di vulnerabilità quindi andate nella tabella delle tecniche delle tattiche vi piace la sequela injection vi piace un command injection vi interessa la vulnerabilità legata ai protocolli di comunicazione andate a cercare no la fase della kill chain che vi interessa volete che ne so provare a verificare avete letto da qualche parte di una vulnerabilità dell'acrobat reader piuttosto che di wordpress piuttosto che di un altro applicativo bene volete provare a fare esercizio su quello andate a cercare sul sito di un mitre attack la vulnerabilità del servizio che vi interessa leggete la documentazione che vi dirà che la versione tal dei tali di quell'applicativo lì ha una vulnerabilità documentata e quindi a quel punto voi cosa potreste fare vi installate come macchina vittima una macchina linux standard scaricata appunto da ad esempio da tanti linux.org o da distro watch quindi esattamente come se doveste installare una macchina linux virtuale per altri motivi e su quella macchina virtuale installate la versione vulnerabile dell'applicativo che volete testare che sia wordpress che sia acrobat reader photoshop quello che volete insomma di applicazioni con delle vulnerabilità lo trovate a quinta lato sul sito metatac dopodiché molto probabilmente attraverso la macchina attaccante la kali linux sarete in grado usando gli strumenti della kali di individuare la vulnerabilità sulla macchina vittima e molto probabilmente troverete anche dentro un applicativo di kali che si chiama metasploit ma ce ne sono diversi troverete già preconfezionato l'exploit per confezionare il vettore d'attacco che scontacta quella vulnerabilità e provarlo e vedere quali sono gli effetti dell'attacco questo è un modo di condurre vi ho fatto brevemente la cronostoria di come potreste procedere nell'andare a scegliere una una vulnerabilità specifica di un servizio e provare ad attaccarlo quindi provare a mettere in pratica un qualcosa che è già documentato quindi non vi si sta chiedendo di di fare pen testing con l'obiettivo di scovare vulnerabilità sconosciute ok ma di testare a lato pratico cosa vuol dire condurre un attacco noto basato su una vulnerabilità nota e basato su un exploit preconfezionato ok poi la cosa si può complicare nel senso che la cosa può finire lì sfruttare la vulnerabilità lanciare l'attacco e l'attacco magari che ne so vi permette di aprire una scelta remoto sulla macchina vittima con privilegi di di root ed ecco che il breccio è stato fatto e poi la cosa si può si può fermare lì oppure potete decidere di portarla avanti perché nel momento in cui avete no accesso a avete un accesso privilegiato alla macchina vittima li potete decidere di fare altre cose quindi vi farò vedere un esempio in cui fatto questo si va a cercare il file delle password no i metici password e poi lo si da in pasto a uno dei tool di hacking delle password basato sul brute force attack che la CAI mette a disposizione per vedere il che la CAI mette a disposizione per vedere se riuscite a traccare delle password o che ne so provare a fare privilege escalation e quindi utilizzare altri exploit che sempre la CAI mette a disposizione per acquisire ulteriori diritti sulla macchina vittima e così via quindi completare se vogliamo in qualche modo la la kill chain ok però se partite come distribuzione di macchina vittima dalla della meta exploitable il vantaggio che avete è che su quel è si tratta di una versione di Linux che nativamente di suo monta già tutte le applicazioni vulnerabili possibili quindi senza che dobbiate voi andare a cercare casi particolari ripeto fermo restando che in mente non abbiate già qualcosa di specifico che vi intriga e allora vi andate a cercare l'applicazione vulnerabile la installate sulla vostra macchina virtuale poi provate a bucarla ok e direi che la stragrande maggioranza degli esercizi di pen testing vanno in questa direzione usando la full kali come attaccante e la meta exploitable come vittima in qualche caso se è apprezzato il fatto di usare invece delle distribuzioni di stanza e sarebbe ancora più apprezzato invece provare a implementare degli attacchi di tipo man in the middle che ancora noi non abbiamo visto a lezione perché gli attacchi di tipo man in the middle sono attacchi che si conducono nei confronti dei protocolli di comunicazione tra due host quindi avete una comunicazione end to end da Alice a Bob questa comunicazione avviene seguendo un determinato protocollo che può usare o meno delle primitive e crottografiche un attacco di tipo man in the middle viene condotto dall'avversario che intercetta il traffico in partenza da Alice e in certi casi lo sniffa e basta cercando di recuperare possibilmente informazioni confidenziali in caso di più avanzati l'attaccante quello che prova a fare è non solo intercettare il traffico ma o tentare di alterarlo o tentare di riutilizzarlo per alterare la sessione corrente o sessioni future che riguardano il destinatario tipico scenario è quello in cui c'è una sessione protetta tra Alice e Bob l'avversario intercetta parte del traffico di quella sessione e lo riutilizza successivamente per mettere in piedi un'altra sessione diversa con Bob facendo finta di essere Alice questo è un esempio tipico di attacco attivo di tipo man in the middle comunque sono argomenti che dobbiamo ancora vedere che vedremo tra qualche settimana lì capirete che cosa vuol dire a seconda del protocollo condurre questo tipo di attacchi questo per quanto riguarda il mondo Linux se invece come macchina vittima scegliete una macchina Windows anche qui vale un po' il discorso fatto prima ovvero una cosa ovvia e banale che potete fare andare sul sito della Microsoft che mette a disposizione le immagini delle diverse versioni del sistema operativo scaricarne una qualunque versione l'aggiornamento lo scegliete voi ce ne sono anche qui già però che preconfezionate che si montano da sé su VirtualBox su VMware dopodiché su queste macchine valido discorso che facevo prima ovvero ci installate sopra applicazioni vulnerabili l'esempio tipico di molti progetti che ho visto riguarda WordPress che vecchie versioni di WordPress hanno un sacco di vulnerabilità ok l'altra alternativa analogamente all'esempio di Linux che vi ho fatto prima consiste nel installare sulla macchina Windows virtuale un'applicazione preconfezionata per esercizi di pen testing poi ve ne citerò una che è particolarmente utilizzata soprattutto per gli attacchi in ambito web services perché è un'applicazione con un'interfaccia web che vi consente come attaccanti di provare a implementare degli attacchi al servizio web tipicamente attraverso SQL injection piuttosto che command injection attacchi attraverso di script o cose di questo genere ok da questo punto di vista esistono tante applicazioni web preconfezionate vulnerabili per attacchi di questo per attacchi di questo genere e molte di queste si basano su una su un'architettura che nel caso di Linux è la classica LAMP perché sono servizi che si basano su un server che monta Apache e che monta DBMS che può essere MySQL o altro e comunque PHP in ambito Windows la piattaforma XAMPP è quella che è più facile da trovare quindi MariaDB come DBMS PHP e Perle è sempre Apache è una delle applicazioni web più divertenti da provare a bucare si chiama Mutilidee questa ad esempio è già presente nella distribuzione del Linux Metasploitable quindi è un po' il discorso che vi facevo prima se voi vi scaricate come vittima la Metasploitable su questa gratis vi trovate già un sacco di applicazioni vulnerabili e tra queste trovate la Mutilidee in particolare nella versione 2 della metasploitable la metasploitable trovate preinstallata la Mutilidee ma la trovate anche come applicazione stand-alone da scaricare e installare sulla macchina di vostra scelta ok? quindi c'è il sito dedicato al progetto Mutilidee che è quello riportato lì potete andare lì e scaricarvi l'applicazione e installarla su qualunque macchina LAMP o XAMPP voi abbiate preconfigurato ok? sia per Linux che per Windows quindi potete decidere di usarla nativamente in una distribuzione che già la contiene o la potete scaricare e installare dove volete ok? è l'applicazione che consiglio una delle due che consiglio di utilizzare se volete sperimentare attacchi ai servizi web quindi a partire dalla SQL injection in su l'altra che secondo me è molto molto carina da utilizzare anche facile perché prevede tra l'altro al suo interno delle vulnerabilità con diversi livelli di difficoltà quindi è anche molto flessibile da questo punto di vista è la DAM vulnerable web application il nome è già una garanzia e anche questa la trovate disponibile sia per Linux che per Windows e si basa su una piattaforma che utilizza MySQL come data di BMS e PHP come linguaggio di interfaccia con il BMS e qui trovate un po' di riferimenti il primo è il link ufficiale dove potete scaricarvi l'applicazione installando dove volete se ricordo bene nell'ultima versione della Metasploitable è già preinstallata e poi trovate altri riferimenti che sono interessanti perché quantomeno vi dicono come è configurata questa applicazione come installarla, come utilizzarla e che tipo di esercizi di pen test vi ci potete provare a fare sopra un paio degli esempi che vi fornirò si basano proprio sull'attacco di questa applicazione quindi in ambito web diciamo che questa o la Mutilead sono le due che vi consiglio di usare l'alternativa di cui parlavamo prima alla creazione di un laboratorio virtuale consiste nel fare esercizi di pen testing online ci sono dei siti che mettono a disposizione ambienti più o meno completi più o meno completi significa che in certi casi vi mettono a disposizione semplicemente un servizio web è un servizio web vulnerabile come il dv da W e lì siete autorizzati a tentare tutto quello che vi viene in mente di fare per cercare di bucare quel servizio in altri casi invece come ad esempio il caso di Acme site.org o Acme sono fatti molto bene questi anche lì si possono si può fare riferimento a diversi livelli di difficoltà scegliete il livello di difficoltà e vi vengono proposti diversi tipi di vulnerabilità da sfruttare mentre invece in altri casi potete avere a disposizione un intero ambiente virtuale online dove potete veicolare voi l'installazione di macchine virtuali quindi fare la stessa cosa che dicevamo prima solo che invece di farla sulla vostra macchina usando virtualbox lo potete fare su un servizio remoto che ad esempio il web security dojo che è uno dei più diffusi mette a disposizione quindi avete a disposizione sul cloud uno spazio dove potete installare le vostre macchine virtuali e utilizzarle appunto per fare pen testing queste sono le diverse opportunità che avete a disposizione per fare esercizi di pen testing nella maniera più semplice possibile e che sono tutti esercizi che sono progetti più che ragionevoli per capire la difficoltà e la dimensione adesso vi farò vedere qualche esempio però gli esempi che vi mostrerò adesso sono tutti tutti i progetti ragionevoli ok poi ci sono quelli più o meno più o meno complessi ma sono tutti ragionevoli vi lascio questi due riferimenti primo perché sono entrambi open quindi li potete scaricare sono gratis e proprio perché sono fatti bene perché uno è una sorta di manuale di uso della Kali Linux il primo e l'altro invece sempre usando Kali Linux come caso d'uso dimostra in generale quelle che sono le diverse tecniche di pen testing basate sulle diverse fasi della keychain quindi è un manuale più generico che però fa comunque uso della Kali come caso d'uso reale il primo è più un manuale invece di quelle che sono tutte le potenzialità degli applicativi che la Kali mette a disposizione la Kali Linux dovete vederla come una versione di Linux non è diversa da Linux da qualunque altra distribuzione di Linux l'unica differenza fondamentale è che ha già preinstallate al suo interno tutta una serie di applicativi compresi quelli di cui abbiamo parlato in passato senza dover necessariamente mettersi lì se no l'alternativa sarebbe prendere una macchina Linux standard e cominciare a installarci sopra tutti i vari strumenti e configurarli che è un immane per il tempo invece sulla Kali trovate già tutto installato ed ottimizzato vi faccio vedere due esempi reali semplici poi me ne citerò qualcun altro il primo riguarda esercizio di pen testing infatti su una rete con due macchine virtuali gestite tramite VirtualBox in modalità rete interna che è appunto quella che vi dicevo con due macchine virtuali installate una full Kali da una parte e una Linux metasploitable dall'altra ok? quindi due macchine che per il tipo di analisi che adesso andremo a fare non necessitano di nessuna installazione integrativa hanno già al loro interno tutti gli strumenti che vedremo adesso quindi sono installare così come sono usare così come sono la particolare vulnerabilità che andremo a esaminare in questo primo esempio riguarda il protocollo FTP cioè il file transfer protocol cioè quel protocollo che sotto Linux viene utilizzato per effettuare il trasferimento di file in modalità remota quindi da un host all'altro e in modalità non protetta ok? FTP gestisce la trasmissione in chiaro senza autenticazione senza garantire la confidenzialità e l'integrità ok? un passo ulteriore sarebbe provare a montare un attacco non contro FTP ma contro SCP che è la versione sicura di FTP magari andare a vedere se ci sono delle versioni vecchie di SCP quindi con delle vulnerabilità che potrebbero essere sfruttate questa è una shell aperta sulla Kali la macchina Kali quindi voi immaginate di avere già il vostro laboratorio virtuale per cui usando VirtualBox avete installato appunto la Kali che avrà il suo IP e la Metasploitable che anche questa avrà il suo IP quindi tutti i parametri di configurazione quindi che potete benissimo verificare nella schermata di configurazione di VirtualBox questo che vi ho fatto vedere prima e qui vedete già ad esempio l'utilizzo della Kali di IMMap come strumento per fare vulnerability search quindi il riconoscimento attivo ok vi ho citato diversi tool per fare scanning della rete alla ricerca di host in prima battuta alla ricerca poi di eventuali porte o servizi attivi sugli host che individuate qui trovate già un comando eseguito a valle di un primo scan il cui obiettivo era quello di verificare quante macchine attive ci sono in ascolto sulla rete virtuale ne è stata individuata una che ha quell'IP che è 192,68,561 che è l'IP della macchina vittima della Metasploitable una volta individuata sempre NMap che potete usare con una serie di diversi parametri e opzioni in particolare qui NMap viene lanciato con una serie di parametri che il cui obiettivo è quello di fare uno scan a 360 gradi di un range piuttosto ampio di possibili porte da testare su quell'IP ok e per ciascuna porta che dovesse rispondere NMap interroga poi la macchina vittima chiedendo informazioni su alcune caratteristiche del servizio come ad esempio la versione ok anche in questo caso non c'è nulla da imparare in particolare nel senso che basta vedere quello che è il tutorial che in una pagina mi fa vedere quali sono le diverse opzioni con cui potete usare NMap in particolare tutti quei parametri che vedete lì e in questo caso vedete che il risultato è un semplicemente qui c'è una parte e poi ce ne sono diverse sotto anche altre porte però mi interessa la porta 21 su cui è attivo il servizio FTP ok poi sotto ce ne sono la schermata è molto più ampia e sotto ce ne sono tanti tanti altri io ho messo in evidenza solamente il servizio che poi vogliamo attaccare ok quindi vedete che la risposta appunto vi dice che è attiva la porta su cui è l'ascolto quella particolare versione di FTP la 2.3.4 e questo è NMap vedete vi da tutta una serie di informazioni sullo stato della porta e a questo punto quindi individuato l'host e individuato un servizio attivo su quell'host la cosa più semplice che si può fare è utilizzare un'applicazione disponibile sulla Kali la maggior parte delle applicazioni sono usabili in modalità testuale alcune hanno un'interfaccia grafica però la maggior parte sono usabili anche in modalità testuale in questo caso particolare si utilizza un'applicazione che si chiama Metasploit quella usata più comunemente perché è una di quelle che vi avevo accennato quando abbiamo parlato della Kill Chain perché Metasploit in particolare è un applicativo che vi permette di individuare interrogando un repository se ci sono degli exploit disponibili per il particolare servizio che intendete attaccare e quindi è un'interfaccia di metasploit che si chiama metasploit e se ce ne sono voi scegliete quale volete lanciare Metasploit fa tutto al posto vostro nel senso che prepara l'exploit se c'è bisogno di settare i parametri di configurazione ve lo chiede dopodiché lancia l'attacco lancia l'attacco e la risposta all'attacco dovrebbe nella maggior parte dei casi essere una shell aperta da remoto sulla macchina vittima con privilegi di root spesso volentieri ok Metasploit nella versione di Metasploit relativa a questo esempio che vi sto facendo vedere la sto usando in modalità testuale il comando per lanciare Metasploit è MSF console o MSF console 6 dipende dalle distribuzioni quando lanciate questo comando vedete che vi cambia il prompt dei comandi vedete qua c'è MSF6 maggiore vuol dire che siete all'interno quindi siete all'interno dell'applicazione Metasploit uno dei comandi che si usa per cercare exploit si chiama search ok e dopodiché a seguire mettete i i campi relativi al servizio rispetto al quale state cercando una vulnerabilità quindi in particolare siccome Nmap prima mi ha detto che sulla macchina vittima gira questa versione di FTP la 2.3.4 allora a questo punto noi interroghiamo Metasploit e gli chiediamo di cercare delle vulnerabilità relative a WSFTPD 2.3.4 Metasploit interroga il suo repository e se esistono delle vulnerabilità su cui sono disponibili degli exploit vi ne mostra l'elenco in questo caso ce n'è uno solo ok probabilmente se non avessi messo se avessi messo solo WSFTPD senza 2.3.4 l'elenco sarebbe stato più lungo perché mi avrebbe fatto vedere l'elenco di tutte le vulnerabilità di tutte le versioni di FTP che conosce noi qui siamo stati specifici perché abbiamo indicato anche la versione perché sapevamo qual era e quindi abbiamo fatto un'interrogazione mirata e quello è il risultato che c'è un exploit che probabilmente possiamo evitare dal nome è un exploit che è in grado di sfruttare una backdoor presente in quella versione di FTP qui trovate la data quando risale questo exploit quindi questo è piuttosto vecchio del 2011 il rank vi dice quanto è efficace l'exploit excellent che funziona praticamente sempre e poi trovate la descrizione infatti vediamo exploit che esegue una backdoor presente su quella versione di FTP tra l'altro apro una parentesi abbastanza buffa questa backdoor presente su FTP perché è una backdoor creata da chiaramente dal progettista dei progettisti che consentiva ai progettisti di autenticarsi da remoto in modalità da admin senza conoscere le credenziali del badminton della macchina remota perché magari chi aveva configurato la rete se l'ha dimenticato o cose di questo o cose di questo genere e la backdoor consisteva in quel caso lì nel usare come nome utente una qualunque stringa che finisse con due punti chiusa tonda cioè la faccina che ride come nome utente la password era password mi pare una cosa del genere e con queste credenziali qui automaticamente apriva una shell da remoto con privilegi di un certo tipo adesso non non ricordo e Metasploit non solo conosce chiaramente la vulnerabilità ma al suo interno ha già l'exploit preconfezionato quindi anche se voi non la conoscete tanto è lui che lo lancia a voi non mi interessa neanche sapere in cosa consiste no ne vedete il risultato e infatti qui che cosa ho fatto se volete lanciare l'exploit che quindi è stato restituito il comando a use no quindi prima se cerca poi usa ma è abbastanza semplice semplice il manuale di Metasploit quindi usa zero zero era l'indice associato all'unico exploit che avevamo trovato e quindi usa zero significa lancia lancia l'exploit ok al che Metasploit si lamenta dice guarda io non ho non sono stato in grado di configurare il payload quindi il contenuto dell'exploit probabilmente perché mi mancano perché mi mancano dei dati ok tanto per fare un esempio io gli dico lancia l'exploit ma contro chi ok tanto per dirneva quindi lui se la mette dice ma guarda non non sono riuscito a a costruire il payload a configurare correttamente quindi l'exploit che devo lanciare e ti mostro le opzioni no no quali sono i parametri di configurazione dell'exploit e vedete che qui i parametri sono due un parametro rport il cui valore è 21 che cosa rappresenta questo parametro la porta verso cui lanciare l'attacco che lo sapevamo già che era 21 lo sapeva già anche lui perché 21 è la parte è la porta su cui ascolta FTP l'avevamo già visto anche prima usando usando Nmap vedete la porta 21 lo sa anche Metasploit quindi il parametro R port l'aveva già precaricato lui col valore col valore giusto l'altro parametro che Metasploit chiaramente non poteva sapere è il parametro R host che rappresenterà che cosa rappresenterà l'indirizzo dell'host verso cui lanciare l'exploit ok e lo dice qua le target host quindi quello che vi sta dicendo è guarda io non ho non ho non ho l'indirizzo della macchina verso cui lanciare l'attacco ovviamente perché noi non gliel'abbiamo detto noi l'unica cosa che abbiamo fatto quando abbiamo lanciato Metasploit è stato chiedergli quali sono gli exploit disponibili per questa versione di FTP e basta poi gli abbiamo detto lancia l'attacco e lui ci sta dicendo non so contro chi lanciarli ok però è utile questa cosa qui perché è un modo per vedere quali sono i nomi dei parametri R host è il parametro che va inizializzato con che cosa qual è il valore che gli dobbiamo dare il valore che gli dobbiamo dare è questo qua l'IP della macchina vittima no quello che avevamo trovato in precedenza usando usando Nmap ok e infatti vedete che qui col comando set rhost l'IP assegno e qui vedete il risultato assegno il valore del parametro che mi interessa e vedete che siamo ancora all'interno di una sessione relativa all'utilizzo dell'exploit perché guardate il prompt no il prompt è ancora il prompt è questo msf6 exploit l'indirizzo dell'exploit che è il prompt che è cambiato dopo che gli ho detto usa usa l'exploit ok quindi prima ho detto usa usa l'exploit zero e vedete che è cambiato il lui mi ha detto mi ha dato il warning guarda che non riesco a configurare il payload è cambiato il prompt vuol dire siamo all'interno di una sessione di di uso di metasploit relativa all'utilizzo di quel particolare exploit lì ok ok dopodichè comando show options per vedere quali sono i parametri che non sono stati ancora configurati benissimo e siamo sempre all'interno della stessa sessione setto il parametro lancio il comando exploit e il mio gioco è finito mi vedete piuttosto semplice no niente di complicato lancio il comando exploit e e fa tutto metasploit fa tutto metasploit e vedete l'esito lui lancia l'attacco vi da un po' di feedback trova la backdoor riesce si connette senti fa tutto quello che deve fare e il risultato finale il risultato finale vi ritrovate all'interno di una shell che non è più quella locale di metasploit quindi della macchina attaccante ma la shell che vedete la shell che vi ritrovate è quella remota cioè adesso non siete più su una shell locale della macchina cali ma siete su una shell remota della macchina vittima e ve lo dice l'ultimo l'ultimo warning che avete qua command shell session 1 open ok e avete ripi no? no? avete ripi della macchina vittima e in più sapete che questa shell remota è aperta su una nuova porta che è la 6200 che è uno degli effetti è uno dei side effects della backdoor che vi dicevo prima cioè se la backdoor consiste nell'inserire una certa user con un name e una certa password della sessione FTP in risposta dall'altra parte che cosa succede? si attiva la backdoor, la backdoor che cosa fa? apre una porta nuova la 6200 sulla quale creare una sessione attiva con la macchina che ha fatto il login tramite FTP quindi adesso qui quello che vedete è una sessione ripeto diversa rispetto a quella locale di prima e di fatto voi siete sulla macchina remota siete sulla macchina vittima no? per farvi vedere che sono sulla macchina remota e con quale diritto ho lanciato il comando who am i è il comando che serve per interrogare il sistema e chiedergli chi sono io e la risposta è root quindi la sessione remota che è stata aperta con i massimi livelli di privilegio e poi ho lanciato il comando dir per vedere il contenuto della directory locale della macchina remota su cui è stata aperta la sessione ok? questo è un po' l'excursus, il modus operandi che vi permette di utilizzare in combinazione prima nmap per per per fare lo scan della rete cercare l'IP adesso qui ho saltato un paio di fasi dell'UCDNMap ho messo direttamente il comando finale che è quello che serve per scannerizzare l'IP che avete individuato ok? e restituire l'elenco di tutti i servizi attivi scegliete quello che volete attaccare chiede lanciate Metasploit gli chiedete se c'è un exploit attivo per quel tipo di servizio se c'è lo usate ma perché quelli sono i parametri di default che che allora ogni tipo di exploit deve essere configurato ok? e ha dei parametri ogni exploit ha i suoi no? questo in particolare ha solo due parametri ovvero vuol sapere qual è la porta su cui lanciare la testa ok? e ha dei parametri ogni exploit ha i suoi no? questo in particolare ha solo due parametri ovvero vuol sapere qual è la porta su cui lanciare l'attacco anzi prima battuta vuol sapere chi è la qual è l'IP della macchina vittima su cui lanciare l'attacco e qual è la porta non gli serve altro per exploit più sofisticati ci sono anche altri parametri faccio un esempio e ve lo farò vedere ci sono degli exploit che creano un attacco di tipo phishing allora in quel caso ci sono tanti parametri da configurare dovete configurare l'exploit l'indirizzo email del destinatario il payload perché se il phishing consiste nel mandare un email che continua un attachment con un malware dentro allora voi gli dovete dire qual è l'attachment gli rodate e allora lui ci monta il malware dentro quindi a seconda del tipo di exploit da sfruttare ci sono chiaramente delle informazioni che decidete voi che sono parametriche e non le decide metasploit ok? in questo caso le uniche due informazioni sono i P del leal della vittima e la porta in realtà la porta non l'avete bisogno di dargliela perché la sa già lui perché di default è la 21 perché di default FTP ascolta sulla porta 21 faccio un esempio metti caso per qualche motivo che tramite Nmap scopri che per qualche motivo FTP sulla macchina vittima non è in ascolto sulla porta 21 ma è in ascolto sulla porta 22 perché? perché ha installato FTP sulla macchina vittima non ha fatto un'installazione standard ma ha fatto un'installazione modificando la porta di ascolto lo puoi bollissimo fare no? faccio un altro esempio se installate MySQL di default la porta è la 3.306 ok? se volete fare un'installazione di un motivo per cui vorreste cambiare la porta è che magari sullo stesso server ci mettete diversi servizi dello stesso tipo cioè su una certa macchina ci potete mettere due diversi di BMS tutte e due MySQL Allora è chiaro che se uno ascolta sulla porta 3.306 l'altro ascolterà su un'altra porta e quindi è cambiata qui vale lo stesso discorso quindi metti caso che per qualche motivo non sia la 21 ma sia la 22 quando tu chiedi a Metasploit di cercare vulnerabilità per il servizio FTP lui ti dà la stessa risposta che abbiamo visto qui e ti dice la 21 perché? perché per lui la porta di default di FTP è la 21 e quindi lui di default userebbe la 21 non è quella perché tramite NPUP hai visto che invece era la 22 allora cosa fai? devi cambiare il parametro ok? quindi prima di lanciare l'attacco gli dici guarda il parametro Rport non deve essere settato a 21 ma a 22 e allora scrivi set Rport 22 così come invece devi scrivere per forza il valore del parametro Rhost e allora gli dici set Rhost l'IP della macchina vittima come abbiamo visto qui ok? quanti e quali sono i parametri? con il comando Show Options ti vedi l'elenco di tutti i parametri associati all'exploit e la loro descrizione ok? quindi tutte le informazioni che ci sono per capire che cosa devi andare a settare fondamentalmente ok? e poi qui andava avanti la cosa potrebbe finire qui nel senso che abbiamo una sessione siamo dentro ok? siamo dentro la macchina remoto abbiamo la macchina remota con diritti di root qui come ulteriori fasi della kill chain vi faccio vedere che un possibile modo di andare avanti qui non c'è limite alla fantasia un po' ad esempio che ne so magari nella macchina vittima avete installato avete installato tornando all'esempio di prima nella macchina vittima avete installato MySQL allora voi sapete che dentro MySQL c'è il database di gestione degli utenti e all'interno di questo database c'è una tabella che contiene gli hash delle password degli utenti di quel servizio quindi un ulteriore modo di proseguire l'attacco potrebbe consistere di andare a cercare di di hackerare quelle password ok? qui ho fatto una cosa molto più semplice perché sono andato dentro la directory etc che c'è un file che si chiama password che contiene l'hash delle password di tutti gli utenti che si possono appunto che sono registrati che si possono collegare a quella a quella a quella macchina no scusate etc shadow scusate in altri casi etc password e quindi cosa ho fatto in questo caso adesso qui non ho messo però se avete una macchina Linux potete andare a vedere tanto c'è in tutti in tutte le distribuzioni questo file è un file dove trovate riga per riga informazioni relative a tutti gli account a tutti gli username c'è e ci sono i vari campi username che adesso data di creazione di quell'account data di validità ci sono variate informazioni e a un certo punto c'è un campo che rappresenta l'hash della password ok e perché come vi ho accennato e poi lo vedremo quando studieremo i protocolli di identificazione di solito la macchina che vi deve autenticare non memorizza direttamente la password in chiaro proprio perché in situazioni di questo genere chi ha accesso la macchina la vedrebbe le password in chiaro ma memorizza l'hash della password per cui quando un utente si deve identificare trasmette la password il server prende la password che riceve dal dall'utente ne calcola l'hash e lo confronta col valore memorizzato localmente se coincidono l'identificazione del successo ok quindi lì dentro c'è l'elenco di tutti i record relativi ai vari account compreso l'elenco delle password il file valide pulito dovete togliere tutti i campi lasciare solamente il campo password del hash una password per ogni riga e poi prendere questo file dando in pasto ad esempio a hashcat che è una delle tante applicazioni che che la kali ha al suo interno e che è un'applicazione che fa un attacco di forza bruta sugli hash sugli hash del password ok per questo dare un'occhiata dare un'occhiata quantomeno al manuale associato alla la kali se non altro per avere una panoramica di quello che è l'elenco di tutte quante le le applicazioni che dentro la kali sono disponibili ma ripeto quelle che abbiamo elencato qualche selezione fa ci sono praticamente tutte e quindi cosa è stato fatto si è usato appunto il programma scatta della kali per dando l'impasto questo file ripulito degli hash delle password trovato la macchina remoto e per fare un attacco a forza brutta e lì è saltato fuori che c'erano un paio di di password banali perché l'attacco a forza brutta che fa hashcat è basato su un dizionario e se la password dell'utente contenuta nel dizionario è scatto con carlo riesce a calcolare più delle volte è già precalcolato l'esce di tutte le parole del dizionario e quindi se la password è 123456 questa fa sicuramente parte del dizionario di hashcat e quindi viene individuata e lì in quel caso ce n'erano un paio di password deboli da questo punto di vista e quindi vedete questo è un esempio di se vogliamo lateral movement perché attraverso hashcat si riesce a individuare la password di un utente diverso rispetto a quello che è root che è quello che ci ha permesso di entrare ok chiaro siamo per far vedere un esempio un po diverso rispetto rispetto a questo però analogo perché vedete il modo come vedrete il modo superando sempre lo stesso dell'esercizio giusto se teammates mic prima lo rispetto prima prima detto visto che la macchina vittima era la meta exploitable di linux perché la tipica palestra da usare per gli eserciti di pen testing perché porta con sé tutta una serie di applicazioni vulnerabili note qui invece ho scelto una una distribuzione specifica di linux che è quella centros linux 8 il motivo il motivo è che chi ha fatto questo esercizio usava questa distribuzione sul posto di lavoro ok quindi conosceva già questa distribuzione è una distribuzione analoga come può esserlo la ubuntu la mint questa ha delle specificità particolari legata legata a determinati servizi che mette a disposizione di default ha usato quella perché con quella ci lavorava la conosceva già e sapeva non perché avesse studiato ma perché semplicemente è andato a vedere sul sito non mi ricordo se sul sito o asp o sul sito mitra attack comunque ha cercato vulnerabilità note per 100 versi di luciotto e ne ha trovata una riguardante servizio samba che è un servizio di un protocollo di comunicazione che consente di mettere in comunicazione una macchina linux con una macchina windows ok è nativo delle macchine windows ed è stato sviluppato proprio per permettere macchina di comunicare con macchine che montano sistemi diversi ha trovato documentata questa vulnerabilità google ando sul sito mitra attack e quindi ha deciso di testarla questa vulnerabilità quindi vedete che la procedura è esattamente la stessa più o meno la stessa di prima con qualche variante la tralascia la parte di installazione delle due macchine virtuali che è una non della precedente tenuto conto del fatto che è su web web e su Google box arriviamo direttamente al dunque la vulnerabilità search l'ha fatta come viene fatta comunque usando andemà ok qui ha fatto una roba un pochino più sofisticata perché ha lanciato un map per interrogare la rete alla ricerca di tutti gli indirizzi ip che cominciano con 192 168 178 punto qualunque cosa in realtà non è appunto qualunque cosa ma è appunto qualunque numero compreso tra 0 e 256 ok perché questa cosa perché questo 24 che vi dice il diritto ip è un indirizzo a 32 bit ok i primi 24 bit riguardano le prime tre cifre fondamentalmente ok gli ultimi 8 bit riguardano l'ultima cifra no e gli ultimi 8 bit quante cifre riescono a su quante cifre spaziano 2 alla 8 è 256 ok quindi in questo comando stati dicendo il nema che tenuti fissi di primi tre cifre 192 168 168 168 che quindi i primi 24 bit i rimanenti 8 bit restano liberi libri vuol dire prova di tutti infatti vedete che nebato comincia a scannerizzare la rete fa lo scambio tutta la rete trova tutta una serie di macchina che adesso mi ricordo aveva installato più di una di macchine virtuali tra cui ovviamente la macchina locale stessa quello su cui c'è la cali che è questa quindi punto 96 questo è localhost e la macchina vittima quella con punto 97 ok ce n'erano altre perché l'intento era riprodurre in vitro la rete vera la rete aziendale vera e nella rete aziendale vera c'erano altre macchine altre altre cinque quanto pare queste cancellate col blu che quindi in un ambiente virtuale era stata riprodotta l'intera rete aziendale ok quindi trovata trovate tutte le macchine quella che ci interessa è la server genesis perché è lì che come vedremo si prova samba infatti lanciando di nuovo annemap stavolta sulla macchina specifica vedete la punto 97 che è questa quella che avevamo individuato in lanciando nemmap sulla porta specifica ecco che vedete un po come prima con meno parametri perché vedete con meno informazioni rispetto ad esempio di prima perché ho cambiato un po i parametri in modalità meno verbosa ok però in ogni caso il risultato è l'elenco di tutte le porte aperte quindi di nuovo come prima ftp sulla 21 solo che la versione diversa 303 e così via le altre 22 ssh la classica porta 80 http perché probabilmente questo server web che ospita un sito e via dicendo e poi trovate vedete la 139 la 445 dove gira samba ok fatto questo annemap non è l'unico modo di fare questa cosa ci sono la kali mette a disposizione altri servizi analoghi annemap uno di questi è non for linux che è molto ben fatto ma anche molto facile da utilizzare fornisce un sacco di informazioni e poi niente si agisce esattamente come prima quindi si sceglie servizio ad esempio samba sulla porta 445 si chiede si lancia metto a sport e gli si chiede se ci sono gli esploi disponibili per quel servizio e poi si lancia ad exploit attraverso il nostro verso qui mezzo sport è stato già lanciato search samba vedete non ho messo neanche la versione il motivo per cui exploit che saltano fuori sono tanti proprio perché non è specificata la versione e tra quelli ne scegliete uno vedete anche abbastanza verboso metto sport perché vi chiede vi chiede anche come come potete proseguire il dialogo con lui no perché voi avete fatto il search samba della tirati fuori 25 e lui vi dice come continuare l'interazione quindi come avevamo fatto prima use 25 se volete lanciare usare l'exploit numero 25 info 25 è come un help vi da delle informazioni sull'exploit ok e qui non mi ricordo quello scelto ma probabilmente uno di quelli correnti più alto quindi probabilmente uno di quelli appunto che ad esempio uno degli eccellenti e poi si prosegue come prima se lui non riesce a lanciare l'exploit di default mostrate le opzioni andate a vedere se ci sono dei parametri che necessitano di configurazione li configurati esempio nostri anche in questo caso ci sarà r host sicuramente e poi lo lanciate e lui attacca attacca la macchina vedete qual è l'esito anche qui in questo caso probabilmente una scella aperta modalità remota sulla macchina vittima quindi due due esempi molto molto simili tra di loro ma le modalità grosso modo sono quasi sempre queste questi sono due esempi anche abbastanza semplici intuitivi ora su blended ne ho messi degli altri ne ho messi degli altri alcuni dei quali vi elenco qui nelle slide però l'archivio su blended è sempre più aggiornato rispetto alle slide perché quando mi capita un progetto nuovo interessante rispetto ai precedenti magari lo prendo e lo metto su su blended e quindi su blended ne trovate sicuramente di più rispetto a quelli che sono menzionati qui ad esempio e dopo ve li faccio anche vedere tanto dov'è il browser qui per suggerci e siamo siamo qua nella sezione esempi di laboratori di pentesting datele delle risorse questi sono tutti esempi ok adesso ve li mostrerò tra oggi e domani oggi ormai è quasi finito qualcuno uno ve lo voglio mostrare in dettaglio che è il caso del phishing perché ci sono parecchi elementi interessanti ma ad esempio injection 1 e 2 sono due esempi di pentesting che riguardano attacchi di SQL injection fatti sulle due ve ne ho messi due proprio perché riguardano le due diverse applicazioni web vulnerabili che vi ho citato prima cioè mutilidae e di VWA ok così potete vedere un esempio sia dell'una che dell'altra in entrambi i casi la kill chain opera sempre nel solito modo ovvero l'esercizio è basato su un laboratorio virtuale creato con virtual box in modalità di rete interna ok dopodiché in entrambi i casi l'attaccante la kali come sempre mentre invece la macchina vittima nel caso dell'esempio su mutilidae la macchina vittima è la linux metasploitable 2 perché lì dentro c'è già installato mutilidae nell'altro caso invece è una ubuntu classica quindi è stata presa una distribuzione da probabilmente da tanti linux non mi ricordo ma anche dell'ultima versione di ubuntu quella che prendereste se voleste installarla virtualmente sulla vostra macchina non ha importanza dopodiché lì sopra quella macchina è stato installato di vw da sito ufficiale cioè scaricato e installato lì sopra in entrambi i casi la tecnica di attacco utilizzata è stata la seconda injection quindi in entrambi i casi si è usato in prima battuta in map per esplorare la rete virtuale immaginiamo di non sapere nulla insieme a uno scenario in cui non sappiamo nulla quindi usate in map per esplorare la rete individuate dei piedi una macchina vittima e andate a vedere se su quella macchina vittima sono aperte delle porte che sono evidenza del fatto che su quelle macchine è ospitato un server web quindi HTT la porta 80 piuttosto che la porta di Apache piuttosto che quella di altri altri servizi che se andate a vedere negli esempi trovate l'elenco di quelli che sono i servizi che sono un campanello d'allarme del fatto che su quelle macchine è stato ospitato un servizio web dopodiché individuato il servizio web lo si interroga tramite browser e tramite browser si prova a fare SQL injection la cosa bella sia di Mutilider che della di VWA è che entrambi i servizi mettono a disposizione vulnerabilità attaccabili tramite SQL injection di diversi livelli di difficoltà quindi in certi casi è sufficiente una SQL injection banale come quello che vi ho fatto vedere qualche parte se ne fa in altri casi bisogna fare il blind SQL injection e così via quindi ci sono ci sono percorsi di via più complessi e nei due casi di studio trovate due esempi appunto di se volete vedere come funziona nello specifico questo tipo di di attacchi di cui abbiamo comunque già parlato anche in passato questo è un altro interessante che è nel file dbms.pdf interessante perché di nuovo la modalità è sempre la stessa quindi cali come attaccante linux metasploitable 2 come vittima installata su una virtual box modalità di rete interna tramite nmap si scopre che sulla metasploitable 2 è aperta la porta non mi ricordo quale del dbms dbms postgreSQL che è un dbms alternativo a MySQL e a tanti altri sempre basato sul modello relazionale e qui la cosa interessante è andare a vedere nell'esempio specifico qual è l'exploit che sempre tramite metasploit è stato utilizzato per accedere in modalità remota alla alla macchina sfruttando una vulnerabilità del dbms ne aprendo un login remoto e poi non mi ricordo se in quel caso c'era anche un tentativo di escalation di lateral movement però nel documento trovate trovate la descrizione però vedete la modalità è sempre la stessa è carino vedere come funziona l'exploit in questo caso questo sicuramente e poi l'altra cosa di più alto livello diciamo è che ci sono altri tre esempi che sono Kill Chain, Kill Chain 2 e Metasploit Kill Chain e Kill Chain 2 sono due esempi che vi mostrano tutte le fasi della Kill Chain sempre secondo la stessa modalità che abbiamo descritto finora ma tutte le fasi della Kill Chain fino ad arrivare alla fase finale in cui l'attaccante cerca di garantire la persistenza dell'attacco e lo fa ad esempio creando un nuovo account utente la macchina remota che ha il diritto di accesso da remoto quindi in questo senso qua in particolare il primo dei due Kill Chain.pdf è abbastanza elaborato perché ha due macchine vittima nella sua configurazione sempre virtual box sempre Cali la full Cali come attaccante e ha due macchine vittima una Linux Metasploitable e l'altra è un po' come nell'esempio dell'injection cioè una Linux Ubuntu standard su cui è stato installato di VWA dopodiché su queste due macchine sempre usando Nmap si fa ricerca di vulnerabilità in particolare sulla Metasploitable 2 Nmap si usa insieme a un altro tool che è DIRB che dà delle informazioni un pochino più dettagliate un pochino più specifiche e la cosa interessante è che in questo caso la vulnerabilità riguarda PASH ok e invece sulla Linux Ubuntu con dvwa lì si fa un attacco di tipo injection perché analogamente agli altri esempi che abbiamo visto prima la cosa interessante è che in questo caso d'uso si usa un tool specifico della Cali che è OWASP ZAP che ha un'interfaccia grafica carina che serve per guidare gli attacchi di tipo injection SQL quindi è un po' più accompagnato diciamo dopodiché sempre usando diverse tipologie di exploit in questo caso d'uso ci sono tanti tanti diversi exploit utilizzati che vi potete divertire andare a guardare a parte il classico metasploit usato sulla Metasploitable 2 e a parte l'injection sulla dvwa che sono classici ce ne sono altri interessanti basati sui attacchi tipo CSS cross-site scripting che sono attacchi condotti attraverso gli script che agiscono sui browser ok poi c'è un attacco di command ejection simile al discorso che avevamo fatto in passato molto carino e altri due attacchi il cross-site request forgery e il file inclusion che anche questi sono abbastanza interessanti qui vi ho messo il link alla descrizione di questi attacchi che pesca sul sito della OASP no? ad esempio e qui trovate tutti i dettagli di come funzionano questi attacchi in particolare i cross-site scripting che sono piuttosto diffusi in ambito web come attacchi si basano sempre sull'injection no? e sfruttano il fatto che quando voi interrogate un server web che chiede un input da parte vostra ok voi potete fare injection di comandi attraverso quell'input a seconda dell'uso che poi il server web farà di quell'input delle volte molto semplicemente il server web se non fa sanitizzazione di quell'input nel caso più semplice lo restituisce lo rende disponibile esattamente com'è se tu dai un input il server web risponde mi hai chiesto questo no? e quindi è come se in quel caso sparasse sullo standard output l'input che gli è stato fornito ma se quell'input contiene un comando ecco che il server web non solo visualizza l'input che gli avete dato ma di fatto sta eseguendo un comando con i propri diritti di con i propri privilegi e quindi è qualcosa di analogo se vogliamo a quel discorso generale che abbiamo fatto sul command ejection un po' di tempo fa fatto sfruttando di script delle applicazioni web quindi debolezza lato browser e lì in quell'esempio trovate un attacco di questo tipo così come trovate anche questo tipo di attacco qua il cross site request forgery che è analogo perché comunque attraverso input non controllati l'intento è sempre quello di far eseguire dei comandi all'applicazione web che voi interrogate questa è un po' l'idea e quindi la cosa carina di quel caso di studio è appunto il fatto che a parte i classici exploit che vi ho fatto vedere per prima ce ne sono alcuni interessanti lato web e poi per concludere la cosa non si ferma lì perché a margine di questi attacchi quindi ciascuno di questi attacchi è un a parte di SQL injection che ha un altro scopo ma ciascuno di questi attacchi ha come finalità quella di avere un accesso privilegiato sulla macchina remota ok? una volta avuto questo accesso privilegiato sulla macchina remota in particolare trovate anche un esempio di che cosa si può fare sulla macchina remota una volta che avete avuto accesso in particolare trovate un esempio di come si fa escalation dei privilegi come ci si sposta all'interno della macchina aumentando i propri privilegi e in questo caso si usa un exploit basato su uno strumento che è l'inpeace che è sempre presente dentro la cali c'è un altro esempio di hash hacking basato su hash cut analogamente a quello che vi ho fatto vedere anche prima e poi c'è un esempio di attack sustainment basato sulla creazione in loco di nuove utenze da utilizzare poi in seguito per loggarsi sulla macchina remota senza dover per forza condurre un attacco ok? quindi proprio per mantenere una porta aperta sì tutti gli effetti sulla macchina remota e questo per quanto riguarda keychain keychain.pdf keychain2.pdf è qualcosa di analogo adesso magari la prossima volta vi do qualche dettaglio su quello che ci trovate di sopra così come su metasploit.pdf che è molto interessante perché perché presenta la classica configurazione no? del con la cali come attaccante la metasploitable come vittima però in questo progetto vedete tante diverse funzioni di metasploit che vengono usate ok? quindi oltre gli esempi che vi ho mostrato vi ho mostrato io ah poi per chiudere siccome vi ho detto che su questo caso d'uso c'è un bel esempio sugli attacchi di tipo cross-site scripting xss che sono molto diffusi però c'è un solo esempio allora per integrare un po' la cosa ho aggiunto un altro caso di studio xss.pdf che è dedicato esclusivamente a questo tipo di vulnerabilità ok? ripeto è molto diffusa perché spesso e mentieri non c'è la la diciamo la giusta accortezza nel nello sviluppare le applicazioni web in modo in cui vengono gestiti gli script in modo in cui vengono sanitizzati gli input e le dicende quindi tante applicazioni web là fuori sono vulnerabili all'attacco di questo genere anche se ci sono comunque le soluzioni disponibili perché poi in questi casi di uso trovate anche una serie di di contromisure da che è bene adottare per chiaramente per evitare questo tipo di di vulnerabilità chiaro che prima fra tutte avere le patch aggiornate perché se andiamo a vedere su su su su metasploit sulle repository quasi ogni software ha delle vecchie versioni vulnerabili quindi il patch aggiornato sicuramente è un must però in certi casi questo non basta occorre anche adottare a lato sviluppo delle delle accortezze per appunto rendere le applicazioni robuste rispetto a diverse tipologie di tentativi di injection perché poi alla fine tutto si riconduce al principio dell'injection anche se in contesto in modalità leggermente leggermente diverse e poi sempre la prossima volta volevo invece mostrarvi della l'aneta un esempio completo che è quello relativo al fishing perché mostro sempre tutte le fasi della kill chain però in un contesto un po diverso rispetto al solito perché vi mostra come montare un attacco basato sul fishing quindi come creare come creare una mail di fishing come metterci dentro un payload malevolo e così via ok ma questo lo faremo la prossima settimana ci vediamo domani che continuiamo invece il discorso con le fasi di action credo cerne