quindi il signature noise ratio è il rapporto tra il valore atteso del caso del segnale e la STD, la STDT quindi la standard deviation del filtro cioè del noise che possiamo scrivere così. Doviamo trovare quindi il filtro che massimizzi dato conoscendo il segnale noise, qui conoscere il segnale noise cosa vuol dire? Conoscere S chiaramente che lo conosciamo e conoscere il suo power spectrum del noise che equivale appunto con la conoscenza del noise. O si può introdurre un prodotto scalare che tra due quantità nel campo compresso A e B è la parte reale di questa integrale quindi semplicemente per integrare lo spazio delle frequenze nella trasformata di fuorie di A coniugata per la trasformata di fuorie di B fratto Sn, qui in realtà ci andavano due segni sopra per indicare la trasformata di fuorie e si trova che il filtro migliore è proprio dato da la trasformata di fuorie del filtro che massimizza il signature noise ratio è proprio dato da la trasformata di fuorie del segnale fratto il power spectrum per una costante. Quindi introducendo questo nel nostro difizione di filtro abbiamo questo quindi che il filtro è uguale all'integrale in DF della trasformata di fuorie dei dati per la trasformata di fuorie del segnale coniugato fratto il power spectrum oppure invece di calcolarci il filtro ci calcoliamo direttamente come serie terpolare SNR e introducendo quello che abbiamo scritto nella definizione dell'SNR abbiamo questo quindi possiamo scrivere invece di S facciamo S fratto in denominatore ok che è praticamente S per S coniugato fratto Sn quindi è tipo rispetto al prodotto scalare che ho introdotto scalare che ho introdotto prima è la norma quindi dividendo un vettore per la sua norma viene un vettore normalizzato ok quindi l'SNR può essere visto come il vettore normalizzato moltiplicato per il segnale vero ok fratto appunto Sl va bene? se qui non conosciamo il segnale vero al posto del segnale vero chiaramente cosa ci sarà? ci sarà D ok? qua ok va bene va bene va bene quindi qui dopo ve lo riscrivo ve lo riscrivo anche con con diverne questo è proprio il l'SNR nel caso ci sia il rumore va bene allora manca da capire una volta che uno ha uno stream di dati quindi chiudiamo questo e entriamo questo ecco quando uno ha uno stream di dati manca capire come possiamo trovare dove appunto c'è il segnale perché il segnale quindi può essere anche un segnale eh impulsivo che non sappiamo dov'è allora qui ci viene in aiuto la proprietà del appunto delle trasformate di Fourier quindi gli scriviamo che l'SNR l'intorno del tempo lo possiamo scrivere come integrale in D F D D F D F D F D F D F D F D F D F D F D F D F D F D F però come possiamo passare nel tempo partendo appunto da questa da questa da questa da questa espressione che questa espressione come la la otteniamo beh prendiamo uno stretch di dati che sarà lungo per esempio un tempo t e su questo stretch di dati facciamo la trasformata di Fourier per lo stretch di dati quindi questa è B di T ok poi sappiamo la trasformata di Fourier del nostro del nostro segnale che potrebbe essere supponiamo che segnale magari così poi ci mettiamo degli zeri questo si fa spesso quando appunto si si lavora con la trasformata di Fourier da quello che si chiama il pending no? e poi possiamo fare trasformata di Fourier dei dati la trasformata di Fourier di S normalizzare S utilizzando quella relazione che ho fatto vedere possiamo fare il power spectrum del segnale e costruire questa cosa qua che però appunto ha un valore nello spazio ha un valore ben definito a seconda appunto dove faccio partire i segnali allora qui per capire dove è il segnale si può ricorrere a una relazione supponiamo che appunto il segnale sia un segnale impulsivo ok avremo per esempio questo è il tempo questo è il segnale questo potremmo dire che il segnale che dipende dal tempo e che parte dal tempo zero ok se abbiamo lo stesso segnale qua questo sarà per esempio T star allora questo sarà lo stesso segnale che si sviluppa come T meno T star che parte al tempo T star quindi facciamo praticamente in questo modo una traslazione del segnale va bene ora proviamo ad andare a scrivere la trasformata di Fourier e questo è uguale all'integrale da meno infinito a più infinito in DT star per i alla meno 2 pi greco i f di T ok bene questa è semplicemente la trasformata di Fourier quindi facciamo un cambiamento di variabile chiamiamo T primo uguale T meno T star ok e quindi quello di prima viene uguale all'integrale da meno infinito al più infinito di T primo di S di T primo di star per i alla meno 2 pi greco i f di T primo più di star questo ho fatto semplicemente un cambiamento di variabile vedete guardate T meno qui T primo l'ho chiamato T meno T star quindi qui viene T primo e qui invece di T mi verrà T primo più T star ok mentre il DT è uguale perché T star è una costante quindi il DT DT primo è uguale a DT star quindi abbiamo che questo è uguale a allora questi due che dipende dal T primo non c'è la prima parte che la posso portare fuori E alla meno 2 pi greco i f di star per integrare da meno infinito più infinito di DT primo S di T primo di star per i alla meno 2 di grigia i f di primo ok mi viene fuori questa cosa qua quindi alla fin mi viene fuori che S S di T meno T star poi inizia T star è uguale a E alla meno 2 di greco i f cristale per trasformata di questo per la trasformata di S di S ok la trasformata di S tra fatta semplicemente al tempo ti sta va bene allora quando io quindi cosa posso fare per andare quindi qui l'idea è che posso andare a fare la trasformata di S comunque del segnale e poi per sapere quanto vale questa trasformata a diversi tempi T star quindi se il segnale l'impulso cominciasse non a 0 ma in un altro punto rispetto allo 0 basta moltiplicare per a meno 2 pi di con i f di star e quindi per ritornare indietro non faccio altro che un' antitrasformata di Fourier ok un'antitrasformata di Fourier che mi dice quando sarà cioè che mi riporta la mia serie temporale nel tempo quindi posso scrivere l'integrale da meno infinito di f per trasformata di d trasformata di s trattato sn di f st r quindi è uguale nel quanto abbiamo scritto prima a integrare da meno infinito a più infinito di d f per di trasformato di f sì chiaramente per s coniugato di f tratto sn di f per 2 t di f di star ok quindi posso calcolarmi questa quantità con s che sarà s normalizzato e poi faccio l'antitrasformata e facendo l'antitrasformata ho tutti i valori di questa quantità quindi dell'snr per tutti i t star quindi praticamente come si fa qual è il procedimento quindi il procedimento è 1 si trova il signal to noise ratio poi 2 si fa l'antitrasformata perché così si ritorna si ritorna nel dominio del tempo quindi si ha una serie di valori che sono i valori dell'snr al passare del tempo e quindi per poter sapere dov'è il segnale se c'è si cerca il massimo dell'antitrasformata ok questo è il procedimento che andremo ad applicare quindi iscriviamo tutto quindi abbiamo i dati e il template che sarebbe il template sarebbe il segnale conosciuto ok poi se ci serve filtriamo i dati se ci serve studiare di solo una certa parte dello spazio delle frequenze ok poi facciamo la trasformata di 1 2 3 quindi facciamo la trasformata di furie dei dati quindi passiamo allo spazio delle frequenze facciamo la trasformata di furie del template poi dove essere il template gimbre dai più più as port i ok poi oppure prima calcoliamo il paolo spec tu ok poi normalizziamo il template facendo sdf uguale normalizzato e facendo questo ok ok e poi a questo punto calcoliamo all'integrando quello che dicevo qua questo df per questo enorme ok df per sn per il template normalizzato fratto sn quindi riporto di qua ok calcoliamo questo e poi facciamo inverse ui per sforma di questo qua df sn n f fratto sn ok ok e poi troviamo questa è una serie temporale troviamo il massimo di questo nel tempo e quello sarà dove se questo massimo è abbastanza buono sarà dove appunto c'è il nondo seno ok va bene allora quindi adesso troviamo a fare questo procedimento quindi da qui a qua giù con i dati e fare appunto un codice per vedere se riusciamo a trovare il nostro segnale poi dopo quando si fa il segnale bisogna vedere la lunghezza del segnale eccetera eccetera ci sono diverse cose che possono cambiare di volta in volta però adesso per un'applicazione abbastanza semplice per capire un po' come funziona prendiamo dei segnali abbastanza semplici del rumore abbastanza semplice va bene? andiamo a tirare il tuo computer pourrait go Speak ok ok e andate sulla pagina blended mi qua e andate le scaricate grazie questo è il codice che andiamo a vedere quindi lo iscrivete lo riguardiamo insieme così vi conviene scaricarlo e aprire un altro in cui appunto copiamo di volta a volta i dati se no basta farlo girare poi data gauss è il i dati semplicemente quello che chiamiamo DDT data signal short è il segnale che c'è nei dati che andiamo a costruire noi per semplicità e il template è quello con cui noi andiamo a citare ovicinale cinque Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Facendo un sacco di errore. Allora, eh, se forse va bene, vi scalete. Allora, questo c'è l'oio. Voi vi dovete scaricare. Vi siete scaricati tutto? Vieni qua in collab. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Grazie. Forci facedown. Qui no, dopo sì. Comunque se no sono le solite librerie, in cui ti vediamo sì. E poi c'è questa prima parte. Il computer... Fatemi utilizzare il TV. Allora ragazzi, dopo... Questo è quello che vuoi fare, sarà il terzo del cilindro, va bene? Ok? Però, come dicevo, nel momento in cui presentate il progetto, e poi, nell'orario, il progetto bisogna spiegarla, ma anche nel tuo parte teorica. Quindi il libro che vi avevo consigliato, che si può scrivere tale, quello da spiegare, perlomeno nelle due parti, che serve? Se uno non ha abbastanza... Se uno non ha abbastanza appunto, bisogna spiegare nel libro, che serve? Ok. Quindi questo qui lo fate... Caricate... Quindi qui che lo facciamo? Carichiamo i dati, sempre con Pandas. Sappiamo che la servizia di acquisizione è 4096. Questi dati... queste data Gauss, quindi sono Gaussiani, quindi sono dati che ho prodotto io, vedete, hanno solo il valore della variabile, non hanno il tempo, quindi il tempo li ho riporto via con me. Mentre altri dati hanno anche il valore del tempo e il senso. Quindi cosa faccio? Va bene, la lunghezza... Questi erano le due dati... E non ci riesco. Ecco. Poi dico, guarda il tempo totale, e poi vabbè, faccio il vettore del tempo. Boost, questo qui, siccome questo è un esempio in cui io conosco anche il segnale, vediamo come fare adesso. Boost è qualcosa per il quale io posso moltiplicare il segnale in modo di averlo più intenso. Quindi boost uguale a 1 non vuol dire che non lo moltiplico per qualcosa in più, se non voglio avere un segnale più intenso all'interno dei dati, per fare boost 2, 3, 10, così via. Portal time, eccetera eccetera. Data noise. Ok, intanto potete arrivare fino qui e portarvi quindi i dati. E' questo qua? E' un dato. Qui dovrebbe venire come se invece la stessa cosa per il file che si chiama data signashort e deve dire come fatto o sarebbe disfatto no no rispetturare quindi segnale questo il segnale questo se è andato a allargare è un segnale oscillante così fatto però che va al vivo quindi parte dal zero uscire un seno però mi sale cresce ed è posizionato e quelli sono tutti i zero quindi è posizionato a 7 e qualcosa secondi ok quindi il segnale lo creo io facendo un test per capire come funziona quindi nel primo file ci sono il noise questo è il segnale a questo punto per creare i dati che vogliamo analizzare di DT facciamo il noise più il segnale ok perché al momento facciamo il test e quindi il segnale ecco lo chiamo string house segnal faccio vedete string data sarebbe quelli che ho già ho già caricato più il segnale e poi me lo vado a portare mi plotto sia i dati string house segnal cioè quello di DT sia string segnal che semplicemente invece il segnale ok per vedere com'è dentro se lo fate si è arrivato qua sì quindi quello che si vede questa parte qui è solo per rappresentare per capire meglio succede ecco è una cosa di questo genere ok quindi se noi non sapessimo qual è il segnale andassimo a cercare chiaramente vedremo solo il verde da cui non si vede assolutamente che c'è un segnale lì va bene perché il segnale è completamente accogato negato in certo nella traduzione inglese nel no va bene e questo tipo di segnale se non facciamo il video adattato è molto difficile da trovare e a meno che non sia in una regione di frequenza dove tutto il resito è quasi zero però chiaramente è molto più facile trovarlo se conosciamo il segnale stesso a questo punto quindi dobbiamo avere un template il template è appunto il segnale che noi conosciamo o ops ok ok ok명이 ok dove sono ecco carico il template che si chiama template signal shot è quel altro file che si doveva caricare ok si ma se lo carica si chiama complessima quando uno carica un file sui bled ti dice come lo vuoi chiamare però dopo ti mette nel nome del file dei questa parte qui so perché l'ho lasciata semplicemente un altro file ok ok ok poi qui faccio l'istogramma dei dati la mette se potete anche saltare comunque si vede che sono gaussiani poi cosa faccio se vi ricordate avevamo detto quindi abbiamo i dati template che è il segnale conosciuto dobbiamo fare la trasformata di Fourier dei dati la trasformata di Fourier del template che è sempre nel template e calcolarci il power spectrum ok allora sì allora i segnali lei lo sa certo lo sa l'antichio il template è quello che lei sa vedere perché va a fare la convulsione cioè il plato lo diga in questo esempio qui non c'è il termine di 30 perché sono uguali no non sono uguali perché mentre il segnale il file del segnale non vi si può no il file del segnale è a 7 il file del segnale il file del segnale non c'è la prima cosa che è il file del segnale è un solo secondo e il segnale è così ok lo vogliamo cioè cioè il file del segnale ma lo dovete aver ricordato anche voi e devo vedere cioè lei nella realtà nella realtà il file del segnale non c'era veramente e noi che adesso per fare una prova ce lo mettiamo e andiamo a vedere se lo troviamo lo sappiamo ne dove ne che intensità sappiamo solo una sua ok andiamo a vedere rispetto al passo qua andiamo su ecco vedete è a serie vedete questo è 10 secondi lui io lo vedo 7 e il template è un secondo ok è un secondo quindi il mio segnale io so che 2 è un secondo però non so né dove né che antietà bene tant'è vero che guardi qua qui non mi ricordo come l'ho fatto qui l'ampiezza è circa qui è 1 ecco qui comunque qui si vede meglio come è fatto il segnale vedete come vi dicevo appunto è un'oscillazione tipo un seno o un coseno però appunto in modo che salga scelta si dice probabilmente c'è è pesata con una grossiana comunque adesso me l'ho generato ok a questo punto dobbiamo calcolarci abbiamo detto prima di calcolarci trasformati di Fourier andiamo a vedere la il paro spectrum il PSD il SN di Eiffel non so perché non fa ecco ok quindi qua salvanditi la c'è l'occhio e l'acqua è fuori ok ecco quindi faccio il paro di spazio guardiamo queste ringhe poi le potete copiare no quindi utilizzo in questo caso semplice il periodogramma periodogramma vuol dire che faccio l'SST poi utilizzo l'SST per fare appunto il paro spectrum però ho tutti i dati contemporaneamente mi ricordate c'era una spazio nel fare il periodogramma su tutti i dati o farlo con il metodo di Welch il metodo di Welch era quello in cui io dividivo i dati in tanti pezzi facevo tanti paro spectrum e poi li mediavo va bene ed è meglio fare in un modo lì in un esercizio successivo cercheremo di fare in quel modo qui per semplicità facciamo invece il periodogramma semplicemente senza fare tanti tante senza fare le mette quindi ne facciamo solo uno allora andiamo a vedere quindi facciamo il periodogramma sia dei dati strain data sia del strain signal che sarebbe dove abbiamo che sarebbe DDT quello che ci interessa è questo qui mi pare era strain signal mi pare non usato dei momenti in pace no strain darsi devo poi andrò analizzato strain data strain signal è semplicemente segnale quindi e infatti ho fatto due problemi di testere oggi andiamo a vedere prestigliere quindi andiamo a vedere come è fatto il noise e il segnale va bene andiamo a vedere io l'ho fatto già girare sotto qui ci siete allora cosa si nota? e il segnale che andiamo a cercare è noiosissimo allora questo è il PSD dei dati e questo è il segnale allora cosa notiamo? guardiamo prima il PSD dei dati allora appunto vedete è molto irregolare perché non abbiamo fatto appunto il suo se no veniva una riga più dritta e cosa si può dire quindi da questi dati abbiamo visto che un gaussianico per il fatto il stradama il fatto che il suo PSD sia così vuol dire perché il nostro quando nel nostro non c'è nessuna frequenza di spiegare sulle app si chiama il rumore il rumore di ampio quindi questo per semplicità è il rumore di ampio quindi questo è un portato da spiegare esatto perché ci sono anche i rumori per non rientarsi questo il rumore di ampio è il rumore in cui non c'è nessuna frequenza che si chiama e mezzo molto colorato quindi ha un colore a vedere che ci serve per vedere che si fa spiegare quindi questo rumore bianco o se ne picca molto spesso qua è il rumore e in questa volta le difficilze devono analizzare perché non abbiamo delle frequenze che ci danno bastite vuol dire che il PSD è il cintro stanno bene il costante è il rumore bianco il rumore bianco white noise prima cosa che si vede che si vede cos'è riguardo ai segnali i vari e tra di tutto questo noi non lo so cioè andiamo a cercare per il segnale quindi che ha una componente maggiore intorno ai 100 Hz un picca cosa vuol dire vorrà dire siccome è fatto al consiglio vorrà dire che quelle oscillazioni hanno praticamente periodo 600 Hz inferiore sarà 0.01 secondi ok non è se fosse un seno cosa ci sarebbe qua semplicemente se fosse un seno vorrebbe dire che è continuo sempre 0.01 secondi no non farebbe così vorrebbe dire che ci sono una frequenza quindi sarebbe no nel coso nello scherzo gramma era così perché le frequenze erano qua qui le frequenze sono qua quindi se fosse un seno sarebbe una cosa così che sarebbe solo un seno però siccome non è solo un seno è un seno combinato ad altri segni con frequenze di 3 se no non potete salire e scendere al picco nella frequenza principale poi salire non è e questa è la prima cosa da notare quindi seconda cosa è che comunque la potenza massima è sotto la potenza del luce ok o comunque diciamo quasi è lì alla potenza del luce va bene andiamo a vedere come cosa dobbiamo fare e quello è ok ok quindi questo qui siamo arrivati qua va bene? oh ma questo non si può trattare ah ah ah ah ah ah ah ah ah allora allora qui per semplicità vediamo analizziamo solo la parte dei dati tra 7 e 8 secondi ok perché? perché sappiamo che i segnali sono la lunghezza bene? se uno facesse una un'analisi senza sapere dove è il segnale siccome adesso facciamo facciamo delle trasformate conveniamo delle trasformate la lunghezza il numero dei dati del break deve essere sempre lo stesso quindi se è un terfetto di un secondo non è un secondo di capo da tre volte e così via e così via se il terfetto più di più di più di più di più di più di più di più di più di più di più di più di più di più di più di più di più di più di più e così via perché se no vediamo infatti in quell'altro possiamo fare le intercolazioni perché quando andiamo a fare adesso delle operazioni deve essere lo stesso numero di punti dovrebbe che dobbiamo moltiplicare lo stesso numero di punti quindi cosa facciamo? va beh qui mettiamo possiamo anche metterlo anche dove non c'è il segnale qui intanto mettiamo dove c'è il segnale quindi tstart lo mettiamo a sette secondi e questo è il numero di punti e il Nes sarebbe andiamo a vedere cos'era 4096 dovrebbe essere dov'è il Nes a lunghezza del tempo del segnale quindi andiamo da sette a otto secondi ok in samples e facciamo la fft quindi string out signal fft utilizziamo la fft la la funzione fft appunto il pacchetto fft quindi faccio fft del string out signal ttstart ttstop quindi proprio in quel secondo lì restaiamo i valori punto values vedete faccio per delta t perché per dt perché se vi ricordate queste sono delle cose che ci sono sardine perché concettualmente uno fa le cose bene e poi solamente perché si scordano qualcosa del genere non gli viene più niente e mi partisce perché vi ricordate che la trasformata di due è delta t per la sommatoria di x n e all'inizio di grito i n k tra quelle grande e quindi x k viene trasformata ok allora c'è il delta t perché sarebbe un'integrale vi ricordate se voi andate a vedere eccola è questa che stiamo usando mi pare è la pagina giusta è questo non c'èimenti ma un üç cosa Harm hai hai Grazie. La F di T è definita così. Vedete che non moltiplica per delta T. Ok? L'inversa, se vi ricordate l'inversa, l'inversa è uno su T per la sommatoria eccetera eccetera. Va bene? Cioè è uno fratto N delta T. Ok? Oppure è anche D F per la sommatoria. Quindi quando utilizziamo un FFT in questo pacchetto, poi bisogna andare a vedere le convenzioni, poi dobbiamo moltiplicare per delta T. Quando facciamo l'inversa dobbiamo dividere per delta T. Ok? Quindi manca quel delta T. Ok? Quindi lì andiamo... Wow! E' qua. Quindi siamo lì, quindi String Gauss, FFT, quindi D D D per l'Esp. E poi template FFT, D D per la trasformata. Va bene? Poi bisogna fare, calcolarsi, sempre se vi ricordate bene, eh. il SES, il template, ci serve anche la trasformata coniugata. Ok? Trasformata coniugata. Trasformata coniugata. Ok? Trasformata coniugata. Come si fa... Beh... Ovviamente la facciamo fare a Byton. e facciamo template FFT. E facciamo template FFT coniugato. C'è una... come si chiama la... come si chiama la cosa? Comunque, insomma, template FFT, che è quella che viene definita sopra, appunto coniugata. E ci viene quello coniugato. Ok? Bene, qui dopo faccio print, print la luminizza, è un po' interessante. per vedere che sono uguali chiaramente. E poi faccio adesso... quando vado a normalizzare il template, ma quando faccio le SNR, se voi andate a vedere... faccio sempre... faccio l'integrale, vedete, da meno infinito a più infinito di qualcosa, diviso S. Va bene? Quando lo facciamo nel... e la meno di un pdc, questo perché facciamo un colente umano. Nell'integralto c'è sempre questa cosa qui. quando lo facciamo nel numerico, l'integrale diventa una somma. Vuol dire che io devo avere lo stesso numero, cioè lo stesso numero di valori sia sopra che sotto. Quindi cosa vuol dire? Vuol dire che la trasformata di Fourier 600 deve essere 100 anche questo, deve essere 100 anche questo. in modo da avere 100 numeri che poi io assumo. Va bene? Ok? Allora, in Python se io ho due vettori e li moltiplico semplicemente col per, mi crea un terzo vettore in cui ogni elemento è la moltiplicazione del per il per l'altro. stessa cosa non succede se divido. Per dividere invece in modo tale se ho un vettore sopra e un vettore sotto con lo stesso numero di dati, per avere un vettore in cui ogni elemento è la divisione del primo per il secondo, vettore, eccetera eccetera eccetera, si utilizza divide. O ci saranno forse anche altri metodi. in modo tale. O e siccome è trovata media e pinta più infinito vuol dire che questo SN è un power spectrum double in cui ci sono anche le frequenze negative. quindi vedete, quindi mi carico il px, il noise spectrum sempre col periodogramma, dei dati tra 7 e 8 secondi con la finestra con vedete in questo caso quando riporto faccio sempre il tuo one sided truth. Invece qui siccome lo voglio two sided scrivo the two one sided force, il che vuol dire che invece che da zero a n mi vada meno n e me, ha n e me. Va bene? E poi lo scaling, questo è quello da utilizzare, ci sono diversi scaling, ci sono da vedere questo di tex che ho visto. E poi cosa faccio? Ecco vedete? Quindi qui io sto facendo semplicemente tra 7 e 8. Quindi l'integrando di quell'integrale, l'integrand è quello che sta dentro l'integrale, no? Vedete? E' string Gaussian signal FFT per template FFT coniugato diviso, ma uso np divide, diviso il power spectrum. Va bene? Va bene? Quindi questa qui, questo integrand, che cos'è? che cos'è? Anche questo è un vettore con n, con n eliti che va da meno, quindi questo quant'è? 4.028, quindi va da meno 2.048 a più 2.048 e ed è appunto, è questa qui. e questa qua. Ok? Quindi df string Gaussian FFT per s, ancora non è s norm lì, s normale, fratto s n. Questo integrando qui, che è un vettore. A questo punto, ok? Questo è il filtro, quindi non ho normalizzato il template. Per ritornare indietro, come vi dicevo, quello che abbiamo fatto oggi, dobbiamo fare la trasformata inversa dell'integrando. Quindi, IFFT però diviso per il vettore. Quindi, a gente, questa è la stessa, quando, quando si va a riuscire, bisogna dividere per il vettore. E poi faccio il plot. Va bene? Andiamo a vedere cosa viene fuori. Ok? Ok. Ok. E poi questo. E poi questo. come faccio a portarlo su. E poi faccio a portarlo su. E poi faccio a portarlo su. E poi faccio a portarlo su. E poi faccio a portarlo su. E poi faccio a portarlo su. E poi faccio a portarlo su. E poi faccio a portarlo su. Ecco. Questo è il filtro, non è l'SnR. E' il filtro, quello che dicevamo, D per K, che viene D per il template diviso il Power Spectrum. E vedo che però ha un massimo a 7.8. Ok? Dove effettivamente c'è il segnale. Ci siete? Ok? Noi però invece di usare questo filtro qui andiamo a utilizzare come. Nel momento, per cercare il segnale, non è veramente il SMR. Allora cosa si fa? E' la stessa cosa però invece con un segnale così lo facciamo il filtratio con il template normalizzato. Allora, normalizzato cosa vuol dire? L'abbiamo visto prima, l'altra volta. Io ho un venturo per scherzi. No? Per esempio, per esempio, il 7. Come faccio a normalizzarlo? Normalizzare vuol dire che faccio in modo che di avere un vettore che ha stessa direzione verso ma a un volo 1. Va bene? Tipo un versore. E quindi faccio, probabilmente se la consiglio mi considero così, è semplicemente v diviso il modulo di v. Ok? In questo caso è stato v diviso 7. Bene? Il modulo di v è il prodotto scalare di v. Non lo scalare da me, quindi dobbiamo calcolarci questo. Allora siamo qua. No, non siamo. Ecco, template normalization. Venate? Allora, cosa ci calcoliamo? C'è calcoliamo il template per il template. Questo. E vi ricordate che bisognava fare template per il coniugato diviso il PSD. Questo mi dà la norma. Cioè una cosa per se stessa diviso il PSD. Sarebbe questa cosa qua. Sarebbe questa cosa qua. Sto facendo questa cosa qua su. Quindi S normalizzata uguale a S, uguale a qui, diviso il prodotto scalare di S con se stesso. Il prodotto scalare l'avevamo definito come un vettore per il coniugato diviso SN e integrato. Ok? E quindi è quello che sto facendo qua. E quello che faccio qua. Np divide template per il suo coniugato diviso il DST. Ok? Poi dopo qua ho, va bene, Df. E la norma quindi, quindi l'integrale, sarà la somma di tutti gli elementi di questo vettore moltiplicato chiaramente per Df. Ok? Perché appunto abbiamo l'integrale in Df. Va bene. Poi cosa faccio? Per avere quindi il template normalizzato e il template coniugato normalizzato, divido il template oppure il suo coniugato per square root della norma. Ok? Questo è la norma. Ok? Ok? Ok. Va bene? E poi lo plotto. Questo l'avete copiato? Andiamo a vedere cosa viene fuori. Cosa viene fuori? Viene chiaramente lo stesso template, ma siccome è normalizzato, vedete, ha il massimo a 0.8. cioè più piccolo rispetto a quello che era all'inizio, abbiamo usato questo come template che arrivava a uno. Quindi il template normalizzato è uguale a 3 liter, ma se uno va a fare un integrale, per far far far far far il prodotto scalare con se stesso, è uguale a uno. E infatti dopo... Faccio un check humanization. faccio un check normalization e praticamente faccio il prodotto scalare, quindi tra il plane normalize e il suo coniugato, faccio il prodotto scalare, quindi questo è l'integrale, questo è l'integrale, e questi poi sono praticamente i plot e vedo che, quindi siccome il tenteno è normalizzato, il prodotto scalare con se stesso deve dare, andiamo a vedere se numericamente mi da uno, vedete, tempo in normalizzato per tempo in normalizzato uguale 09999, quindi adesso andiamo a tutti gli elementi per fare la serie temporale dell'SNR, qui torniamo sui room, qui c'è un test, l'ho moltiplicato per 10 per vedere se ritroviamo 10, e tiene, lo potete guardare, adesso facciamo invece la serie temporale dell'SNR, per vedere, per vedere, ah, andiamo qua, questo è un filtro, qui col filtro ho trovato anche il momento del massimo, se andate a vedere, cioè quando, per vedere se trovava il tempi, se trovava il segnale, dov'è, allora, come ho fatto, ho preso la parte reale del filtro e ho preso l'indice dove questa parte reale ha il massimo, argmax, sapete cosa vuol dire? e poi lo moltiplico, quindi non so, sarà 8000, poi per sapere il tempo l'ho moltiplicato per dt, poi ci aggiungo i 7 secondi iniziali, meno 05 per il massimo, quindi da il massimo, o ad inizio, e mette il mio segnale a metà, ok? e se andate a vedere quello che viene scritto, viene scritto il tempo giusto, ok? ok allora alla fine faccio la stessa cosa, quindi faccio l'integrando l'SnR, moltiplico i dati, string a o sign a fft, quindi questo è proprio l'ultimo è d di fft per s e non potente di fft, ok? quello normalizzato, fratto S n di fft, double side to side, come abbiamo detto, ok? e poi provato questo, questo sarebbe venuto in df, noi facciamo la trasformata inversa di questa, quindi è i fft integrando l'SnR diviso del t, come abbiamo detto che è col t, e quindi troviamo la trasformata inversa e troviamo la serie temporale dell'SnR, ok? andiamo a vedere cosa viene fuori, ecco viene questo qua, che quindi ci dice che ha un SNR il segnale, ha un SNR di circa, ok? ok, sono diversi passaggi da fare quindi, cioè capisco, è un po' complicato, allora la prossima volta, finiamo questo argomento, provandolo a fare, potete intanto andarvi a scaricare e andarvi a scaricare e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e se e e e e e e e e e e e e e e e e e e e e e e e qui se voi andate a prendere il primo e l'ultimo vi accorgete che sono 32 il template anch'esso il template anch'esso e e e e fatto uguale però qui non ci sono i secondi c'è solo il perché è fatto uguale però qui non ci sono i secondi c'è solo il perché qui appunto il template può essere trovato per tutti i dati quindi non c'è dei secondi precisi la camponatura è sempre la stessa sono comunque 32 secondi allora come fatto il segnale che andiamo a cercare che quindi qui c'è il segnale ma non sappiamo dov'è il segnale che andiamo a cercare fatto faccio vedere faccio vedere questo questo questo questo questo questo questo questo vedo qui c'è anche un filtro vediamo la prossima volta allora questi sono i dati 32 secondi ok e e andate a portare e il template è questo il segnale è questo questo si chiama un cir che corrisponde al segnale di due buchi neri che si sta che ruotano l'uno intorno all'altro si stanno sempre più avvicinando fin quando non si scontano qua ok e dopo non fanno più nessun onda gravitazionale quindi è un circo cosa vuol dire che aumenta sia in frequenza che in e in e in e in e in e dopo ve lo faccio sentire forse la mole Anche non ci arrivare per nessuna volta, va bene? Adesso ci fermiamo qua, altro minuto per andare avanti su questa cosa. Se riuscite guardatevi, oppure a questo per esempio, vediamo andare avanti. Allora, però guardiamo un attimo questo programma velocemente. Cosa c'è qui differente rispetto a quello che abbiamo fatto? Guardatevi, vi faccio vedere. Qui c'è questo BAT filter, questo è un BUNPASS, perché siccome i dati in questo caso non sono bianchi, conviene fare un passavanda nel punto in cui si cerca il segnale. Poi dopo... Qui il problema, un problema che c'è in più è che noi vogliamo stimarci il PSD con Welch. Stimarsi il PSD con Welch vuol dire che dividiamo in 32 secondi, in un secondo, un secondo, un secondo. Facendo così però, il PSD, ogni PSD ha meno da... Ok? Ne ha 4.096, visto che il 4.096 è il 3.0. Quindi quando noi abbiamo il PSD di Welch, cioè il PSD solo con 4.096 punti, ma noi lo dobbiamo utilizzare per dividere una trasformata di Pugliette, e invece ne ha 4.096 per 32. Quindi dobbiamo avere lo stesso numero di punti, e la cosa che si deve fare è fare un'interpolazione, cioè prendere il PSD di Welch e ricampionarlo con il numero 11. Bene. Non è ricordo. In modo tale poi da poter sviluppare la sua carriera. Ok? Va bene? Allora adesso, riguardate questo, la prossima volta, domani d'altro, cerchiamo di vedere questa cosa qua. Ok? O come questo, come un altro segnale, il cui non lo utilizziamo noi. Va bene?跟你ai chiego ma anche che tra le persone, con i p massive columni, le parole mi sono apa? Quando ho v race con i pizzi già e ferire la persona. Ok tutti, vorrei dire il pubblicitario, con i pizzi già strutturi, questo con i pizzi anche delle persone, che suc favori Hahn piano e piano, cosa dovrò vedere가요?